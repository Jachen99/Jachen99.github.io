"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[9071],{37834:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>m,default:()=>p,frontMatter:()=>s,metadata:()=>t,toc:()=>c});var t=a(46086),l=a(74848),o=a(28453);const s={slug:"productivity-exercise-3",title:"\u7ec3\u4e60\u98983",authors:["jiguanchen"]},m=void 0,r={authorsImageUrls:[void 0]},c=[];function d(e){const n={code:"code",em:"em",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.em,{children:"\u8fd9\u662f\u4e00\u9053mysql\u6570\u636e\u67e5\u8be2\u7684\u7ec3\u4e60\u9898"})," "]}),"\n",(0,l.jsx)(n.p,{children:"\u6570\u636e\u8868\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"/*\u521b\u5efa\u90e8\u95e8\u8868*/\nCREATE TABLE dept(\n \xa0  deptnu \xa0 \xa0  INT  PRIMARY KEY comment '\u90e8\u95e8\u7f16\u53f7',\n \xa0  dname \xa0 \xa0 \xa0 VARCHAR(50) comment '\u90e8\u95e8\u540d\u79f0',\n \xa0  addr \xa0 \xa0 \xa0  VARCHAR(50) comment '\u90e8\u95e8\u5730\u5740'\n);\n\n\u67d0\u4e2a\u516c\u53f8\u7684\u5458\u5de5\u8868\nCREATE TABLE employee(\n \xa0  empno \xa0 \xa0 \xa0 INT  PRIMARY KEY comment '\u96c7\u5458\u7f16\u53f7',\n \xa0  ename \xa0 \xa0 \xa0 VARCHAR(50) comment '\u96c7\u5458\u59d3\u540d',\n \xa0  job \xa0 \xa0 \xa0 \xa0 VARCHAR(50) comment '\u96c7\u5458\u804c\u4f4d',\n \xa0  mgr \xa0 \xa0 \xa0 \xa0 INT comment '\u96c7\u5458\u4e0a\u7ea7\u7f16\u53f7',\n \xa0  hiredate \xa0  DATE comment '\u96c7\u4f63\u65e5\u671f',\n \xa0  sal \xa0 \xa0 \xa0 \xa0 DECIMAL(7,2) comment '\u85aa\u8d44',\n \xa0  deptnu \xa0 \xa0  INT comment '\u90e8\u95e8\u7f16\u53f7'\n)ENGINE=MyISAM DEFAULT CHARSET=utf8;\n\n/*\u521b\u5efa\u5de5\u8d44\u7b49\u7ea7\u8868*/\nCREATE TABLE salgrade(\n \xa0  grade \xa0 \xa0 \xa0 INT  PRIMARY KEY comment '\u7b49\u7ea7',\n \xa0  lowsal \xa0 \xa0  INT comment '\u6700\u4f4e\u85aa\u8d44',\n \xa0  higsal \xa0 \xa0  INT comment '\u6700\u9ad8\u85aa\u8d44'\n);\n"})}),"\n",(0,l.jsx)(n.p,{children:"1\u3001\u67e5\u51fa\u81f3\u5c11\u6709\u4e00\u4e2a\u5458\u5de5\u7684\u90e8\u95e8\u3002\u663e\u793a\u90e8\u95e8\u7f16\u53f7\u3001\u90e8\u95e8\u540d\u79f0\u3001\u90e8\u95e8\u4f4d\u7f6e\u3001\u90e8\u95e8\u4eba\u6570\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1a employee dept\n\u8bed\u53e5\uff1aselect deptnu,count(*) from employee group by deptnu\n\n\u8bed\u53e5\uff1aselect a.deptnu,a.dname,a.addr, b.zongshu from dept a,(select deptnu,count(*) as zongshu from employee group by deptnu) b where a.deptnu=b.deptnu;\n"})}),"\n",(0,l.jsx)(n.p,{children:"2\u3001\u5217\u51fa\u85aa\u91d1\u6bd4\u5b89\u742a\u62c9\u9ad8\u7684\u6240\u6709\u5458\u5de5\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee\n\u8bed\u53e5\uff1aselect * from  employee where sal > (select sal from employee where ename='\u5b89\u742a\u62c9');\n"})}),"\n",(0,l.jsx)(n.p,{children:"3\u3001\u5217\u51fa\u6240\u6709\u5458\u5de5\u7684\u59d3\u540d\u53ca\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u59d3\u540d\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee\n\u8bed\u53e5\uff1aselect a.ename,ifnull(b.ename,'BOSS') as leader from employee a left join employee b on a.mgr=b.empno;\n"})}),"\n",(0,l.jsx)(n.p,{children:"4\u3001\u5217\u51fa\u53d7\u96c7\u65e5\u671f\u65e9\u4e8e\u76f4\u63a5\u4e0a\u7ea7\u7684\u6240\u6709\u5458\u5de5\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u90e8\u95e8\u540d\u79f0\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee dept\n\u6761\u4ef6\uff1aa.hiredate < b.hiredate\n\n\u8bed\u53e5\uff1aselect a.empno,a.ename,c.dname from employee a left join employee b on a.mgr=b.empno left join dept c on a.deptnu=c.deptnu where a.hiredate < b.hiredate;\n"})}),"\n",(0,l.jsx)(n.p,{children:"5\u3001\u5217\u51fa\u90e8\u95e8\u540d\u79f0\u548c\u8fd9\u4e9b\u90e8\u95e8\u7684\u5458\u5de5\u4fe1\u606f\uff0c\u540c\u65f6\u5217\u51fa\u90a3\u4e9b\u6ca1\u6709\u5458\u5de5\u7684\u90e8\u95e8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1adept employee\n\u8bed\u53e5\uff1aselect a.dname,b.* from dept a left join employee b on a.deptnu=b.deptnu;\n"})}),"\n",(0,l.jsx)(n.p,{children:"6\u3001\u5217\u51fa\u6240\u6709\u6587\u5458\u7684\u59d3\u540d\u53ca\u5176\u90e8\u95e8\u540d\u79f0\uff0c\u6240\u5728\u90e8\u95e8\u7684\u603b\u4eba\u6570\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee dept\n\u6761\u4ef6\uff1ajob='\u6587\u5458'\n\n\u8bed\u53e5\uff1aselect deptnu,count(*) as zongshu from employee group by deptnu;\n\n\u8bed\u53e5\uff1aselect b.ename,a.dname,b.job,c.zongshu from dept a ,employee b ,(select deptnu,count(*) as zongshu from employee group by deptnu) c where a.deptnu=b.deptnu and \nb.job='\u6587\u5458' and b.deptnu=c.deptnu;\n"})}),"\n",(0,l.jsx)(n.p,{children:"7\u3001\u5217\u51fa\u6700\u4f4e\u85aa\u91d1\u5927\u4e8e15000\u7684\u5404\u79cd\u5de5\u4f5c\u53ca\u4ece\u4e8b\u6b64\u5de5\u4f5c\u7684\u5458\u5de5\u4eba\u6570\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee\n\u6761\u4ef6\uff1amin(sal) > 15000 \n\u8bed\u53e5\uff1aselect job,count(*) from employee group by job having \xa0 min(sal) > 15000;\n"})}),"\n",(0,l.jsx)(n.p,{children:"8\u3001\u5217\u51fa\u5728\u9500\u552e\u90e8\u5de5\u4f5c\u7684\u5458\u5de5\u7684\u59d3\u540d\uff0c\u5047\u5b9a\u4e0d\u77e5\u9053\u9500\u552e\u90e8\u7684\u90e8\u95e8\u7f16\u53f7"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee dept\nselect  ename  from employee where deptnu=(select deptnu from dept where dname='\u9500\u552e\u90e8');\n"})}),"\n",(0,l.jsx)(n.p,{children:"9\u3001\u5217\u51fa\u4e0e\u8bf8\u845b\u4eae\u4ece\u4e8b\u76f8\u540c\u5de5\u4f5c\u7684\u6240\u6709\u5458\u5de5\u53ca\u90e8\u95e8\u540d\u79f0\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee dept\n\n\u8bed\u53e5\uff1aselect a.ename,b.dname from employee a,dept b where a.deptnu=b.deptnu and a.job=(select job from employee where ename='\u8bf8\u845b\u4eae');\n\n\u8bed\u53e5\uff1aselect a.ename,b.dname from employee a left join dept b on a.deptnu=b.deptnu where a.job=(select job from employee where ename='\u8bf8\u845b\u4eae');\n"})}),"\n",(0,l.jsx)(n.p,{children:"10\u3001\u5217\u51fa\u85aa\u91d1\u6bd4 \u5728\u90e8\u95e830\u5de5\u4f5c\u7684\u5458\u5de5\u7684\u85aa\u91d1 \u8fd8\u9ad8\u7684\u5458\u5de5\u59d3\u540d\u548c\u85aa\u91d1\u3001\u90e8\u95e8\u540d\u79f0\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee dept\n\u8bed\u53e5\uff1aselect a.ename,a.sal,b.dname from employee a ,dept b where a.deptnu=b.deptnu and sal > (select max(sal) from employee where deptnu=30);\n"})}),"\n",(0,l.jsx)(n.p,{children:"11\u3001\u5217\u51fa\u6bcf\u4e2a\u90e8\u95e8\u7684\u5458\u5de5\u6570\u91cf\u3001\u5e73\u5747\u5de5\u8d44\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee\n\u8bed\u53e5\uff1aselect deptnu , count(*) ,avg (sal) from employee  group by deptnu;\n"})}),"\n",(0,l.jsx)(n.p,{children:"12\u3001\u5217\u51fa\u85aa\u91d1\u9ad8\u4e8e\u516c\u53f8\u5e73\u5747\u85aa\u91d1\u7684\u6240\u6709\u5458\u5de5\u4fe1\u606f\uff0c\u6240\u5728\u90e8\u95e8\u540d\u79f0\uff0c\u4e0a\u7ea7\u9886\u5bfc\uff0c\u5de5\u8d44\u7b49\u7ea7\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"\u6d89\u53ca\u8868\uff1aemployee dept salgrade\n\u6761\u4ef6\uff1aselect avg(sal) from employee\n\n\u8bed\u53e5\uff1aelect a.*,c.dname,b.ename,d.grade from employee a,employee b,dept c ,salgrade d where a.mgr=b.empno and a.deptnu =c.deptnu and a.sal > (select avg(sal) from \nemployee)  and \xa0 a.sal  between d.lowsal and d.higsal;\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>m});var t=a(96540);const l={},o=t.createContext(l);function s(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function m(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),t.createElement(o.Provider,{value:n},e.children)}},46086:e=>{e.exports=JSON.parse('{"permalink":"/blog/productivity-exercise-3","editUrl":"https://github.com/Jachen99/Jachen99.github.io/tree/V4.0.0/blog/2018/06-11-\u7ec3\u4e60\u98983.md","source":"@site/blog/2018/06-11-\u7ec3\u4e60\u98983.md","title":"\u7ec3\u4e60\u98983","description":"\u8fd9\u662f\u4e00\u9053mysql\u6570\u636e\u67e5\u8be2\u7684\u7ec3\u4e60\u9898","date":"2018-06-11T00:00:00.000Z","tags":[],"readingTime":4.415,"hasTruncateMarker":false,"authors":[{"name":"\u5b63\u51a0\u81e3","title":"\u540e\u7aef\u7814\u53d1\u5de5\u7a0b\u5e08","url":"https://github.com/jachen99","page":{"permalink":"/blog/authors/jiguanchen"},"socials":{"github":"https://github.com/jachen99"},"imageURL":"https://github.com/jachen99.png","key":"jiguanchen"}],"frontMatter":{"slug":"productivity-exercise-3","title":"\u7ec3\u4e60\u98983","authors":["jiguanchen"]},"unlisted":false,"prevItem":{"title":"\u62bd\u8c61\u7684\u7279\u70b9","permalink":"/blog/product-abstract-features"},"nextItem":{"title":"\u7ec3\u4e60\u98982","permalink":"/blog/productivity-exercise-2"}}')}}]);