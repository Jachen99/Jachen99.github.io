<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="rss.xsl"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>è½¯ä»¶ä¸€ç­å­£åŒå­¦çš„ä¸–ç•Œ Blog</title>
        <link>https://jachen99.github.io/blog</link>
        <description>è½¯ä»¶ä¸€ç­å­£åŒå­¦çš„ä¸–ç•Œ Blog</description>
        <lastBuildDate>Mon, 02 Dec 2024 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-Hans</language>
        <item>
            <title><![CDATA[ä½¿ç”¨Java8æ–°ç‰¹æ€§æ„å»ºæ ‘å½¢ç»“æ„ï¼šçµæ´»çš„çˆ¶å­èŠ‚ç‚¹å…³ç³»å¤„ç†]]></title>
            <link>https://jachen99.github.io/blog/product-tree-structure-construction</link>
            <guid>https://jachen99.github.io/blog/product-tree-structure-construction</guid>
            <pubDate>Mon, 02 Dec 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ ‘å½¢ç»“æ„å¹¿æ³›åº”ç”¨äºç»„ç»‡å’Œè¡¨ç¤ºå±‚çº§åŒ–æ•°æ®ï¼Œå¦‚æ–‡ä»¶ç›®å½•ã€èœå•å¯¼èˆªã€ç»„ç»‡æ¶æ„ç­‰ã€‚Java 8 çš„æµå¼ API å’Œå‡½æ•°å¼ç¼–ç¨‹ç‰¹æ€§ä¸ºå¤„ç†è¿™ç±»é—®é¢˜æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚ä¸‹é¢å°†åˆ†äº«å¦‚ä½•ä½¿ç”¨ Java 8 ä¸­çš„ Function å’Œ BiConsumer ç­‰æ–°ç‰¹æ€§ï¼Œæ„å»ºæ ‘å½¢ç»“æ„å¹¶å¤„ç†çˆ¶å­èŠ‚ç‚¹å…³ç³»ã€‚]]></description>
            <content:encoded><![CDATA[<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ ‘å½¢ç»“æ„å¹¿æ³›åº”ç”¨äºç»„ç»‡å’Œè¡¨ç¤ºå±‚çº§åŒ–æ•°æ®ï¼Œå¦‚æ–‡ä»¶ç›®å½•ã€èœå•å¯¼èˆªã€ç»„ç»‡æ¶æ„ç­‰ã€‚Java 8 çš„æµå¼ API å’Œå‡½æ•°å¼ç¼–ç¨‹ç‰¹æ€§ä¸ºå¤„ç†è¿™ç±»é—®é¢˜æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚ä¸‹é¢å°†åˆ†äº«å¦‚ä½•ä½¿ç”¨ Java 8 ä¸­çš„ <code>Function</code> å’Œ <code>BiConsumer</code> ç­‰æ–°ç‰¹æ€§ï¼Œæ„å»ºæ ‘å½¢ç»“æ„å¹¶å¤„ç†çˆ¶å­èŠ‚ç‚¹å…³ç³»ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é¡¹ç›®èƒŒæ™¯">é¡¹ç›®èƒŒæ™¯<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF" class="hash-link" aria-label="é¡¹ç›®èƒŒæ™¯çš„ç›´æ¥é“¾æ¥" title="é¡¹ç›®èƒŒæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨è®¸å¤šä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ ¹æ®èŠ‚ç‚¹çš„çˆ¶å­å…³ç³»æ¥æ„å»ºä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç®€å•çš„äº¤æ˜“ä¿¡æ¯æ¨¡å‹å¯èƒ½åŒ…å«å¤šä¸ªäº¤æ˜“èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ä¹‹é—´æœ‰çˆ¶å­å…³ç³»ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿå®ç°å±‚çº§ç»“æ„ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œçµæ´»æ“ä½œã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é¡¹ç›®éœ€æ±‚">é¡¹ç›®éœ€æ±‚<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82" class="hash-link" aria-label="é¡¹ç›®éœ€æ±‚çš„ç›´æ¥é“¾æ¥" title="é¡¹ç›®éœ€æ±‚çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œå°†ä¸€ç»„æ•°æ®æ ¹æ®çˆ¶å­å…³ç³»æ„å»ºæˆæ ‘å½¢ç»“æ„ã€‚åœ¨æ ‘å½¢ç»“æ„ä¸­ï¼Œçˆ¶èŠ‚ç‚¹å°†åŒ…å«æ‰€æœ‰å­èŠ‚ç‚¹ã€‚æˆ‘ä»¬ä½¿ç”¨ Java 8 æä¾›çš„æµå¼æ“ä½œæ¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼ŒåŒæ—¶åˆ©ç”¨å‡½æ•°å¼æ¥å£ï¼Œå¦‚ <code>Function</code> å’Œ <code>BiConsumer</code>ï¼Œæ¥æé«˜ä»£ç çš„çµæ´»æ€§å’Œå¯å¤ç”¨æ€§ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å…³é”®æŠ€æœ¯">å…³é”®æŠ€æœ¯<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF" class="hash-link" aria-label="å…³é”®æŠ€æœ¯çš„ç›´æ¥é“¾æ¥" title="å…³é”®æŠ€æœ¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li><strong>BiConsumer</strong>ï¼šæ¥å—ä¸¤ä¸ªå‚æ•°å¹¶è¿”å› <code>void</code>ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥å¤„ç†èŠ‚ç‚¹ä¹‹é—´çš„çˆ¶å­å…³ç³»ï¼Œä¾‹å¦‚ä¸ºçˆ¶èŠ‚ç‚¹è®¾ç½®å­èŠ‚ç‚¹ã€‚</li>
<li><strong>Function</strong>ï¼šæ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°å¹¶è¿”å›ä¸€ä¸ªç»“æœï¼Œç”¨äºä»èŠ‚ç‚¹ä¸­è·å– ID å’Œçˆ¶ IDã€‚</li>
<li><strong>Stream API</strong>ï¼šé€šè¿‡æµå¼æ“ä½œå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å’Œå¤„ç†ï¼Œé¿å…äº†ä¼ ç»Ÿçš„åµŒå¥—å¾ªç¯æ–¹å¼ã€‚</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»£ç å®ç°">ä»£ç å®ç°<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="ä»£ç å®ç°çš„ç›´æ¥é“¾æ¥" title="ä»£ç å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Arrays;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.function.BiConsumer;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.function.Function;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.stream.Collectors;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * åŠŸèƒ½æè¿°: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * è¯¥ç±»ç”¨äºæ„å»ºæ ‘å½¢ç»“æ„ï¼ŒåŸºäºç»™å®šçš„æ•°æ®åˆ—è¡¨ï¼Œå°†çˆ¶å­èŠ‚ç‚¹å…³ç³»ç»„ç»‡æˆå±‚çº§åŒ–çš„æ ‘å½¢ç»“æ„ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * é€šè¿‡ä½¿ç”¨ Java 8 æ–°ç‰¹æ€§ï¼Œå¦‚ Function å’Œ BiConsumerï¼Œçµæ´»åœ°å¤„ç†èŠ‚ç‚¹é—´çš„çˆ¶å­å…³ç³»ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * åˆ›å»ºäºº: å­£å† è‡£</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * åˆ›å»ºæ—¶é—´: 2024/12/2 15:38</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TreeStructureTest {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // æ¨¡æ‹Ÿçš„èŠ‚ç‚¹ç±»</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    static class TradeInfo {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private String tradeID;  // å½“å‰èŠ‚ç‚¹ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private String parentID; // çˆ¶èŠ‚ç‚¹ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private List&lt;TradeInfo&gt; children;  // å­èŠ‚ç‚¹åˆ—è¡¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public TradeInfo(String tradeID, String parentID) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            this.tradeID = tradeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            this.parentID = parentID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            this.children = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // Getter å’Œ Setter æ–¹æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public String getTradeID() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return tradeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void setTradeID(String tradeID) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            this.tradeID = tradeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public String getParentID() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return parentID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void setParentID(String parentID) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            this.parentID = parentID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public List&lt;TradeInfo&gt; getChildren() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return children;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void setChildren(List&lt;TradeInfo&gt; children) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            this.children = children;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public String toString() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return "TradeInfo{" +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    "tradeID='" + tradeID + '\'' +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ", parentID='" + parentID + '\'' +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ", children=" + children +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    '}';</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // æ„å»ºæ ‘å½¢ç»“æ„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static &lt;T, R&gt; List&lt;T&gt; buildTree(List&lt;T&gt; dataList, BiConsumer&lt;T, List&lt;T&gt;&gt; setChildF, Function&lt;T, R&gt; getIdF,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                            Function&lt;T, R&gt; getParentIdF, R rootParentId) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (dataList != null &amp;&amp; !dataList.isEmpty()) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            setChildCall(dataList, setChildF, getIdF, getParentIdF, rootParentId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            dataList = dataList.stream()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    .filter(t -&gt; (rootParentId != null &amp;&amp; rootParentId.equals(getParentIdF.apply(t)))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                            || (rootParentId == null &amp;&amp; getParentIdF.apply(t) == null))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    .collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return dataList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // å°†å­é›†æ”¾å…¥çˆ¶çº§</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static &lt;T, R&gt; List&lt;T&gt; setChildCall(List&lt;T&gt; dataList, BiConsumer&lt;T, List&lt;T&gt;&gt; setChildF, Function&lt;T, R&gt; getIdF,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                               Function&lt;T, R&gt; getParentIdF, R parentId) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (dataList == null || dataList.isEmpty()) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return dataList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;T&gt; parentChild = dataList.stream()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .filter(t -&gt; parentId == null || (getParentIdF.apply(t) != null &amp;&amp; getParentIdF.apply(t).equals(parentId)))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (T t : parentChild) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            setChildF.accept(t, setChildCall(dataList, setChildF, getIdF, getParentIdF, getIdF.apply(t)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return parentChild;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åˆ›å»ºç¤ºä¾‹æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;TradeInfo&gt; dataList = Arrays.asList(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                new TradeInfo("1", null),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                new TradeInfo("2", "1"),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                new TradeInfo("3", "1"),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                new TradeInfo("4", "2"),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                new TradeInfo("5", "2")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å®šä¹‰å¦‚ä½•è·å–IDå’Œçˆ¶ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Function&lt;TradeInfo, String&gt; getIdF = TradeInfo::getTradeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Function&lt;TradeInfo, String&gt; getParentIdF = TradeInfo::getParentID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å®šä¹‰å¦‚ä½•è®¾ç½®å­èŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        BiConsumer&lt;TradeInfo, List&lt;TradeInfo&gt;&gt; setChildF = TradeInfo::setChildren;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æ„å»ºæ ‘ç»“æ„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;TradeInfo&gt; tree = buildTree(dataList, setChildF, getIdF, getParentIdF, null);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è¾“å‡ºç»“æœ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("æ„å»ºåçš„æ ‘å½¢ç»“æ„:");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tree.forEach(System.out::println);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»£ç è§£æ">ä»£ç è§£æ<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90" class="hash-link" aria-label="ä»£ç è§£æçš„ç›´æ¥é“¾æ¥" title="ä»£ç è§£æçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li><strong>TradeInfo ç±»</strong>ï¼šå®šä¹‰äº†ä¸€ä¸ªç®€å•çš„èŠ‚ç‚¹ç±»ï¼ŒåŒ…å« <code>tradeID</code> å’Œ <code>parentID</code>ï¼Œå¹¶é€šè¿‡ <code>children</code> åˆ—è¡¨å­˜å‚¨å­èŠ‚ç‚¹ã€‚</li>
<li><strong>buildTree æ–¹æ³•</strong>ï¼šè¿™æ˜¯æ ‘å½¢ç»“æ„æ„å»ºçš„æ ¸å¿ƒæ–¹æ³•ã€‚å®ƒé€šè¿‡é€’å½’å°†å­èŠ‚ç‚¹è®¾ç½®åˆ°çˆ¶èŠ‚ç‚¹ï¼Œå¹¶æ ¹æ®çˆ¶èŠ‚ç‚¹ ID ç­›é€‰å‡ºè¯¥å±‚çº§çš„èŠ‚ç‚¹ã€‚</li>
<li><strong>setChildCall æ–¹æ³•</strong>ï¼šè¯¥æ–¹æ³•å®ç°äº†é€’å½’çš„æ ¸å¿ƒé€»è¾‘ï¼Œé€šè¿‡ <code>BiConsumer</code> å°†å­èŠ‚ç‚¹è®¾ç½®åˆ°çˆ¶èŠ‚ç‚¹ï¼Œæ„å»ºæ ‘å½¢ç»“æ„ã€‚</li>
<li><strong>å‡½æ•°å¼æ¥å£</strong>ï¼šé€šè¿‡ <code>Function</code> æ¥å£è·å–èŠ‚ç‚¹çš„ ID å’Œçˆ¶ IDï¼Œé€šè¿‡ <code>BiConsumer</code> è®¾ç½®å­èŠ‚ç‚¹ï¼Œå®ç°äº†çµæ´»çš„èŠ‚ç‚¹å…³ç³»æ“ä½œã€‚</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è¾“å‡ºç»“æœ">è¾“å‡ºç»“æœ<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C" class="hash-link" aria-label="è¾“å‡ºç»“æœçš„ç›´æ¥é“¾æ¥" title="è¾“å‡ºç»“æœçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>è¿è¡Œä»¥ä¸Šä»£ç åï¼Œè¾“å‡ºçš„æ ‘å½¢ç»“æ„å°†å±•ç¤ºå¦‚ä¸‹ï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ„å»ºåçš„æ ‘å½¢ç»“æ„:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TradeInfo{tradeID='1', parentID='null', children=[TradeInfo{tradeID='2', parentID='1', children=[TradeInfo{tradeID='4', parentID='2', children=[]}, TradeInfo{tradeID='5', parentID='2', children=[]}]}, TradeInfo{tradeID='3', parentID='1', children=[]}]}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†äº¤æ˜“ä¿¡æ¯åˆ—è¡¨ç»„ç»‡æˆäº†æ ‘å½¢ç»“æ„ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å°ç»“">å°ç»“<a href="https://jachen99.github.io/blog/product-tree-structure-construction#%E5%B0%8F%E7%BB%93" class="hash-link" aria-label="å°ç»“çš„ç›´æ¥é“¾æ¥" title="å°ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é€šè¿‡ Java 8 çš„å‡½æ•°å¼ç¼–ç¨‹ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ ç®€æ´ã€çµæ´»åœ°å¤„ç†å¤æ‚çš„çˆ¶å­èŠ‚ç‚¹å…³ç³»ã€‚è¿™ç§æ–¹æ³•ä¸ä»…é€‚ç”¨äºæ ‘å½¢ç»“æ„çš„æ„å»ºï¼Œè¿˜èƒ½å¤Ÿå¹¿æ³›åº”ç”¨äºå…¶ä»–éœ€è¦å±‚çº§å…³ç³»çš„æ•°æ®å¤„ç†åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤„ç†æ–‡ä»¶ç›®å½•ã€ç»„ç»‡æ¶æ„ã€èœå•å±‚çº§ç­‰é—®é¢˜æ—¶ï¼Œé‡‡ç”¨ç±»ä¼¼çš„æ–¹æ³•å°†å¤§å¤§æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<blockquote>
<p>å½“ç„¶ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ ‘å½¢ç»“æ„å¯èƒ½ä¼šæ›´åŠ å¤æ‚ï¼Œæ¶‰åŠæ›´å¤šçš„ä¸šåŠ¡é€»è¾‘ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œæ‰©å±•å’Œè°ƒæ•´ã€‚å¸Œæœ›æœ¬æ–‡èƒ½ä¸ºä½ çš„å¼€å‘å·¥ä½œæä¾›ä¸€äº›å¯å‘ï¼ğŸš€</p>
</blockquote>
<hr>]]></content:encoded>
            <category>java</category>
        </item>
        <item>
            <title><![CDATA[SpringBooté›†æˆJasyptå®ç°Nacosé…ç½®åŠ å¯†ä¸è§£å¯†]]></title>
            <link>https://jachen99.github.io/blog/product-jasypt-nacos-config</link>
            <guid>https://jachen99.github.io/blog/product-jasypt-nacos-config</guid>
            <pubDate>Sat, 02 Nov 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨Nacosä¸­ä½¿ç”¨å›½å¯†SM4ç®—æ³•å¯¹æ•æ„Ÿä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œå¹¶åœ¨Spring Booté¡¹ç›®ä¸­è§£å¯†è¿™äº›é…ç½®é¡¹ã€‚ä½¿ç”¨Jasyptæ¥é›†æˆåŠ å¯†åº“ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„åŠ å¯†å™¨ï¼Œä»¥å®ç°é…ç½®é¡¹çš„åŠ å¯†å’Œè§£å¯†åŠŸèƒ½ã€‚]]></description>
            <content:encoded><![CDATA[<p>æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨Nacosä¸­ä½¿ç”¨å›½å¯†SM4ç®—æ³•å¯¹æ•æ„Ÿä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œå¹¶åœ¨Spring Booté¡¹ç›®ä¸­è§£å¯†è¿™äº›é…ç½®é¡¹ã€‚ä½¿ç”¨Jasyptæ¥é›†æˆåŠ å¯†åº“ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„åŠ å¯†å™¨ï¼Œä»¥å®ç°é…ç½®é¡¹çš„åŠ å¯†å’Œè§£å¯†åŠŸèƒ½ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-é›†æˆjasyptåŠ å¯†åº“">1. é›†æˆJasyptåŠ å¯†åº“<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#1-%E9%9B%86%E6%88%90jasypt%E5%8A%A0%E5%AF%86%E5%BA%93" class="hash-link" aria-label="1. é›†æˆJasyptåŠ å¯†åº“çš„ç›´æ¥é“¾æ¥" title="1. é›†æˆJasyptåŠ å¯†åº“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="11å°†jasyptåŠ å¯†åº“é›†æˆåˆ°spring-booté¡¹ç›®ä¸­åœ¨pomxmlæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–">1.1ã€å°†JasyptåŠ å¯†åº“é›†æˆåˆ°Spring Booté¡¹ç›®ä¸­ã€‚åœ¨pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#11%E5%B0%86jasypt%E5%8A%A0%E5%AF%86%E5%BA%93%E9%9B%86%E6%88%90%E5%88%B0spring-boot%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%9C%A8pomxml%E6%96%87%E4%BB%B6%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%BB%A5%E4%B8%8B%E4%BE%9D%E8%B5%96" class="hash-link" aria-label="1.1ã€å°†JasyptåŠ å¯†åº“é›†æˆåˆ°Spring Booté¡¹ç›®ä¸­ã€‚åœ¨pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼šçš„ç›´æ¥é“¾æ¥" title="1.1ã€å°†JasyptåŠ å¯†åº“é›†æˆåˆ°Spring Booté¡¹ç›®ä¸­ã€‚åœ¨pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">com.github.ulisesbocchio</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">jasypt-spring-boot</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.0.4</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>æ³¨ï¼šéœ€è¦å¼•ç”¨é«˜ç‰ˆæœ¬çš„3.0.4ï¼Œé¿å…å½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œå‚è€ƒ <a href="https://www.jianshu.com/p/c02276987d46" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/c02276987d46</a></em></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="12åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£-enableencryptableproperties">1.2ã€åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ @EnableEncryptableProperties<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#12%E5%9C%A8%E5%90%AF%E5%8A%A8%E7%B1%BB%E4%B8%8A%E6%B7%BB%E5%8A%A0%E6%B3%A8%E8%A7%A3-enableencryptableproperties" class="hash-link" aria-label="1.2ã€åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ @EnableEncryptablePropertiesçš„ç›´æ¥é“¾æ¥" title="1.2ã€åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ @EnableEncryptablePropertiesçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-åˆ›å»ºå›½å¯†sm4åŠ å¯†å·¥å…·ç±»">2. åˆ›å»ºå›½å¯†SM4åŠ å¯†å·¥å…·ç±»<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#2-%E5%88%9B%E5%BB%BA%E5%9B%BD%E5%AF%86sm4%E5%8A%A0%E5%AF%86%E5%B7%A5%E5%85%B7%E7%B1%BB" class="hash-link" aria-label="2. åˆ›å»ºå›½å¯†SM4åŠ å¯†å·¥å…·ç±»çš„ç›´æ¥é“¾æ¥" title="2. åˆ›å»ºå›½å¯†SM4åŠ å¯†å·¥å…·ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åˆ›å»ºå›½å¯†SM4åŠ å¯†å·¥å…·ç±»ï¼Œå®ƒå°†è´Ÿè´£å®é™…çš„åŠ å¯†å’Œè§£å¯†æ“ä½œã€‚å·²æœ‰å·¥å…·æ‰€åœ¨ç›®å½• com.space.jiguanchen.utils.Sm4Utils ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package com.space.jiguanchen.utils;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bouncycastle.pqc.math.linearalgebra.ByteUtils;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Arrays;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author jiguanchen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class Sm4Utils {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ENCODING = "UTF-8";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORIGTHM_NAME = "SM4";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME_ECB_PADDING = "SM4/ECB/PKCS7Padding";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final int DEFAULT_KEY_SIZE = 128;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String key="dhjashdasa26kl223jkwqe2ejwejwq";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Sm4Utils() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    static {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:ç”Ÿæˆecbæš—å·</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static Cipher generateEcbCipher(String algorithmName, int mode, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = Cipher.getInstance(algorithmName,BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Key sm4Key = new SecretKeySpec(key, ALGORIGTHM_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.init(mode, sm4Key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:è‡ªåŠ¨ç”Ÿæˆå¯†é’¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] generateKey() throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return generateKey(DEFAULT_KEY_SIZE);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] generateKey(int keySize) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        KeyGenerator kg = KeyGenerator.getInstance(ALGORIGTHM_NAME, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        kg.init(keySize, new SecureRandom());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return kg.generateKey().getEncoded();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:åŠ å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encryptEcb(String hexKey, String paramStr, String charset) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String cipherText = "";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (null != paramStr &amp;&amp; !"".equals(paramStr)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            byte[] keyData = ByteUtils.fromHexString(hexKey);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            charset = charset.trim();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (charset.length() &lt;= 0) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                charset = ENCODING;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            byte[] srcData = paramStr.getBytes(charset);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            byte[] cipherArray = encrypt_Ecb_Padding(keyData, srcData);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            cipherText = ByteUtils.toHexString(cipherArray);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipherText;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:åŠ å¯†æ¨¡å¼ä¹‹ecb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] encrypt_Ecb_Padding(byte[] key, byte[] data) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = generateEcbCipher(ALGORITHM_NAME_ECB_PADDING, Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] bs = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return bs;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:sm4è§£å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptEcb(String hexKey, String cipherText, String charset) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String decryptStr = "";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] keyData = ByteUtils.fromHexString(hexKey);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] cipherData = ByteUtils.fromHexString(cipherText);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] srcData = decrypt_Ecb_Padding(keyData, cipherData);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        charset = charset.trim();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (charset.length() &lt;= 0) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            charset = ENCODING;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        decryptStr = new String(srcData, charset);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return decryptStr;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:è§£å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt_Ecb_Padding(byte[] key, byte[] cipherText) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = generateEcbCipher(ALGORITHM_NAME_ECB_PADDING, Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher.doFinal(cipherText);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:å¯†ç æ ¡éªŒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static boolean verifyEcb(String hexKey,String cipherText,String paramStr) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        boolean flag = false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] keyData = ByteUtils.fromHexString(hexKey);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] cipherData = ByteUtils.fromHexString(cipherText);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] decryptData = decrypt_Ecb_Padding(keyData,cipherData);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] srcData = paramStr.getBytes(ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        flag = Arrays.equals(decryptData,srcData);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return flag;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *  @Description:æµ‹è¯•ç±»</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // è‡ªå®šä¹‰çš„32ä½16è¿›åˆ¶å¯†é’¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            String key = "dhjashdasa26kl223jkwqe2ejwejwq";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            String url = Sm4Utils.encryptEcb(key, "jdbc:mysql://127.0.0.1:3306/demo?serverTimezone=GMT%2B8",ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            String username = Sm4Utils.encryptEcb(key, "root",ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            String password = Sm4Utils.encryptEcb(key, "root",ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.println(url);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.println(username);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.println(password);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>Sm4Utils</code>ç±»åŒ…å«äº†å›½å¯†SM4ç®—æ³•çš„åŠ å¯†å’Œè§£å¯†æ–¹æ³•ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-åˆ›å»ºè‡ªå®šä¹‰çš„jasyptåŠ å¯†å™¨">3. åˆ›å»ºè‡ªå®šä¹‰çš„JasyptåŠ å¯†å™¨<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#3-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84jasypt%E5%8A%A0%E5%AF%86%E5%99%A8" class="hash-link" aria-label="3. åˆ›å»ºè‡ªå®šä¹‰çš„JasyptåŠ å¯†å™¨çš„ç›´æ¥é“¾æ¥" title="3. åˆ›å»ºè‡ªå®šä¹‰çš„JasyptåŠ å¯†å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä¸ºäº†è®©Nacosä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„åŠ å¯†å·¥å…·è¿›è¡Œé…ç½®è§£å¯†ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„JasyptåŠ å¯†å™¨ã€‚åœ¨é¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ªåä¸º<code>JasyptStringEncryptor</code>çš„ç±»ï¼Œå¹¶è®©å®ƒå®ç°jasyptæä¾›çš„<code>StringEncryptor</code>æ¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package com.space.jiguanchen.auth.config;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.space.jiguanchen.utils.Sm4Utils;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.jasypt.encryption.StringEncryptor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.beans.factory.annotation.Value;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author jiguanchen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class JasyptStringEncryptor implements StringEncryptor {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${my.jasyptEncryptor.enable:false}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private boolean enable;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public String encrypt(String message) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        final String exMsg = String.format("encrypt method is not implemented, original message: '%s'.", message);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        log.error(exMsg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        throw new UnsupportedOperationException(exMsg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public String decrypt(String message) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String decryptedMessage = null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (enable){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                decryptedMessage = Sm4Utils.decryptEcb(Sm4Utils.key,message,Sm4Utils.ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                decryptedMessage=message;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            log.debug("---------------------------------------è§£å¯†äº†: {} -----------------------------------",decryptedMessage);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            log.error("decrypt failed:"+message+"-"+ e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return decryptedMessage;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨<code>JasyptStringEncryptor</code>ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†ä¸€ä¸ªåä¸º<code>enable</code>çš„å±æ€§ï¼Œè¯¥å±æ€§ç”¨äºæ§åˆ¶åŠ å¯†åŠŸèƒ½æ˜¯å¦å¯ç”¨ã€‚å½“<code>enable</code>ä¸º<code>true</code>æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„å›½å¯†SM4å·¥å…·å¯¹é…ç½®ä¿¡æ¯è¿›è¡Œè§£å¯†ï¼›å½“<code>enable</code>ä¸º<code>false</code>æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥è¿”å›åŸå§‹é…ç½®ä¿¡æ¯ï¼Œå³ä¸è¿›è¡Œè§£å¯†æ“ä½œã€‚</p>
<p><em>æ³¨ï¼šå¦‚æœè‡ªå®šä¹‰ç±»åä¸æ˜¯JasyptStringEncryptorï¼Œåˆ™éœ€è¦åœ¨nacosä¸Šé¢æ·»åŠ é…ç½®ï¼š</em></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">jasypt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">encryptor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## å®ç°jasyptåŠ åŠ å¯†è§£å¯†çš„ç±»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">bean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> JasyptStringEncryptorDemo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-é…ç½®nacosä½¿ç”¨è‡ªå®šä¹‰åŠ å¯†å™¨">4. é…ç½®Nacosä½¿ç”¨è‡ªå®šä¹‰åŠ å¯†å™¨<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#4-%E9%85%8D%E7%BD%AEnacos%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E5%AF%86%E5%99%A8" class="hash-link" aria-label="4. é…ç½®Nacosä½¿ç”¨è‡ªå®šä¹‰åŠ å¯†å™¨çš„ç›´æ¥é“¾æ¥" title="4. é…ç½®Nacosä½¿ç”¨è‡ªå®šä¹‰åŠ å¯†å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦åœ¨Nacosé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šä½¿ç”¨è‡ªå®šä¹‰çš„åŠ å¯†å™¨ã€‚åœ¨<code>bootstrap.properties</code>æˆ–<code>bootstrap.yml</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># å¯ç”¨è‡ªå®šä¹‰åŠ å¯†å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">jasyptEncryptor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">enable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain">  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œçš„<code>my.jasyptEncryptor.enable</code>å±æ€§çš„å€¼è®¾ç½®ä¸º<code>true</code>ï¼Œè¡¨ç¤ºå¯ç”¨æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„åŠ å¯†é€»è¾‘ï¼Œå³ä½¿ç”¨å›½å¯†SM4è¿›è¡Œè§£å¯†ã€‚å¦‚æœè¦ç¦ç”¨åŠ å¯†åŠŸèƒ½ï¼Œå°†å…¶è®¾ç½®ä¸º<code>false</code>ã€‚</p>
<p>å®Œæˆäº†ä»¥ä¸Šæ­¥éª¤åï¼ŒNacosä¼šåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½å¹¶ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰åŠ å¯†å™¨ï¼Œä»è€Œå®ç°æ•°æ®åº“é…ç½®çš„è§£å¯†æ“ä½œã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-åŠ å¯†é…ç½®é¡¹å¹¶æ”¾å…¥nacos">5. åŠ å¯†é…ç½®é¡¹å¹¶æ”¾å…¥Nacos<a href="https://jachen99.github.io/blog/product-jasypt-nacos-config#5-%E5%8A%A0%E5%AF%86%E9%85%8D%E7%BD%AE%E9%A1%B9%E5%B9%B6%E6%94%BE%E5%85%A5nacos" class="hash-link" aria-label="5. åŠ å¯†é…ç½®é¡¹å¹¶æ”¾å…¥Nacosçš„ç›´æ¥é“¾æ¥" title="5. åŠ å¯†é…ç½®é¡¹å¹¶æ”¾å…¥Nacosçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä½¿ç”¨å›½å¯†SM4åŠ å¯†å·¥å…·ç±»<code>Sm4Utils</code>æ¥åŠ å¯†æ•æ„Ÿé…ç½®é¡¹ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥çš„urlã€usernameå’Œpasswordã€‚åœ¨Sm4Utilsçš„<code>main</code>æ–¹æ³•ä¸­è¿›è¡ŒåŠ å¯†æ“ä½œï¼Œå¾—åˆ°åŠ å¯†åçš„é…ç½®é¡¹ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è‡ªå®šä¹‰çš„32ä½16è¿›åˆ¶å¯†é’¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String key = "dhjashdasa26kl223jkwqe2ejwejwq";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String url = Sm4Utils.encryptEcb(key, "jdbc:mysql://127.0.0.1:3306/demo?serverTimezone=GMT%2B8",ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String username = Sm4Utils.encryptEcb(key, "root",ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String password = Sm4Utils.encryptEcb(key, "root",ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(url);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(username);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(password);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¾—åˆ°åŠ å¯†åçš„å¯†æ–‡é…ç½®é¡¹ï¼Œå°†å®ƒä»¬ä½œä¸ºå€¼å­˜æ”¾åˆ°Nacosä¸­çš„é…ç½®é¡¹ä¸­ï¼š</p>
<div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">url=ENC(opkdai32klsamnxa97b678f092c50e042f756371ef644de9dc4aa6318afa8a304a20b327ce84eb573ade0fb7336be9827cec08cd149f0c5380af4926f5219b7829edde1b4026d4229d30a86702851948164bc23af18a4797bae23f7833c2239ab3fd654dc234be37b2b3f31cbeae9e09eaf519a04a623d3c5795d23fa8fa3ce1c59eaf87c0af</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">username=ENC(dasjkdljasdjad23342mkljjlk)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password=ENC(0298hsdajd328783jdsakjd212)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é‡å¯æœåŠ¡ï¼Œåœ¨Nacoså¯åŠ¨æ—¶ä¼šè¢«æ­£ç¡®åœ°è§£å¯†å¹¶åŠ è½½åˆ°Spring Booté¡¹ç›®ä¸­ã€‚</p>]]></content:encoded>
            <category>å®‰å…¨</category>
        </item>
        <item>
            <title><![CDATA[æ¢ç©¶é›¶æ‹·è´æŠ€æœ¯]]></title>
            <link>https://jachen99.github.io/blog/product-introduction-of-zero-copy-technology</link>
            <guid>https://jachen99.github.io/blog/product-introduction-of-zero-copy-technology</guid>
            <pubDate>Thu, 10 Oct 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šRocketMQæ˜¯é˜¿é‡Œå›¢é˜Ÿç ”å‘å¹¶å¼€æºçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒå»¶ç»­äº†kafkaçš„å¾ˆå¤šä¼˜ç‚¹ï¼Œä¾‹å¦‚é«˜æ€§èƒ½ï¼Œä¸ºäº†ç ”ç©¶RocketMQç©¶ç«Ÿæ˜¯å¦‚ä½•åšåˆ°é«˜æ€§èƒ½çš„å‘¢ï¼Ÿé›¶æ‹·è´æŠ€æœ¯å°±æ˜¯ä¸€ä¸ªé‡è¦çš„åŸå› ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>RocketMQæ˜¯é˜¿é‡Œå›¢é˜Ÿç ”å‘å¹¶å¼€æºçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒå»¶ç»­äº†kafkaçš„å¾ˆå¤šä¼˜ç‚¹ï¼Œä¾‹å¦‚é«˜æ€§èƒ½ï¼Œä¸ºäº†ç ”ç©¶RocketMQç©¶ç«Ÿæ˜¯å¦‚ä½•åšåˆ°é«˜æ€§èƒ½çš„å‘¢ï¼Ÿé›¶æ‹·è´æŠ€æœ¯å°±æ˜¯ä¸€ä¸ªé‡è¦çš„åŸå› ã€‚</em></p>
<p>é«˜æ•ˆåŸå› ï¼š</p>
<ul>
<li>
<p>CommitLogé¡ºåºå†™, å­˜å‚¨äº†MessagBodyã€message keyã€tagç­‰ä¿¡æ¯</p>
</li>
<li>
<p>ConsumeQueueéšæœºè¯» + æ“ä½œç³»ç»Ÿçš„PageCache + é›¶æ‹·è´æŠ€æœ¯ZeroCopy</p>
<ul>
<li>
<p>é›¶æ‹·è´æŠ€æœ¯</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">read(file, tmp_buf, len);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">write(socket, tmp_buf, len);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>ä¾‹å­ï¼šå°†ä¸€ä¸ªFileè¯»å–å¹¶å‘é€å‡ºå»ï¼ˆLinuxæœ‰ä¸¤ä¸ªä¸Šä¸‹æ–‡ï¼Œå†…æ ¸æ€ï¼Œç”¨æˆ·æ€ï¼‰</p>
<ul>
<li>Fileæ–‡ä»¶çš„ç»å†äº†4æ¬¡copy<!-- -->
<ul>
<li>è°ƒç”¨read,å°†æ–‡ä»¶æ‹·è´åˆ°äº†kernelå†…æ ¸æ€</li>
<li>CPUæ§åˆ¶ kernelæ€çš„æ•°æ®copyåˆ°ç”¨æˆ·æ€</li>
<li>è°ƒç”¨writeæ—¶ï¼Œuseræ€ä¸‹çš„å†…å®¹ä¼šcopyåˆ°å†…æ ¸æ€çš„socketçš„bufferä¸­</li>
<li>æœ€åå°†å†…æ ¸æ€socket bufferçš„æ•°æ®copyåˆ°ç½‘å¡è®¾å¤‡ä¸­ä¼ é€</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼šå¢åŠ äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ã€æµªè´¹äº†2æ¬¡æ— æ•ˆæ‹·è´(å³æ­¥éª¤2å’Œ3)</li>
</ul>
</li>
<li>
<p>ZeroCopyï¼š</p>
<ul>
<li>è¯·æ±‚kernelç›´æ¥æŠŠdiskçš„dataä¼ è¾“ç»™socketï¼Œè€Œä¸æ˜¯é€šè¿‡åº”ç”¨ç¨‹åºä¼ è¾“ã€‚Zero copyå¤§å¤§æé«˜äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œå‡å°‘ä¸å¿…è¦çš„å†…æ ¸ç¼“å†²åŒºè·Ÿç”¨æˆ·ç¼“å†²åŒºé—´çš„æ‹·è´ï¼Œä»è€Œå‡å°‘CPUçš„å¼€é”€å’Œå‡å°‘äº†kernelå’Œuseræ¨¡å¼çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¾¾åˆ°æ€§èƒ½çš„æå‡</li>
<li>å¯¹åº”é›¶æ‹·è´æŠ€æœ¯æœ‰mmapåŠsendfile<!-- -->
<ul>
<li>mmap:å°æ–‡ä»¶ä¼ è¾“å¿«<!-- -->
<ul>
<li>RocketMQ é€‰æ‹©è¿™ç§æ–¹å¼ï¼Œmmap+write æ–¹å¼ï¼Œå°å—æ•°æ®ä¼ è¾“ï¼Œæ•ˆæœä¼šæ¯” sendfile æ›´å¥½</li>
</ul>
</li>
<li>sendfile:å¤§æ–‡ä»¶ä¼ è¾“æ¯”mmapå¿«</li>
</ul>
</li>
<li>Javaä¸­çš„TransferTo()å®ç°äº†Zero-Copy</li>
<li>åº”ç”¨ï¼šKafkaã€Nettyã€RocketMQç­‰éƒ½é‡‡ç”¨äº†é›¶æ‹·è´æŠ€æœ¯</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>åŸå§‹çš„æ‹·è´æŠ€æœ¯ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20230128234721451" src="https://jachen99.github.io/assets/images/image-20230128234721451-dd4af67b7a2fa7c9784cf766e100dfae.png" width="805" height="562" class="img_ev3q"></p>
<p>é›¶æ‹·è´æŠ€æœ¯ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20230128234745085" src="https://jachen99.github.io/assets/images/image-20230128234745085-207f8aae1e516506317e609e36e7f1d5.png" width="761" height="492" class="img_ev3q"></p>
<p>å‚è€ƒæ–‡ç« ï¼š <a href="https://github.com/0voice/linux_kernel_wiki/blob/main/%E6%96%87%E7%AB%A0/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/%E4%B8%80%E6%96%87%E5%B8%A6%E4%BD%A0%EF%BC%8C%E5%BD%BB%E5%BA%95%E4%BA%86%E8%A7%A3%EF%BC%8C%E9%9B%B6%E6%8B%B7%E8%B4%9DZero-Copy%E6%8A%80%E6%9C%AF.md" target="_blank" rel="noopener noreferrer">https://github.com/0voice/linux_kernel_wiki/blob/main/%E6%96%87%E7%AB%A0/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/%E4%B8%80%E6%96%87%E5%B8%A6%E4%BD%A0%EF%BC%8C%E5%BD%BB%E5%BA%95%E4%BA%86%E8%A7%A3%EF%BC%8C%E9%9B%B6%E6%8B%B7%E8%B4%9DZero-Copy%E6%8A%80%E6%9C%AF.md</a></p>]]></content:encoded>
            <category>RocketMQ</category>
        </item>
        <item>
            <title><![CDATA[æ¢ç©¶Nginxä¼˜é›…reloadçš„ç»†èŠ‚]]></title>
            <link>https://jachen99.github.io/blog/product-nginx-reload</link>
            <guid>https://jachen99.github.io/blog/product-nginx-reload</guid>
            <pubDate>Wed, 02 Oct 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šæˆ‘ä»¬çŸ¥é“åœ¨Ngnixçš„confé…ç½®æ–‡ä»¶ä¹‹å,ä¸èƒ½killæ‰matseré‡æ–°å¯åŠ¨NgnixæœåŠ¡å™¨ï¼Œè€Œæ˜¯éœ€è¦æ‰§è¡Œ nginx -s reloadå‘½ä»¤ï¼Œåœ¨ ä¸åœæ­¢æœåŠ¡å§‹ç»ˆåœ¨å¤„ç†æ–°çš„è¯·æ±‚çš„åŒæ—¶æŠŠ nginx çš„é…ç½®æ–‡ä»¶å¹³æ»‘çš„æŠŠæ—§çš„ nginx.conf é…ç½®æ›´æ–°ä¸ºæ–°çš„ nginx.conf é…ç½®ã€‚é‚£ä¹ˆè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>æˆ‘ä»¬çŸ¥é“åœ¨Ngnixçš„confé…ç½®æ–‡ä»¶ä¹‹å,ä¸èƒ½killæ‰matseré‡æ–°å¯åŠ¨NgnixæœåŠ¡å™¨ï¼Œè€Œæ˜¯éœ€è¦æ‰§è¡Œ nginx -s reloadå‘½ä»¤ï¼Œåœ¨ ä¸åœæ­¢æœåŠ¡å§‹ç»ˆåœ¨å¤„ç†æ–°çš„è¯·æ±‚çš„åŒæ—¶æŠŠ nginx çš„é…ç½®æ–‡ä»¶å¹³æ»‘çš„æŠŠæ—§çš„ nginx.conf é…ç½®æ›´æ–°ä¸ºæ–°çš„ nginx.conf é…ç½®ã€‚é‚£ä¹ˆè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</em></p>
<p>è¿™æ ·ä¸€ä¸ªåŠŸèƒ½å¯¹äº nginx éå¸¸æœ‰å¿…è¦ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¼šå‘ç°åœ¨æ‰§è¡Œ <code>nginx -s reload</code> å‘½ä»¤åï¼Œworker å­è¿›ç¨‹çš„æ•°é‡ä¼šå˜å¤šäº†ï¼Œè¿™æ˜¯å› ä¸ºè€çš„é…ç½®è¿è¡Œçš„ worker è¿›ç¨‹é•¿æ—¶é—´æ²¡æœ‰é€€å‡ºï¼Œå½“ä½¿ç”¨ stream åšå››å±‚åå‘ä»£ç†çš„æ—¶å€™ï¼Œå¯èƒ½è¿™ç§åœºæ™¯ä¼šæ›´å¤šã€‚</p>
<p>é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬é€šè¿‡åˆ†æ nginx çš„ reload æµç¨‹ï¼Œæ¥æ¢ç©¶ä¸‹ nginx åˆ°åº•åšäº†äº›ä»€ä¹ˆï¼Ÿæ‰€è°“ä¼˜é›…çš„é€€å‡ºå’Œç«‹å³é€€å‡ºæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reloadæµç¨‹">reloadæµç¨‹<a href="https://jachen99.github.io/blog/product-nginx-reload#reload%E6%B5%81%E7%A8%8B" class="hash-link" aria-label="reloadæµç¨‹çš„ç›´æ¥é“¾æ¥" title="reloadæµç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="image-20230129234025673" src="https://jachen99.github.io/assets/images/image-20230129234025673-408e9591c6b983445a857dc17ae854f4.png" width="867" height="594" class="img_ev3q"></p>
<p>ç¬¬ä¸€æ­¥åœ¨ä¿®æ”¹å¥½ nginx çš„é…ç½®æ–‡ä»¶ nginx.conf åï¼Œå‘ master è¿›ç¨‹å‘é€ HUP ä¿¡å·ï¼Œè¿™å®é™…ä¸Šå’Œæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ <code>nginx -s reload</code> å‘½ä»¤æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>é‚£ä¹ˆ master è¿›ç¨‹åœ¨æ”¶åˆ° HUP ä¿¡å·ä»¥åï¼Œä¼šåœ¨ç¬¬äºŒæ­¥æ£€æŸ¥æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¹¶ä¸ä¸€å®šéè¦åœ¨ nginx -s reload å‰æ‰§è¡Œ nginx -t æ£€éªŒä¸‹è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå› ä¸ºåœ¨ç¬¬äºŒæ­¥ nginx çš„ master è¿›ç¨‹ä¸€å®šä¼šæ‰§è¡Œè¿™ä¸ªæ­¥éª¤ã€‚</p>
<p>åœ¨ nginx çš„é…ç½®è¯­æ³•å…¨éƒ¨æ­£ç¡®ä»¥åï¼Œmaster è¿›ç¨‹ä¼šæ‰“å¼€æ–°çš„ç›‘å¬ç«¯å£ï¼Œä¸ºä»€ä¹ˆè¦åœ¨ master è¿›ç¨‹ä¸­æ‰“å¼€æ–°çš„ç›‘å¬ç«¯å£ï¼Ÿå› ä¸ºæˆ‘ä»¬å¯èƒ½åœ¨ nginx.conf ä¸­ä¼šå¼•å…¥æ–°çš„ä¾‹å¦‚ 443 æˆ–è€…ä¹‹å‰æˆ‘ä»¬æ²¡æœ‰æ‰“å¼€çš„çš„ç›‘å¬ç«¯å£ï¼Œè€Œæ‰€æœ‰ worker è¿›ç¨‹æ˜¯ master è¿›ç¨‹ çš„å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹æ‰€æœ‰å·²ç»æ‰“å¼€çš„ç«¯å£ï¼Œè¿™æ˜¯ linux æ“ä½œç³»ç»Ÿå®šä¹‰çš„ï¼Œæ‰€ä»¥ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬ master è¿›ç¨‹æ‰“å¼€äº†å¯èƒ½å¼•å…¥çš„æ–°çš„ç›‘å¬ç«¯å£ã€‚</p>
<p>æ¥ä¸‹æ¥ mster è¿›ç¨‹ä¼šç”¨æ–°çš„ nginx.conf é…ç½®æ–‡ä»¶æ¥å¯åŠ¨æ–°çš„ worker å­è¿›ç¨‹ï¼Œé‚£ä¹ˆè€çš„ worker å­è¿›ç¨‹ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ä¼šåœ¨ç¬¬äº”æ­¥åœ¨å¯åŠ¨æ–°çš„ worker å­è¿›ç¨‹ä»¥åï¼Œç”± master è¿›ç¨‹å†å‘è€ worker å­è¿›ç¨‹å‘é€ QUIT ä¿¡å·ï¼ŒQUIT ä¿¡å·å’Œ TERMï¼ŒINT ä¿¡å·æ˜¯ä¸ä¸€æ ·çš„ï¼ŒQUIT ä¿¡å·æ˜¯è¯·ä¼˜é›…åœ°å…³é—­å­è¿›ç¨‹ï¼Œè¿™æ—¶å€™éœ€è¦å…³æ³¨é¡ºåºï¼Œå› ä¸º nginx éœ€è¦ä¿è¯å¹³æ»‘ï¼Œæ‰€ä»¥è¦å…ˆå¯åŠ¨æ–°çš„ worker å­è¿›ç¨‹ï¼Œå†å‘è€çš„ worker å­è¿›ç¨‹å‘é€ QUIT ä¿¡å·ã€‚</p>
<p>é‚£ä¹ˆè€çš„ master å­è¿›ç¨‹æ”¶åˆ° QUIT ä¿¡å·åï¼Œé¦–å…ˆå…³é—­ç›‘å¬å¥æŸ„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ—¶å€™æ–°çš„è¿æ¥åªä¼šåˆ°æ–°çš„ worker å­è¿›ç¨‹ï¼Œæ‰€ä»¥è™½ç„¶ä»–ä»¬ä¹‹é—´æœ‰æ—¶é—´å·®ï¼Œä½†æ˜¯æ—¶é—´æ˜¯éå¸¸å¿«é€Ÿçš„ï¼Œé‚£ä¹ˆå…³é—­ç›‘å¬å¥æŸ„åï¼Œå¤„ç†å®Œå½“å‰è¿æ¥åå°±ç»“æŸè¿›ç¨‹ã€‚</p>
<p>ä¸‹é¢çœ‹ reload ä¸åœæœºè½½å…¥æ–°é…ç½®çš„å›¾ç¤ºã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reload-ä¸åœæœºè½½å…¥æ–°é…ç½®">reload ä¸åœæœºè½½å…¥æ–°é…ç½®<a href="https://jachen99.github.io/blog/product-nginx-reload#reload-%E4%B8%8D%E5%81%9C%E6%9C%BA%E8%BD%BD%E5%85%A5%E6%96%B0%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="reload ä¸åœæœºè½½å…¥æ–°é…ç½®çš„ç›´æ¥é“¾æ¥" title="reload ä¸åœæœºè½½å…¥æ–°é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="1356806-20191216111255642-526956790" src="https://jachen99.github.io/assets/images/1356806-20191216111255642-526956790-c3d6cf140a54e7b57d0e02248be04cb7.png" width="2016" height="1020" class="img_ev3q"></p>
<p>master è¿›ç¨‹ä¸ŠåŸå…ˆæœ‰å››ä¸ªç»¿è‰²çš„ worker å­è¿›ç¨‹ï¼Œå®ƒä»¬ä½¿ç”¨äº†è€çš„é…ç½®ï¼Œå½“æˆ‘ä»¬æ›´æ”¹äº† nginx.conf é…ç½®æ–‡ä»¶åï¼Œå‘ master å‘é€ SIGHUP ä¿¡å·æˆ–è€…æ‰§è¡Œ reload å‘½ä»¤ï¼Œ ç„¶å master ä¼šç”¨æ–°çš„é…ç½®æ–‡ä»¶å¯åŠ¨å››ä¸ªæ–°çš„é»„è‰² worker å­è¿›ç¨‹ï¼Œæ­¤æ—¶æ˜¯å››ä¸ªè€çš„ç»¿è‰² worker å­è¿›ç¨‹å’Œå››ä¸ªæ–°çš„é»„è‰²çš„ worker å­è¿›ç¨‹æ˜¯å¹¶å­˜çš„ã€‚é‚£ä¹ˆè€çš„ worker å­è¿›ç¨‹åœ¨æ­£å¸¸çš„æƒ…å†µä¸‹ä¼šåœ¨å¤„ç†å·²ç»å»ºç«‹å¥½çš„è¿æ¥ä¸Šçš„è¯·æ±‚ä¹‹åå…³é—­è¿™ä¸ªè¿æ¥ï¼Œå“ªæ€•è¿™ä¸ªè¿æ¥æ˜¯ keeplive è¯·æ±‚ä¹Ÿä¼šæ­£å¸¸å…³é—­ã€‚</p>
<p>ä½†æ˜¯å¼‚å¸¸æƒ…å†µï¼Œå¦‚æœæœ‰ä¸€äº›è¯·æ±‚å‡ºç°é—®é¢˜ï¼Œå®¢æˆ·ç«¯é•¿æ—¶é—´æ— æ³•å¤„ç†ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´è¿™ä¸ªè¯·æ±‚é•¿æ—¶é—´åœç•™åœ¨è¿™ä¸ª worker å­è¿›ç¨‹å½“ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ª worker å­è¿›ç¨‹ä¼šé•¿æ—¶é—´å­˜åœ¨ï¼Œå› ä¸ºæ–°çš„è¿æ¥å·²ç»è·‘åœ¨é»„è‰²çš„ worker å­è¿›ç¨‹ä¸­ï¼Œæ‰€ä»¥å½±å“å¹¶ä¸ä¼šå¾ˆå¤§ï¼Œå”¯ä¸€ä¼šå½±å“çš„å°±æ˜¯ç»¿è‰²çš„ worker å­è¿›ç¨‹ä¼šé•¿æ—¶é—´å­˜åœ¨ï¼Œä½†ä¹Ÿåªå½±å“å·²å­˜åœ¨çš„è¿æ¥ï¼Œä¸ä¼šå½±å“æ–°çš„è¿æ¥ã€‚</p>
<p>æˆ‘ä»¬æœ‰ä»€ä¹ˆåŠæ³•å¤„ç†å‘¢ï¼Ÿåœ¨æ–°ç‰ˆæœ¬ä¸­æä¾›äº†ä¸€ä¸ªæ–°çš„é…ç½® worker_shutdown_timeoutï¼Œä¹Ÿå°±æ˜¯è¯´æœ€é•¿ç­‰å¾…å¤šé•¿æ—¶é—´ï¼Œè¿™æ · master è¿›ç¨‹å¯åŠ¨æ–°çš„é»„è‰² worker è¿›ç¨‹ä¹‹åï¼Œå¦‚æœè€çš„ worker è¿›ç¨‹ä¸€ç›´æ²¡æœ‰é€€å‡ºï¼Œæ—¶é—´åˆ°äº†ä¹‹åä¼šå¼ºåˆ¶æŠŠè€çš„ worker è¿›ç¨‹é€€å‡ºæ‰ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“<a href="https://jachen99.github.io/blog/product-nginx-reload#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æœ¬æ–‡ä¸»è¦è®²è§£äº† Nginx å¹³æ»‘å‡çº§æ–°çš„é…ç½®æ–‡ä»¶çš„æµç¨‹ï¼Œåœ¨æˆ‘ä»¬äº†è§£äº†ä¼˜é›…å…³é—­ worker å­è¿›ç¨‹å’Œå¯åŠ¨æ–°é…ç½®çš„ worker å­è¿›ç¨‹æµç¨‹é—´çš„å…³ç³»åï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°å¤„ç†ç½•è§çš„å¼‚å¸¸åœºæ™¯ã€‚</p>]]></content:encoded>
            <category>Nginx</category>
        </item>
        <item>
            <title><![CDATA[EasyExcelä¸­çš„æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè¯¦è§£]]></title>
            <link>https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel</link>
            <guid>https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel</guid>
            <pubDate>Tue, 09 Jul 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[EasyExcelä¸­çš„æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè¯¦è§£]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="easyexcelä¸­çš„æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè¯¦è§£">EasyExcelä¸­çš„æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè¯¦è§£<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#easyexcel%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%AC%AC%E4%B8%80%E8%A1%8C%E8%8E%B7%E5%8F%96%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E8%AF%A6%E8%A7%A3" class="hash-link" aria-label="EasyExcelä¸­çš„æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè¯¦è§£çš„ç›´æ¥é“¾æ¥" title="EasyExcelä¸­çš„æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè¯¦è§£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨Javaå¼€å‘ä¸­ï¼Œå¤„ç†Excelæ–‡ä»¶æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚EasyExcelä½œä¸ºä¸€ä¸ªæµè¡Œçš„Excelæ“ä½œåº“ï¼Œæä¾›äº†æ–¹ä¾¿è€Œé«˜æ•ˆçš„APIæ¥è¯»å†™Excelæ–‡ä»¶ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ä¼šé‡åˆ°æ•°æ®ç¬¬ä¸€è¡Œè¢«è¯¯è¯»ä¸ºè¡¨å¤´çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨Excelæ–‡ä»¶çš„ç¬¬ä¸€è¡Œä¸æ˜¯æ ‡å‡†è¡¨å¤´è€Œæ˜¯å®é™…æ•°æ®æ—¶ï¼Œè¿™ä¸€é—®é¢˜æ˜¾å¾—å°¤ä¸ºçªå‡ºã€‚æœ¬æ–‡å°†è¯¦ç»†è®¨è®ºè¿™ä¸€é—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œå¹¶æä¾›ä¸€ç§æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-easyexcelç®€ä»‹">1. EasyExcelç®€ä»‹<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#1-easyexcel%E7%AE%80%E4%BB%8B" class="hash-link" aria-label="1. EasyExcelç®€ä»‹çš„ç›´æ¥é“¾æ¥" title="1. EasyExcelç®€ä»‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>EasyExcelæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€æ¬¾Javaæ“ä½œExcelçš„å·¥å…·åº“ï¼Œå®ƒæä¾›äº†å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ”¯æŒå¤§æ•°æ®é‡çš„è¯»å†™æ“ä½œï¼Œå¹¶ä¸”æä¾›äº†ä¸°å¯Œçš„æ ·å¼å’Œæ ¼å¼å¤„ç†åŠŸèƒ½ï¼Œé€‚ç”¨äºå„ç§åœºæ™¯ä¸‹çš„Excelæ–‡ä»¶å¤„ç†éœ€æ±‚ã€‚ä½ å¯ä»¥è®¿é—® EasyExcel çš„å®˜æ–¹ GitHub é¡µé¢è·å–æ›´å¤šçš„èµ„æ–™å’Œä¸‹è½½ï¼š <a href="https://github.com/alibaba/easyexcel" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-é—®é¢˜æè¿°">2. é—®é¢˜æè¿°<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#2-%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0" class="hash-link" aria-label="2. é—®é¢˜æè¿°çš„ç›´æ¥é“¾æ¥" title="2. é—®é¢˜æè¿°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨ä½¿ç”¨EasyExcelè¯»å–Excelæ–‡ä»¶æ—¶ï¼Œç»å¸¸ä¼šå‡ºç°ç¬¬ä¸€è¡Œæ•°æ®è¢«é”™è¯¯åœ°è¯†åˆ«ä¸ºè¡¨å¤´çš„æƒ…å†µã€‚è¿™ä¸€é—®é¢˜çš„æ ¹æœ¬åŸå› åœ¨äºEasyExcelåœ¨æŸäº›æƒ…å†µä¸‹æ— æ³•æ­£ç¡®è¯†åˆ«Excelæ–‡ä»¶ä¸­æ•°æ®è¡Œå’Œè¡¨å¤´è¡Œçš„åŒºåˆ†ï¼Œç‰¹åˆ«æ˜¯å½“Excelæ–‡ä»¶ç»“æ„æ¯”è¾ƒå¤æ‚æˆ–è€…å­˜åœ¨ç‰¹å®šæ ¼å¼æ—¶ï¼ŒEasyExcelçš„é»˜è®¤è§£æé€»è¾‘å¯èƒ½ä¼šå‡ºç°åå·®ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-è§£å†³æ–¹æ¡ˆè¯¦è§£">3. è§£å†³æ–¹æ¡ˆè¯¦è§£<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#3-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E8%AF%A6%E8%A7%A3" class="hash-link" aria-label="3. è§£å†³æ–¹æ¡ˆè¯¦è§£çš„ç›´æ¥é“¾æ¥" title="3. è§£å†³æ–¹æ¡ˆè¯¦è§£çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸ºäº†è§£å†³æ•°æ®ç¬¬ä¸€è¡Œè·å–é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹æ­¥éª¤æ¥è°ƒæ•´å’Œä¼˜åŒ–EasyExcelçš„è¯»å–æ“ä½œï¼Œç¡®ä¿èƒ½å¤Ÿæ­£ç¡®è·å–å®é™…æ•°æ®è¡Œè€Œéè¡¨å¤´è¡Œï¼š</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="æ–¹æ¡ˆ1æ‰‹åŠ¨æŒ‡å®šæ•°æ®èµ·å§‹è¡Œ">æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨æŒ‡å®šæ•°æ®èµ·å§‹è¡Œ<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#%E6%96%B9%E6%A1%881%E6%89%8B%E5%8A%A8%E6%8C%87%E5%AE%9A%E6%95%B0%E6%8D%AE%E8%B5%B7%E5%A7%8B%E8%A1%8C" class="hash-link" aria-label="æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨æŒ‡å®šæ•°æ®èµ·å§‹è¡Œçš„ç›´æ¥é“¾æ¥" title="æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨æŒ‡å®šæ•°æ®èµ·å§‹è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p>åœ¨è¯»å–Excelæ–‡ä»¶æ—¶ï¼Œæ‰‹åŠ¨æŒ‡å®šæ•°æ®çš„èµ·å§‹è¡Œï¼Œè€Œä¸ä¾èµ–EasyExcelçš„è‡ªåŠ¨è¯†åˆ«ã€‚è¿™å¯ä»¥é€šè¿‡è®¾ç½®<code>headRowNumber</code>æ¥å®ç°ï¼Œæ˜ç¡®å‘ŠçŸ¥EasyExcelä»ç¬¬å‡ è¡Œå¼€å§‹è¯»å–æ•°æ®ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExcelReaderBuilder readBuilder = EasyExcel.read(inputStream, ExcelData.class, new ExcelDataListener())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .sheet().headRowNumber(2) // æŒ‡å®šä»ç¬¬3è¡Œå¼€å§‹è¯»å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .doRead();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œé€šè¿‡<code>headRowNumber(2)</code>æŒ‡å®šä»ç¬¬3è¡Œå¼€å§‹è¯»å–æ•°æ®ï¼Œé¿å…å°†ç¬¬ä¸€è¡Œè¯¯è¯»ä¸ºè¡¨å¤´ã€‚</p>
<p><strong>æ•°æ®å¤„ç†é€»è¾‘ä¸­æ’é™¤è¡¨å¤´è¡Œ</strong></p>
<p>åœ¨å®é™…æ•°æ®å¤„ç†é€»è¾‘ä¸­ï¼Œå¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­æ’é™¤è¡¨å¤´è¡Œï¼Œç¡®ä¿åªå¤„ç†å®é™…çš„æ•°æ®è¡Œã€‚ä¾‹å¦‚ï¼Œåœ¨<code>invoke</code>æ–¹æ³•ä¸­å¯ä»¥æ·»åŠ é€»è¾‘åˆ¤æ–­ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Override </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void invoke(ExcelData data, AnalysisContext context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (context.readRowHolder().getRowIndex() &gt; 0) { // è·³è¿‡è¡¨å¤´è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å¤„ç†å®é™…æ•°æ®é€»è¾‘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡<code>context.readRowHolder().getRowIndex() &gt; 0</code>åˆ¤æ–­å½“å‰è¡Œç´¢å¼•å¤§äº0æ—¶æ‰å¤„ç†æ•°æ®ï¼Œè·³è¿‡è¡¨å¤´è¡Œçš„å¤„ç†ã€‚</p>
<p><strong>ä½¿ç”¨åå¤„ç†å™¨è¿›è¡ŒäºŒæ¬¡å¤„ç†</strong></p>
<p>EasyExcelæä¾›äº†åå¤„ç†å™¨ï¼ˆHandlerï¼‰æœºåˆ¶ï¼Œåœ¨æ•°æ®è¯»å–å®Œæˆåå¯ä»¥è¿›è¡ŒäºŒæ¬¡å¤„ç†ã€‚å¯ä»¥åœ¨<code>doAfterAllAnalysed</code>æ–¹æ³•ä¸­å¯¹æ•°æ®è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†æˆ–è¿‡æ»¤ï¼Œç¡®ä¿æœ€ç»ˆæ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Override </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void doAfterAllAnalysed(AnalysisContext context) { </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // æ•°æ®å¤„ç†å®Œæˆåçš„é€»è¾‘ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    processData(dataList);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ï¿½ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¯ä»¥åœ¨<code>doAfterAllAnalysed</code>æ–¹æ³•ä¸­è°ƒç”¨<code>processData</code>æ–¹æ³•ï¼Œå¯¹æ•°æ®è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†æˆ–è€…å­˜å‚¨æ“ä½œã€‚</p>
<p><strong>ç¤ºä¾‹ä»£ç </strong></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨EasyExcelè¯»å–Excelæ–‡ä»¶å¹¶å¤„ç†æ•°æ®ï¼ŒåŒæ—¶é¿å…æ•°æ®ç¬¬ä¸€è¡Œè¢«è¯¯è¯»ä¸ºè¡¨å¤´çš„é—®é¢˜ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.alibaba.excel.EasyExcel;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.alibaba.excel.context.AnalysisContext;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.alibaba.excel.event.AnalysisEventListener;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.alibaba.excel.read.builder.ExcelReaderBuilder;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.io.FileInputStream;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.io.InputStream;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class ExcelReaderExample {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String fileName = "path/to/your/excel/file.xlsx";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        InputStream inputStream = null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            inputStream = new FileInputStream(fileName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ExcelReaderBuilder readBuilder = EasyExcel.read(inputStream, ExcelData.class, new ExcelDataListener());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            readBuilder.sheet().headRowNumber(2); // æŒ‡å®šä»ç¬¬3è¡Œå¼€å§‹è¯»å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            readBuilder.doRead();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (inputStream != null) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    inputStream.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                } catch (IOException e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    e.printStackTrace();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static class ExcelDataListener extends AnalysisEventListener&lt;ExcelData&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private List&lt;ExcelData&gt; dataList = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void invoke(ExcelData data, AnalysisContext context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (context.readRowHolder().getRowIndex() &gt; 0) { // è·³è¿‡è¡¨å¤´è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // å¤„ç†å®é™…æ•°æ®é€»è¾‘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                dataList.add(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void doAfterAllAnalysed(AnalysisContext context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // æ•°æ®å¤„ç†å®Œæˆåçš„é€»è¾‘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            processData(dataList);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void processData(List&lt;ExcelData&gt; dataList) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // å¤„ç†æ•°æ®çš„å…·ä½“é€»è¾‘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            for (ExcelData data : dataList) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                System.out.println(data.toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static class ExcelData {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // Excelä¸­çš„æ•°æ®å­—æ®µå¯¹åº”çš„Javaå±æ€§</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private String column1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private String column2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // çœç•¥getterå’Œsetteræ–¹æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="æ–¹æ¡ˆ2ç¬¬ä¸€è¡Œæ•°æ®è¯»åœ¨è¡¨å¤´å•ç‹¬å¤„ç†">æ–¹æ¡ˆ2ï¼šç¬¬ä¸€è¡Œæ•°æ®è¯»åœ¨è¡¨å¤´å•ç‹¬å¤„ç†<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#%E6%96%B9%E6%A1%882%E7%AC%AC%E4%B8%80%E8%A1%8C%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%9C%A8%E8%A1%A8%E5%A4%B4%E5%8D%95%E7%8B%AC%E5%A4%84%E7%90%86" class="hash-link" aria-label="æ–¹æ¡ˆ2ï¼šç¬¬ä¸€è¡Œæ•°æ®è¯»åœ¨è¡¨å¤´å•ç‹¬å¤„ç†çš„ç›´æ¥é“¾æ¥" title="æ–¹æ¡ˆ2ï¼šç¬¬ä¸€è¡Œæ•°æ®è¯»åœ¨è¡¨å¤´å•ç‹¬å¤„ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@SneakyThrows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public byte[] exportExcel(List&lt;String&gt; sheet1Ids, List&lt;String&gt; sheet2Ids, List&lt;String&gt; sheet3Ids, String startDate, String endDate) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    byte[] result;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // è¯»å–æ¨¡ç‰ˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         InputStream inputStream = templateFileService.getTemplateInputStreamByPath(dataComparisonFileResource.getPath())) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ExcelWriter excelWriter = EasyExcel.write(outputStream)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .withTemplate(inputStream)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .autoCloseStream(true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .registerWriteHandler(new CustomSheet1CellWriteHandler())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å†™å…¥è¡¨1 æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;LfDispatchDataComparisonGridOperationVo&gt; sheet1Data = getGridOperationData(sheet1Ids, startDate, endDate);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.writerSheet1(excelWriter, sheet1Data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å†™å…¥è¡¨2 æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;LfDispatchDataComparisonGwEnergyVo&gt; sheet2Data = getGwEnergyData(sheet2Ids, startDate, endDate);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.writerSheet2(excelWriter, sheet2Data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å†™å…¥è¡¨3 æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;LfDispatchDataComparisonNewEnergyOperationVo&gt; sheet3Data = getNewEnergyOperationData(sheet3Ids, startDate, endDate);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.writerSheet3(excelWriter, sheet3Data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // ç”Ÿæˆexcel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        excelWriter.finish();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // ç¡®ä¿æ‰€æœ‰å†…å®¹éƒ½å†™å…¥è¾“å‡ºæµä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result = outputStream.toByteArray();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * è‡ªå®šä¹‰sheet1çš„cellæ ·å¼ ç”¨äºæ ‡è®° è´Ÿè·å æ¯”ã€ç”µé‡å æ¯” å¤§äº1çš„å•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static class CustomSheet1CellWriteHandler implements WorkbookWriteHandler, CellWriteHandler {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * å¤„ç†ç¬¬ä¸€è¡Œæ•°æ® (easyExcelå·¥å…·çš„bug ä¼šå°†ç¬¬ä¸€è¡Œæ•°æ®è¯»åœ¨è¡¨å¤´)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param context ä¸Šä¸‹æ–‡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (context.getRowIndex() == 2 &amp;&amp; (context.getColumnIndex() == 14 || context.getColumnIndex() == 15)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // å¤„ç†ç¬¬ç¬¬ä¸€ä¸ªsheet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Sheet sheet = context.getRow().getSheet().getWorkbook().getSheetAt(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Row row = sheet.getRow(2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Cell cell14 = row.getCell(14);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Cell cell15 = row.getCell(15);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // åº”ç”¨çº¢è‰²æ ·å¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            applyRedStyleToCells(cell14, cell15);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * å¤„ç†é™¤äº†ç¬¬ä¸€è¡Œä»¥å¤–çš„å…¶ä»–æ•°æ®è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param context ä¸Šä¸‹æ–‡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void afterWorkbookDispose(WorkbookWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Workbook workbook = context.getWriteWorkbookHolder().getWorkbook();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åªå¤„ç† sheet1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Sheet sheet = workbook.getSheetAt(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        applyRedStyleToSheet(sheet);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * æŒ‰åˆ—æ ‡è®°çº¢è‰²</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param sheet å·¥ä½œè¡¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private void applyRedStyleToSheet(Sheet sheet) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (Row row : sheet) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            applyRedStyleToCells(row.getCell(14), row.getCell(15));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * å¯¹æŒ‡å®šçš„å•å…ƒæ ¼åº”ç”¨çº¢è‰²å­—ä½“æ ·å¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param cells éœ€è¦åº”ç”¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">çº¢è‰²æ ·å¼çš„å•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private void applyRedStyleToCells(Cell... cells) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (Cell cell : cells) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (cell != null) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Workbook workbook = cell.getSheet().getWorkbook();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                CellStyle redStyle = workbook.createCellStyle();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Font redFont = workbook.createFont();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                redFont.setColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                redStyle.setFont(redFont);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                cell.setCellStyle(redStyle);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-ç»“è®º">5. ç»“è®º<a href="https://jachen99.github.io/blog/advanced-data-processing-with-easyexcel#5-%E7%BB%93%E8%AE%BA" class="hash-link" aria-label="5. ç»“è®ºçš„ç›´æ¥é“¾æ¥" title="5. ç»“è®ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æˆ‘æ€»ç»“ï¼šå»ºè®®ä¸å†ä½¿ç”¨EasyExcelå·¥å…·ã€‚</p>
<hr>]]></content:encoded>
            <category>EasyExcel</category>
            <category>æ•°æ®å¤„ç†</category>
            <category>æˆ‘çš„Bug</category>
        </item>
        <item>
            <title><![CDATA[å®‰å…¨åŠŸèƒ½ä¹‹ç³»ç»Ÿé€€å‡ºåJWTä»¤ç‰Œå¤±æ•ˆ]]></title>
            <link>https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid</link>
            <guid>https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid</guid>
            <pubDate>Wed, 10 Apr 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[åœ¨ç°ä»£Webåº”ç”¨ä¸­ï¼Œç”¨æˆ·é€€å‡ºç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºæœ¬åŠŸèƒ½ï¼Œç„¶è€Œï¼Œå¦‚ä½•ç¡®ä¿é€€å‡ºåçš„ä»¤ç‰Œä¸å†æœ‰æ•ˆï¼Œæ˜¯ç³»ç»Ÿå®‰å…¨æ€§çš„ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é€šè¿‡åœ¨ç”¨æˆ·é€€å‡ºæ—¶å°†JWTä»¤ç‰ŒåŠ å…¥é»‘åå•ï¼Œä»¥åŠåœ¨åç»­è¯·æ±‚ä¸­éªŒè¯ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ï¼Œæ„å»ºç³»ç»Ÿçš„åŒå±‚å®‰å…¨æœºåˆ¶ï¼Œæœ‰æ•ˆåº”å¯¹ä»¤ç‰Œæ»¥ç”¨çš„é£é™©ã€‚]]></description>
            <content:encoded><![CDATA[<p><em>åœ¨ç°ä»£Webåº”ç”¨ä¸­ï¼Œç”¨æˆ·é€€å‡ºç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºæœ¬åŠŸèƒ½ï¼Œç„¶è€Œï¼Œå¦‚ä½•ç¡®ä¿é€€å‡ºåçš„ä»¤ç‰Œä¸å†æœ‰æ•ˆï¼Œæ˜¯ç³»ç»Ÿå®‰å…¨æ€§çš„ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é€šè¿‡åœ¨ç”¨æˆ·é€€å‡ºæ—¶å°†JWTä»¤ç‰ŒåŠ å…¥é»‘åå•ï¼Œä»¥åŠåœ¨åç»­è¯·æ±‚ä¸­éªŒè¯ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ï¼Œæ„å»ºç³»ç»Ÿçš„åŒå±‚å®‰å…¨æœºåˆ¶ï¼Œæœ‰æ•ˆåº”å¯¹ä»¤ç‰Œæ»¥ç”¨çš„é£é™©ã€‚</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="èƒŒæ™¯">èƒŒæ™¯<a href="https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid#%E8%83%8C%E6%99%AF" class="hash-link" aria-label="èƒŒæ™¯çš„ç›´æ¥é“¾æ¥" title="èƒŒæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Webåº”ç”¨ä¸­çš„ç”¨æˆ·è®¤è¯ä¸€èˆ¬ä¾èµ–äºJWTä»¤ç‰Œï¼Œå®ƒæ˜¯ä¸€ç§è½»é‡çº§çš„èº«ä»½éªŒè¯æ–¹å¼ã€‚ç„¶è€Œï¼Œä¸€æ—¦ç”¨æˆ·é€€å‡ºç³»ç»Ÿï¼Œä¹‹å‰çš„ä»¤ç‰Œç†è®ºä¸Šä»ç„¶æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸€äº›æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶æ¥ç¡®ä¿é€€å‡ºåçš„ä»¤ç‰Œä¸å†è¢«æ¥å—ï¼Œæå‡ç³»ç»Ÿçš„æ•´ä½“å®‰å…¨æ€§ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="éœ€æ±‚">éœ€æ±‚<a href="https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid#%E9%9C%80%E6%B1%82" class="hash-link" aria-label="éœ€æ±‚çš„ç›´æ¥é“¾æ¥" title="éœ€æ±‚çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å®ç°ç”¨æˆ·å®‰å…¨é€€å‡ºåŠŸèƒ½ã€‚
ä½¿é€€å‡ºåçš„JWTä»¤ç‰Œå¤±æ•ˆï¼Œé˜²æ­¢æ»¥ç”¨ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="åˆ†æä¸è®¾è®¡">åˆ†æä¸è®¾è®¡<a href="https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid#%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1" class="hash-link" aria-label="åˆ†æä¸è®¾è®¡çš„ç›´æ¥é“¾æ¥" title="åˆ†æä¸è®¾è®¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä¸ºäº†æ»¡è¶³ä¸Šè¿°éœ€æ±‚ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨ä»¥ä¸‹æ–¹æ¡ˆï¼š</p>
<p><strong>1ã€å°†JWTä»¤ç‰ŒåŠ å…¥é»‘åå•ï¼š</strong>
åœ¨ç”¨æˆ·é€€å‡ºç³»ç»Ÿæ—¶ï¼Œè·å–JWTä»¤ç‰Œçš„IDã€‚
å°†ä»¤ç‰ŒIDå­˜å‚¨åˆ°Redisä¸­ï¼Œæ„å»ºé»‘åå•ã€‚
è®¾ç½®ä¸JWTä»¤ç‰Œç›¸åŒçš„å¤±æ•ˆæ—¶é—´ï¼Œä¿è¯é»‘åå•ä¸­çš„ä»¤ç‰Œä¼šåœ¨ä¸€å®šæ—¶é—´åè‡ªåŠ¨æ¸…ç†ã€‚</p>
<p><strong>2ã€éªŒè¯JWTä»¤ç‰Œçš„æœ‰æ•ˆæ€§ï¼š</strong>
åœ¨æ¯æ¬¡è¯·æ±‚ä¸­ï¼Œè·å–JWTä»¤ç‰Œçš„Claimsã€‚
æ£€æŸ¥ç”¨æˆ·å¯¹è±¡ã€Claimså¯¹è±¡ä»¥åŠä»¤ç‰ŒIDæ˜¯å¦ä¸ä¸ºç©ºã€‚
æ„å»ºé»‘åå•ä¸­çš„keyï¼Œé€šè¿‡RediséªŒè¯ä»¤ç‰Œæ˜¯å¦åœ¨é»‘åå•ä¸­ã€‚
å¦‚æœåœ¨é»‘åå•ä¸­ï¼Œæ‹’ç»è¯·æ±‚å¤„ç†ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ ¸å¿ƒä»£ç ">æ ¸å¿ƒä»£ç <a href="https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="æ ¸å¿ƒä»£ç çš„ç›´æ¥é“¾æ¥" title="æ ¸å¿ƒä»£ç çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å°†JWTä»¤ç‰ŒåŠ å…¥é»‘åå•</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// æ–°å¢å°†JWTä»¤ç‰ŒåŠ å…¥é»‘åå•æ“ä½œï¼Œå¹¶è®¾ç½®ç›¸åŒçš„å¤±æ•ˆæ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Claims claims = SecureUtil.getClaims(Objects.requireNonNull(request));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if (ObjectUtil.isNotEmpty(claims)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Date expiration = claims.getExpiration();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    DateTime now = DateTime.now();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    long seconds = cn.hutool.core.date.DateUtil.between(now, expiration, DateUnit.SECOND);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String id = claims.getId();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String ExpIdKey = TokenConstant.EXP_ID + ":" + userId + ":" + id;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    redisTemplate.opsForValue().set(ExpIdKey, id);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    redisTemplate.expire(ExpIdKey, seconds, TimeUnit.SECONDS);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>éªŒè¯JWTä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// æ‹¦æˆªå™¨ä¸­ æ ¡éªŒé»‘åå•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Claims claims = SecureUtil.getClaims(request);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if (user != null &amp;&amp; claims != null &amp;&amp; StringUtil.isNotEmpty(claims.getId())) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String key = TokenConstant.EXP_ID + ":" + user.getUserId() + ":" + claims.getId();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String jit = redisTemplate.opsForValue().get(key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (claims.getId().equals(jit)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        log.debug("ä»¤ç‰Œå·²å¤±æ•ˆ");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        failBack(resp);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ‰©å±•">æ‰©å±•<a href="https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid#%E6%89%A9%E5%B1%95" class="hash-link" aria-label="æ‰©å±•çš„ç›´æ¥é“¾æ¥" title="æ‰©å±•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>é€šè¿‡è¿™ç§åŒå±‚å®‰å…¨æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼š</p>
<ul>
<li>å®šæ—¶ä»»åŠ¡æ¸…ç†è¿‡æœŸä»¤ç‰Œï¼š ä½¿ç”¨å®šæ—¶ä»»åŠ¡å®šæœŸæ¸…ç†é»‘åå•ä¸­çš„è¿‡æœŸä»¤ç‰Œï¼Œç¡®ä¿é»‘åå•ä¸ä¼šæ— é™å¢é•¿ã€‚</li>
<li>åŸºäºè§’è‰²æˆ–æƒé™çš„å¤±æ•ˆç­–ç•¥ï¼š æ ¹æ®ç”¨æˆ·çš„è§’è‰²æˆ–æƒé™ï¼Œå®ç°æ›´ç²¾ç»†åŒ–çš„ä»¤ç‰Œå¤±æ•ˆç­–ç•¥ã€‚</li>
<li>ç»“åˆåŒå› ç´ è®¤è¯ï¼š åœ¨ä»¤ç‰ŒéªŒè¯å‰åŠ å…¥åŒå› ç´ è®¤è¯ï¼Œæå‡ç³»ç»Ÿçš„èº«ä»½éªŒè¯å±‚çº§ã€‚</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“<a href="https://jachen99.github.io/blog/product-security-system-exit-jwt-invalid#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>é€šè¿‡æ„å»ºç³»ç»Ÿçš„åŒå±‚å®‰å…¨æœºåˆ¶ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°åº”å¯¹äº†ç”¨æˆ·é€€å‡ºåä»¤ç‰Œçš„æ»¥ç”¨é£é™©ã€‚è¿™ç§æœºåˆ¶ç®€å•è€Œå¼ºå¤§ï¼Œä¸ºWebåº”ç”¨æä¾›äº†é¢å¤–çš„å®‰å…¨ä¿éšœï¼Œä½¿ç”¨æˆ·é€€å‡ºæ›´å…·å®‰å…¨æ€§ã€‚</p>]]></content:encoded>
            <category>å®‰å…¨</category>
        </item>
        <item>
            <title><![CDATA[ç¬¬ä¸‰æ–¹æµ‹è¯•-ç³»ç»Ÿå®‰å…¨æµ‹è¯•é—®é¢˜ä¹‹æ•°æ®åŠ å¯†]]></title>
            <link>https://jachen99.github.io/blog/product-security-testing-problems</link>
            <guid>https://jachen99.github.io/blog/product-security-testing-problems</guid>
            <pubDate>Fri, 01 Mar 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[ç°åœ¨å›½å†…è¶Šæ¥è¶Šé‡è§†ç³»ç»Ÿå®‰å…¨ï¼Œæœ€è¿‘æˆ‘ä»¬å…¬å¸åœ¨åšç¬¬ä¸‰æ–¹æµ‹è¯•è¿‡ç¨‹ä¸­å¯¹ç³»ç»Ÿå®‰å…¨ã€ç³»ç»Ÿæ€§èƒ½ç­‰åšå‡ºäº†ä¸¥æ ¼çš„è¦æ±‚ï¼Œå¹¶è¿›è¡Œäº†å¾ˆå¤§çš„æ•´æ”¹ï¼Œå°±ä»è¿™ç¯‡æ–‡ç« å¼€å§‹æ€»ç»“ä¸€ä¸‹æœ€è¿‘ä¸‰ä¸ªæœˆä»¥åŠä»¥åè¿˜ä¼šç»§ç»­æ•´æ”¹çš„æ¶‰åŠç³»ç»Ÿå®‰å…¨çš„ç›¸å…³æµ‹è¯•æ¼æ´çš„ä¿®æ”¹æ–¹æ¡ˆï¼Œç›¸ä¿¡è¿™äº›é—®é¢˜ä¼šå¸®åŠ©åˆ°å¤§å®¶ï¼Œå°¤å…¶æ˜¯æ¯”è¾ƒå¤§å‹çš„æ”¿åºœé¡¹ç›®ï¼Œå¯¹ç³»ç»Ÿå®‰å…¨æ›´åŠ æ³¨é‡ã€‚]]></description>
            <content:encoded><![CDATA[<p>ç°åœ¨å›½å†…è¶Šæ¥è¶Šé‡è§†ç³»ç»Ÿå®‰å…¨ï¼Œæœ€è¿‘æˆ‘ä»¬å…¬å¸åœ¨åšç¬¬ä¸‰æ–¹æµ‹è¯•è¿‡ç¨‹ä¸­å¯¹ç³»ç»Ÿå®‰å…¨ã€ç³»ç»Ÿæ€§èƒ½ç­‰åšå‡ºäº†ä¸¥æ ¼çš„è¦æ±‚ï¼Œå¹¶è¿›è¡Œäº†å¾ˆå¤§çš„æ•´æ”¹ï¼Œå°±ä»è¿™ç¯‡æ–‡ç« å¼€å§‹æ€»ç»“ä¸€ä¸‹æœ€è¿‘ä¸‰ä¸ªæœˆä»¥åŠä»¥åè¿˜ä¼šç»§ç»­æ•´æ”¹çš„æ¶‰åŠç³»ç»Ÿå®‰å…¨çš„ç›¸å…³æµ‹è¯•æ¼æ´çš„ä¿®æ”¹æ–¹æ¡ˆï¼Œç›¸ä¿¡è¿™äº›é—®é¢˜ä¼šå¸®åŠ©åˆ°å¤§å®¶ï¼Œå°¤å…¶æ˜¯æ¯”è¾ƒå¤§å‹çš„æ”¿åºœé¡¹ç›®ï¼Œå¯¹ç³»ç»Ÿå®‰å…¨æ›´åŠ æ³¨é‡ã€‚</p>
<p><em>åœ¨äº’è”ç½‘å’Œæ–°å…´æŠ€æœ¯é«˜é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œæ•°æ®ä¿¡æ¯å……æ–¥åœ¨å„è¡Œå„ä¸šä¸­ï¼Œå¹¶å‘æŒ¥ç€é‡è¦çš„ä½œç”¨ã€‚ç„¶è€Œï¼Œåœ¨äº«å—ä¿¡æ¯åŒ–æ—¶ä»£å¸¦æ¥ä¾¿åˆ©çš„åŒæ—¶ï¼Œæ•°æ®å®‰å…¨é—®é¢˜ä¹Ÿæˆä¸ºå¤§å®¶å…³æ³¨çš„ç„¦ç‚¹ã€‚æ— è®ºæ˜¯ä»toGã€toBã€toCçš„å„ä¸šåŠ¡åœºæ™¯æ¥çœ‹ï¼Œè¿˜æ˜¯ä»ç½‘ç»œå®‰å…¨ï¼ˆCyberSecurityï¼‰çš„æ¶æ„æ¥çœ‹ï¼Œæ•°æ®å®‰å…¨ï¼ˆDataSecurityï¼‰éƒ½æ˜¯ä¸€ä¸ªä¸»è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œè€Œä¸”åœ¨æ–°å…´æŠ€æœ¯æ—¥æ–°æœˆå¼‚çš„æ•°æ®æ—¶ä»£å˜å¾—è¶Šæ¥è¶Šé‡è¦ï¼ŒèŒƒå›´ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚</em>
------- <em>å¼•è‡ª ã€Šæ•°æ®å®‰å…¨æ¶æ„è®¾è®¡ä¸å®æˆ˜ã€‹</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰å…¨æ¶æ„5aæ–¹æ³•è®º"><strong>å®‰å…¨æ¶æ„5Aæ–¹æ³•è®º</strong><a href="https://jachen99.github.io/blog/product-security-testing-problems#%E5%AE%89%E5%85%A8%E6%9E%B6%E6%9E%845a%E6%96%B9%E6%B3%95%E8%AE%BA" class="hash-link" aria-label="å®‰å…¨æ¶æ„5aæ–¹æ³•è®ºçš„ç›´æ¥é“¾æ¥" title="å®‰å…¨æ¶æ„5aæ–¹æ³•è®ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ— è®ºæ˜¯è¿›è¡Œäº§å“çš„å®‰å…¨æ¶æ„è®¾è®¡æˆ–è¯„ä¼°ï¼Œè¿˜æ˜¯è§„åˆ’å®‰å…¨æŠ€æœ¯ä½“ç³»æ¶æ„çš„æ—¶å€™ï¼Œéƒ½æœ‰å‡ ä¸ªéœ€è¦é‡ç‚¹å…³æ³¨çš„é€»è¾‘æ¨¡å—ï¼Œå®ƒä»¬å¯ä»¥åœ¨é€»è¾‘ä¸Šè§†ä¸ºå®‰å…¨æ¶æ„çš„æ ¸å¿ƒå…ƒç´ ã€‚
ä»¥åº”ç”¨/äº§å“ä¸ºä¾‹ï¼Œæ ¸å¿ƒå…ƒç´ åŒ…æ‹¬ï¼š
â–  èº«ä»½è®¤è¯ï¼ˆAuthenticationï¼‰ï¼šç”¨æˆ·ä¸»ä½“æ˜¯è°ï¼Ÿ
â–  æˆæƒï¼ˆAuthorizationï¼‰ï¼šæˆäºˆæŸäº›ç”¨æˆ·ä¸»ä½“å…è®¸æˆ–æ‹’ç»è®¿é—®å®¢ä½“çš„æƒé™ã€‚
â–  è®¿é—®æ§åˆ¶ï¼ˆAccess Controlï¼‰ï¼šæ§åˆ¶æªæ–½ä»¥åŠæ˜¯å¦æ”¾è¡Œçš„æ‰§è¡Œè€…ã€‚
â–  å¯å®¡è®¡ï¼ˆAuditableï¼‰ï¼šå½¢æˆå¯ä¾›è¿½æº¯çš„æ“ä½œæ—¥å¿—ã€‚
â–  èµ„äº§ä¿æŠ¤ï¼ˆAsset Protectionï¼‰ï¼šèµ„äº§çš„ä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ä¿éšœ</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å…³äºæ•°æ®å®‰å…¨æ–¹é¢"><strong>å…³äºæ•°æ®å®‰å…¨æ–¹é¢</strong><a href="https://jachen99.github.io/blog/product-security-testing-problems#%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2" class="hash-link" aria-label="å…³äºæ•°æ®å®‰å…¨æ–¹é¢çš„ç›´æ¥é“¾æ¥" title="å…³äºæ•°æ®å®‰å…¨æ–¹é¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æˆ‘ä»¬åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å¯¹æ•°æ®ä¼ è¾“åŠ å¯†ã€æ•°æ®å­˜å‚¨åŠ å¯†ã€å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ã€SM2ã€SM3ã€SM4å›½å¯†åŠ å¯†ï¼ŒCAè¯ä¹¦ç­‰ç­‰</p>
<p><em><strong>ä»€ä¹ˆæ˜¯éå¯¹ç§°åŠ å¯†å‘¢ï¼Ÿ</strong></em></p>
<p>éå¯¹ç§°åŠ å¯†æ˜¯ä¸€ç§å¯†ç å­¦æŠ€æœ¯ï¼Œä¸ä¼ ç»Ÿçš„å¯¹ç§°åŠ å¯†ä¸åŒï¼Œå®ƒä½¿ç”¨ä¸€å¯¹å¯†é’¥æ¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œï¼Œè¿™å¯¹å¯†é’¥åˆ†åˆ«ç§°ä¸ºå…¬é’¥å’Œç§é’¥ã€‚è¿™ä¸¤ä¸ªå¯†é’¥æ˜¯æ•°å­¦ä¸Šç›¸å…³è”çš„ï¼Œä½†å´ä¸èƒ½é€šè¿‡å·²çŸ¥ä¸€ä¸ªå¯†é’¥æ¥è½»æ¾åœ°æ¨å¯¼å‡ºå¦ä¸€ä¸ªå¯†é’¥ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå°±åƒä½ æœ‰ä¸€æŠŠé”å’Œä¸€æŠŠé’¥åŒ™ï¼Œä»»ä½•äººéƒ½å¯ä»¥å¾—åˆ°è¿™æŠŠé”ï¼Œä½†åªæœ‰ä½ æœ‰è¿™æŠŠå”¯ä¸€çš„é’¥åŒ™ã€‚ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨è¿™æŠŠé”å°†ä¿¡æ¯é”ä½ï¼Œä½†åªæœ‰ä½ èƒ½å¤Ÿä½¿ç”¨ä½ çš„ç‹¬ç‰¹çš„é’¥åŒ™æ¥è§£é”è¿™ä¸ªä¿¡æ¯ã€‚</p>
<ul>
<li>å…¬é’¥ï¼š å°±åƒæ˜¯ä¸€ä¸ªå¼€æ”¾çš„é”ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—ã€‚å®ƒç”¨äºåŠ å¯†ä¿¡æ¯ï¼Œåªæœ‰æ‹¥æœ‰ä¸ä¹‹ç›¸å…³çš„ç§é’¥çš„äººæ‰èƒ½è§£å¯†ã€‚</li>
<li>ç§é’¥ï¼š è¿™æ˜¯ä¸å…¬é’¥ç›¸å…³è”çš„å”¯ä¸€çš„è§£é”å¯†é’¥ï¼Œåªæœ‰å¯†é’¥çš„æ‹¥æœ‰è€…æ‰èƒ½è§£å¯†ç”¨å…¬é’¥åŠ å¯†çš„ä¿¡æ¯ã€‚</li>
</ul>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œè€ƒè™‘ç”¨æˆ·å¯†ç çš„å­˜å‚¨é—®é¢˜ã€‚é€šè¿‡éå¯¹ç§°åŠ å¯†çš„æ–¹å¼ï¼Œå¯ä»¥å°†ç”¨æˆ·å¯†ç åŠ å¯†åå†™å…¥æ•°æ®åº“ã€‚å½“ç”¨æˆ·å†æ¬¡ç™»å½•æ—¶ï¼Œç³»ç»Ÿå°†å®¢æˆ·ç«¯è¾“å…¥çš„æ˜æ–‡å¯†ç ä½¿ç”¨ç›¸åŒçš„éå¯¹ç§°åŠ å¯†æ–¹å¼åŠ å¯†ï¼Œç„¶åä¸æ•°æ®åº“ä¸­çš„å¯†æ–‡è¿›è¡Œæ¯”å¯¹ã€‚è¿™æ ·çš„è®¾è®¡å¤§å¤§æé«˜äº†å®‰å…¨æ€§ï¼Œå³ä½¿æ•°æ®åº“è¢«æ”»å‡»ï¼Œæ”»å‡»è€…ä¹Ÿæ— æ³•è½»æ¾è·å–ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚
å›½å¯†SM2åŠ å¯†æ–¹å¼å°±æ˜¯éå¯¹ç§°åŠ å¯†çš„ã€‚ä¸‹é¢æ˜¯å›½å¯†SM2åŠ å¯†å·¥å…·çš„æºç ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/*æ¤­åœ†æ›²çº¿éå¯¹ç§°åŠ å¯†ç®—æ³•*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class SM2Util {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String key_pubk= "pub";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String key_prik= "pri";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static SM2 sm2 = SM2.instance();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	private static final String DEFAULT_PRIVATE_KEY = "27cd96b1500f8330fc523e7c47ef02a";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	private static final String DEFAULT_PUBLIC_KEY = "047ec86bb18f57714e6c5c72383c5b122";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	 * ç”Ÿæˆå…¬ç§é’¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	 * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	 */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static Map&lt;String,String&gt; generateKeyPair() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Map&lt;String,String&gt; result = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        AsymmetricCipherKeyPair key = sm2.eccKeyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        BigInteger privateKey = ((ECPrivateKeyParameters)key.getPrivate()).getD();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ECPoint publicKey = ((ECPublicKeyParameters)key.getPublic()).getQ();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String pubk = new String(Hex.encode(publicKey.getEncoded(false)), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String prik = new String(Hex.encode(privateKey.toByteArray()), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result.put(key_pubk, pubk);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result.put(key_prik, prik);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return result;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è·å–é»˜è®¤å…¬é’¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String getDefaultPublicKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return DEFAULT_PUBLIC_KEY;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è·å–é»˜è®¤ç§é’¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String getDefaultPrivateKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return DEFAULT_PRIVATE_KEY;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * åŠ å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] encrypt(String data, byte[] publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	if (StringUtils.isBlank(data)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    		return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	SM2Cipher cipher = new SM2Cipher();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	// C1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	byte[] c1Bytes = new byte[65];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	ECPoint c1 = cipher.encryptInit(sm2, sm2.eccCurve.decodePoint(publicKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	c1Bytes = c1.getEncoded(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c2Bytes = data.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.encrypt(c2Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c3Bytes = new byte[32];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.doFinal(c3Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] encryptData = new byte[c1Bytes.length + c2Bytes.length + c3Bytes.length];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		System.arraycopy(c1Bytes, 0, encryptData, 0, c1Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		System.arraycopy(c2Bytes, 0, encryptData, c1Bytes.length, c2Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		System.arraycopy(c3Bytes, 0, encryptData, c1Bytes.length + c2Bytes.length, c3Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encryptData;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * åŠ å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] encrypt(String data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return encrypt(data, HexUtil.hexToByte(publicKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * åŠ å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] encrypt(byte[] data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return encrypt(new String(data, StandardCharsets.UTF_8), HexUtil.hexToByte(publicKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * åŠ å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encryptToHexString(String data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return HexUtil.byteToHex(encrypt(data, HexUtil.hexToByte(publicKey)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * åŠ å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encryptToHexString(byte[] data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return HexUtil.byteToHex(encrypt(new String(data, StandardCharsets.UTF_8), HexUtil.hexToByte(publicKey)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è§£å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] decrypt(byte[] encryptedData, byte[] privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	if (ArrayUtils.isEmpty(encryptedData)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    		return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	SM2Cipher cipher = new SM2Cipher();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c1Bytes = new byte[65];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.arraycopy(encryptedData, 0, c1Bytes, 0, c1Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ECPoint c1 = sm2.eccCurve.decodePoint(c1Bytes).normalize();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c3Bytes = new byte[32];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.arraycopy(encryptedData, encryptedData.length - 32, c3Bytes, 0, 32);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        int c2Len = encryptedData.length - 65 - 32;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c2Bytes = new byte[c2Len];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.arraycopy(encryptedData, 65, c2Bytes, 0, c2Len);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.decryptInit(new BigInteger(1, privateKey), c1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.decrypt(c2Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.doFinal(c3Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return c2Bytes;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è§£å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(byte[] encryptedData, String privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return decrypt(encryptedData, HexUtil.hexToByte(privateKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è§£å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(byte[] encryptedData, String privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return new String(decrypt(encryptedData, HexUtil.hexToByte(privateKey)), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è§£å¯†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encryptedData, String privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return new String(decrypt(Hex.decode(encryptedData), HexUtil.hexToByte(privateKey)), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤å¤–ï¼ŒCAï¼ˆCertificate Authorityï¼Œè¯ä¹¦é¢å‘æœºæ„ï¼‰æœºæ„é€šå¸¸ä¹Ÿä½¿ç”¨éå¯¹ç§°åŠ å¯†çš„æ–¹å¼æ¥ç¡®ä¿æ•°å­—è¯ä¹¦çš„å®‰å…¨æ€§ã€‚CAæœºæ„åœ¨æ•°å­—è¯ä¹¦é¢å‘è¿‡ç¨‹ä¸­èµ·åˆ°äº†ä¿¡ä»»çš„ä¸­ä»‹è§’è‰²ï¼Œå…¶æ“ä½œåŸºäºå…¬é’¥åŸºç¡€è®¾æ–½ï¼ˆPKIï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯CAæœºæ„ä½¿ç”¨éå¯¹ç§°åŠ å¯†çš„ä¸€èˆ¬æµç¨‹ï¼š</p>
<ol>
<li>è¯ä¹¦è¯·æ±‚ï¼š å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸ªäººæˆ–ç»„ç»‡ï¼‰å‘CAæœºæ„æäº¤è¯ä¹¦è¯·æ±‚ï¼Œè¯·æ±‚åŒ…æ‹¬å®ä½“çš„å…¬é’¥å’Œä¸€äº›èº«ä»½ä¿¡æ¯ã€‚</li>
<li>éªŒè¯èº«ä»½ï¼š CAæœºæ„å¯¹è¯ä¹¦è¯·æ±‚ä¸­çš„èº«ä»½ä¿¡æ¯è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿è¯·æ±‚è€…ç¡®å®æ‹¥æœ‰æ‰€å£°æ˜çš„èº«ä»½ã€‚è¿™å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—éªŒè¯æ­¥éª¤æ¥å®Œæˆã€‚</li>
<li>é¢å‘æ•°å­—è¯ä¹¦ï¼š éªŒè¯é€šè¿‡åï¼ŒCAæœºæ„ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹å®ä½“çš„å…¬é’¥å’Œèº«ä»½ä¿¡æ¯è¿›è¡Œç­¾åï¼Œç”Ÿæˆæ•°å­—è¯ä¹¦ã€‚è¿™ä¸ªç­¾åè¿‡ç¨‹å°±æ˜¯ä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼Œå…¶ä¸­CAçš„ç§é’¥ç”¨äºç­¾ç½²è¯ä¹¦ä¿¡æ¯ã€‚</li>
<li>è¯ä¹¦åˆ†å‘ï¼š CAæœºæ„å°†ç”Ÿæˆçš„æ•°å­—è¯ä¹¦å‘é€ç»™è¯·æ±‚è€…ï¼ŒåŒæ—¶å¯ä»¥å°†è¯ä¹¦å…¬å¼€å‘å¸ƒåˆ°å…¬å…±ç›®å½•ä¸­ï¼Œä»¥ä¾¿å…¶ä»–äººå¯ä»¥éªŒè¯è¯ä¹¦çš„çœŸå®æ€§ã€‚</li>
<li>è¯ä¹¦éªŒè¯ï¼š åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œå½“å…¶ä»–äººéœ€è¦éªŒè¯å®ä½“çš„èº«ä»½æ—¶ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨CAæœºæ„å…¬å¼€çš„å…¬é’¥æ¥éªŒè¯æ•°å­—è¯ä¹¦çš„ç­¾åã€‚å¦‚æœéªŒè¯é€šè¿‡ï¼Œå°±å¯ä»¥ä¿¡ä»»è¯¥æ•°å­—è¯ä¹¦æ‰€é™„çš„å…¬é’¥ã€‚</li>
</ol>
<p>éå¯¹ç§°åŠ å¯†çš„ä¼˜åŠ¿åœ¨äºå®ƒæä¾›äº†æ›´é«˜çš„å®‰å…¨æ€§ã€‚å³ä½¿åœ¨å…¬å…±ç¯å¢ƒä¸‹ä¼ è¾“å…¬é’¥ï¼Œä¹Ÿæ— æ³•é€šè¿‡å…¬é’¥è½»æ¾è®¡ç®—å‡ºç§é’¥ã€‚è¿™ä½¿å¾—éå¯¹ç§°åŠ å¯†åœ¨å®‰å…¨åœ°å®ç°èº«ä»½éªŒè¯ã€æ•°å­—ç­¾åå’ŒåŠ å¯†é€šä¿¡ç­‰åœºæ™¯ä¸­å‘æŒ¥é‡è¦ä½œç”¨ã€‚</p>
<p><em><strong>ç›¸å¯¹çš„ï¼Œä»€ä¹ˆæ˜¯å¯¹ç§°åŠ å¯†å‘¢ï¼Ÿ</strong></em></p>
<p>å¯¹ç§°åŠ å¯†æ˜¯ä¸€ç§åŠ å¯†ç®—æ³•ï¼Œå®ƒä½¿ç”¨ç›¸åŒçš„å¯†é’¥åŒæ—¶è¿›è¡Œæ•°æ®çš„åŠ å¯†å’Œè§£å¯†ã€‚è¿™æ„å‘³ç€åœ¨å¯¹ç§°åŠ å¯†ä¸­ï¼Œä½¿ç”¨åŠ å¯†å’Œè§£å¯†æ“ä½œçš„ç›¸åŒå¯†é’¥ã€‚å¯¹ç§°åŠ å¯†ç®—æ³•åœ¨åŠ å¯†å’Œè§£å¯†çš„è¿‡ç¨‹ä¸­éƒ½ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤å¯†é’¥çš„ä¿ç®¡å’Œåˆ†å‘å˜å¾—è‡³å…³é‡è¦ã€‚
æˆ‘ä»¬äº†è§£çš„å›½å¯†SM4å°±æ˜¯é‡‡ç”¨çš„å¯¹ç§°åŠ å¯†çš„æ–¹å¼å®ç°çš„ï¼Œæºç å·¥å…·å¦‚ä¸‹ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * ï¼ˆåˆ†ç»„å¯†ç ç®—æ³•ï¼‰å›½å¯†å¯¹ç§°åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public abstract class SM4Util {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	static {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static final Charset ENCODING = StandardCharsets.UTF_8;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME = "SM4";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // åŠ å¯†ç®—æ³•/åˆ†ç»„åŠ å¯†æ¨¡å¼/åˆ†ç»„å¡«å……æ–¹å¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME_ECB_PADDING = "SM4/ECB/PKCS5Padding";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME_CBC_PADDING = "SM4/CBC/PKCS5Padding";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 128-32ä½16è¿›åˆ¶ï¼›256-64ä½16è¿›åˆ¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final int DEFAULT_KEY_SIZE = 128;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String DEFAULT_KEY = "86C63180C2806ED1F47B859DE501215B";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String DEFAULT_IV = "8F5CB6272B594B53AD1A2197361378DC";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static Cipher generateCipherECB(String algorithmName, int mode, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = Cipher.getInstance(algorithmName, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.init(mode, new SecretKeySpec(key, ALGORITHM_NAME));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static Cipher generateCipherCBC(String algorithmName, int mode, byte[] key, byte[] iv) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = Cipher.getInstance(algorithmName, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.init(mode, new SecretKeySpec(key, ALGORITHM_NAME), new IvParameterSpec(iv));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String generateKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return HexUtil.byteToHex(generateKey(DEFAULT_KEY_SIZE));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] generateKey(int keySize) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        KeyGenerator kg = KeyGenerator.getInstance(ALGORITHM_NAME, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        kg.init(keySize, new SecureRandom());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return kg.generateKey().getEncoded();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] encryptECBPadding(byte[] data, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = generateCipherECB(ALGORITHM_NAME_ECB_PADDING, Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	protected static byte[] decryptECBPadding(byte[] encrypted, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    Cipher cipher = generateCipherECB(ALGORITHM_NAME_ECB_PADDING, Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    return cipher.doFinal(encrypted);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] encryptCBCPadding(byte[] data, byte[] key, byte[] iv) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = generateCipherCBC(ALGORITHM_NAME_CBC_PADDING, Cipher.ENCRYPT_MODE, key, iv);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	protected static byte[] decryptCBCPadding(byte[] encrypted, byte[] key, byte[] iv) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    Cipher cipher = generateCipherCBC(ALGORITHM_NAME_CBC_PADDING, Cipher.DECRYPT_MODE, key, iv);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    return cipher.doFinal(encrypted);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(String source) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(byte[] source) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(String source, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source.getBytes(ENCODING), hexKey);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(byte[] source, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] cipherArray;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			cipherArray = encryptECBPadding(source, ByteUtils.fromHexString(hexKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return ByteUtils.toHexString(cipherArray);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(String encrypted) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return decrypt(encrypted, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encrypted) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return decryptToString(encrypted, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encrypted, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return new String(decrypt(encrypted, hexKey), ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(String encrypted, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return decryptECBPadding(ByteUtils.fromHexString(encrypted), ByteUtils.fromHexString(hexKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return encrypted.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(String source, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source.getBytes(ENCODING), hexKey, iv);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(byte[] source, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] cipherArray;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			cipherArray = encryptCBCPadding(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">							source</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">							, ByteUtils.fromHexString(hexKey)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">							, ByteUtils.fromHexString(iv));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return ByteUtils.toHexString(cipherArray);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			throw new RuntimeException("æ•°æ®åŠ å¯†å¤±è´¥", e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encrypted, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return new String(decrypt(encrypted, hexKey, iv), ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(String encrypted, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			if (StringUtils.isBlank(encrypted)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">				return new byte[] {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return decryptCBCPadding(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">				 	ByteUtils.fromHexString(encrypted)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					, ByteUtils.fromHexString(hexKey)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					, ByteUtils.fromHexString(iv));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return encrypted.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em><strong>ç›¸ä¿¡ä½ ä¹Ÿä¸€å®šå¬è¿‡å›½å¯†SM3ç®—æ³•ï¼Œå®ƒæ˜¯å¯¹ç§°åŠ å¯†è¿˜æ˜¯éå¯¹ç§°åŠ å¯†å‘¢ï¼Ÿ</strong></em>
å…¶å®SM3æ˜¯ä¸€ç§å¯†ç æ‚å‡‘ç®—æ³•ï¼Œç”¨äºç”Ÿæˆæ¶ˆæ¯çš„å“ˆå¸Œå€¼ï¼Œä¸»è¦ç”¨äºæ•°æ®å®Œæ•´æ€§éªŒè¯ã€æ•°å­—ç­¾åç­‰åœºæ™¯ï¼Œè€Œä¸æ˜¯è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚æ‰€ä»¥å®ƒæ—¢ä¸æ˜¯å¯¹ç§°åŠ å¯†ä¹Ÿä¸æ˜¯éå¯¹ç§°åŠ å¯†ï¼Œå®ƒå¸¸å¸¸ä¸SM2ä¸SM4ç»„åˆä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªéšæœºæ•°ã€‚
<em>ä¾‹å¦‚ï¼š</em>
ç³»ç»Ÿæ•°æ®å­˜å‚¨åŠ å¯†åº”é‡‡ç”¨SM3+SM4çš„å®ç°æ–¹å¼ã€‚
ç³»ç»Ÿæ•°æ®ä¼ è¾“åŠ å¯†åº”é‡‡ç”¨SM2+SM3çš„å®ç°æ–¹å¼ã€‚</p>
<p><strong>æ€»ç»“</strong>
åœ¨ç³»ç»Ÿå®‰å…¨æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é‡‡ç”¨å¤šå±‚åŠ å¯†ç®—æ³•ã€åˆç†çš„å®‰å…¨æ¶æ„è®¾è®¡ä»¥åŠä¸¥æ ¼çš„æ•°æ®å®‰å…¨æªæ–½ï¼Œæé«˜äº†ç³»ç»Ÿåœ¨èº«ä»½è®¤è¯ã€æˆæƒã€è®¿é—®æ§åˆ¶ã€å®¡è®¡å’Œèµ„äº§ä¿æŠ¤ç­‰æ–¹é¢çš„å®‰å…¨æ€§ã€‚è¿™æœ‰åŠ©äºåœ¨äº’è”ç½‘å’Œæ–°å…´æŠ€æœ¯æ—¶ä»£ä¸­æ›´å¥½åœ°å¤„ç†æ•°æ®å®‰å…¨é—®é¢˜ï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§å‹æ”¿åºœé¡¹ç›®ç­‰å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚æ•°æ®å®‰å…¨ç›¸å…³çš„çŸ¥è¯†å±äºå¦ä¸€ä¸ªé¢†åŸŸäº†ï¼ŒçŸ¥è¯†ç‚¹çœŸæ˜¯æ·±ä¸å¯æµ‹ï¼Œè¿˜éœ€è¦å¹³æ—¶å¤šå­¦ä¹ ï¼Œç§¯ç´¯æ›´å¤šçš„çŸ¥è¯†å‚¨å¤‡æ‰è¡Œã€‚</p>]]></content:encoded>
            <category>å®‰å…¨</category>
        </item>
        <item>
            <title><![CDATA[xxl-jobåˆ†å¸ƒå¼è°ƒåº¦å®è·µ]]></title>
            <link>https://jachen99.github.io/blog/product-xxl-job</link>
            <guid>https://jachen99.github.io/blog/product-xxl-job</guid>
            <pubDate>Wed, 14 Feb 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[èµ·å› ï¼šä¼ ç»Ÿçš„å®šæ—¶ä»»åŠ¡Timerã€Quartzç­‰å­˜åœ¨å¾ˆå¤šç¼ºé™·ï¼Œä¸æ”¯æŒé›†ç¾¤ã€ä¸æ”¯æŒç»Ÿè®¡ã€æ²¡æœ‰ç®¡ç†çš„å¹³å°ã€ä¹Ÿæ²¡æœ‰æŠ¥è­¦ã€ç›‘æ§ç­‰ç­‰ã€‚å› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨åˆ†å¸ƒå¼çš„è°ƒåº¦ç³»ç»Ÿï¼Œå»å¡«è¡¥è¿™ä¸€ç³»åˆ—ç¼ºé™·ï¼Œä¹‹å‰æˆ‘ä»¬çš„ç³»ç»Ÿç”¨åˆ°äº†rabbitMQæ¶ˆæ¯é˜Ÿåˆ—å»ç”¨äºåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ã€äº‹ä»¶é©±åŠ¨ç­‰åœºæ™¯ã€‚é€šè¿‡RabbitMQï¼Œä»»åŠ¡è°ƒåº¦ç³»ç»Ÿå¯ä»¥å°†ä»»åŠ¡åˆ†å‘åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œå¹¶è·å–ä»»åŠ¡æ‰§è¡Œç»“æœã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰å¼Šç«¯ï¼Œå°±æ˜¯æ²¡æœ‰ä¸€ä¸ªå®Œæ•´çš„ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œä¸èƒ½å¾ˆå¥½çš„å¯¹ä»»åŠ¡æ‰§è¡Œæƒ…å†µè¿›è¡Œç›‘æ§å’Œç®¡ç†ï¼Œæ‰€ä»¥æœ€åé€‰æ‹©äº†XXL-Jobå»å‡çº§åŒ»é™¢ç³»ç»Ÿçš„å®šæ—¶ç»™å°±è¯Šäººå‘é€æ¶ˆæ¯ç­‰åŠŸèƒ½ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èµ·å› </strong>ï¼š<em>ä¼ ç»Ÿçš„å®šæ—¶ä»»åŠ¡Timerã€Quartzç­‰å­˜åœ¨å¾ˆå¤šç¼ºé™·ï¼Œä¸æ”¯æŒé›†ç¾¤ã€ä¸æ”¯æŒç»Ÿè®¡ã€æ²¡æœ‰ç®¡ç†çš„å¹³å°ã€ä¹Ÿæ²¡æœ‰æŠ¥è­¦ã€ç›‘æ§ç­‰ç­‰ã€‚å› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨åˆ†å¸ƒå¼çš„è°ƒåº¦ç³»ç»Ÿï¼Œå»å¡«è¡¥è¿™ä¸€ç³»åˆ—ç¼ºé™·ï¼Œä¹‹å‰æˆ‘ä»¬çš„ç³»ç»Ÿç”¨åˆ°äº†rabbitMQæ¶ˆæ¯é˜Ÿåˆ—å»ç”¨äºåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ã€äº‹ä»¶é©±åŠ¨ç­‰åœºæ™¯ã€‚é€šè¿‡RabbitMQï¼Œä»»åŠ¡è°ƒåº¦ç³»ç»Ÿå¯ä»¥å°†ä»»åŠ¡åˆ†å‘åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œå¹¶è·å–ä»»åŠ¡æ‰§è¡Œç»“æœã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰å¼Šç«¯ï¼Œå°±æ˜¯æ²¡æœ‰ä¸€ä¸ªå®Œæ•´çš„ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œä¸èƒ½å¾ˆå¥½çš„å¯¹ä»»åŠ¡æ‰§è¡Œæƒ…å†µè¿›è¡Œç›‘æ§å’Œç®¡ç†ï¼Œæ‰€ä»¥æœ€åé€‰æ‹©äº†XXL-Jobå»å‡çº§åŒ»é™¢ç³»ç»Ÿçš„å®šæ—¶ç»™å°±è¯Šäººå‘é€æ¶ˆæ¯ç­‰åŠŸèƒ½ã€‚</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æŠ€æœ¯é€‰å‹">æŠ€æœ¯é€‰å‹<a href="https://jachen99.github.io/blog/product-xxl-job#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B" class="hash-link" aria-label="æŠ€æœ¯é€‰å‹çš„ç›´æ¥é“¾æ¥" title="æŠ€æœ¯é€‰å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®˜æ–¹æ–‡æ¡£">å®˜æ–¹æ–‡æ¡£<a href="https://jachen99.github.io/blog/product-xxl-job#%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3" class="hash-link" aria-label="å®˜æ–¹æ–‡æ¡£çš„ç›´æ¥é“¾æ¥" title="å®˜æ–¹æ–‡æ¡£çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>xxl-jobï¼š<a href="https://github.com/xuxueli/xxl-job" target="_blank" rel="noopener noreferrer">https://github.com/xuxueli/xxl-job</a></p>
<p>elastic-jobï¼š<a href="https://shardingsphere.apache.org/elasticjob/" target="_blank" rel="noopener noreferrer">https://shardingsphere.apache.org/elasticjob/</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xxl-job-ä¸--elastic-jobå¯¹æ¯”å›¾">XXL-JOB ä¸  elastic-jobå¯¹æ¯”å›¾<a href="https://jachen99.github.io/blog/product-xxl-job#xxl-job-%E4%B8%8E--elastic-job%E5%AF%B9%E6%AF%94%E5%9B%BE" class="hash-link" aria-label="XXL-JOB ä¸  elastic-jobå¯¹æ¯”å›¾çš„ç›´æ¥é“¾æ¥" title="XXL-JOB ä¸  elastic-jobå¯¹æ¯”å›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>XXL-JOB</th><th>elastic-job</th></tr></thead><tbody><tr><td>å¹¶è¡Œè°ƒåº¦</td><td>è°ƒåº¦ç³»ç»Ÿå¤šçº¿ç¨‹å¹¶è¡Œ</td><td>ä»»åŠ¡åˆ†ç‰‡çš„æ–¹å¼å¹¶è¡Œ</td></tr><tr><td>å¼¹æ€§æ‰©å®¹</td><td>ä½¿ç”¨QuartzåŸºäºæ•°æ®åº“åˆ†å¸ƒå¼åŠŸèƒ½</td><td>é€šè¿‡zookeeperä¿è¯</td></tr><tr><td>é«˜å¯ç”¨</td><td>é€šè¿‡DBé”ä¿è¯</td><td>é€šè¿‡zookeeperä¿è¯</td></tr><tr><td>é˜»å¡ç­–ç•¥</td><td>å•æœºä¸²è¡Œ/ä¸¢å¼ƒåç»­çš„è°ƒåº¦/è¦†ç›–ä¹‹å‰çš„è°ƒåº¦</td><td>æ‰§è¡Œè¶…è¿‡zookeeperçš„session timeoutæ—¶é—´çš„è¯ï¼Œä¼šè¢«æ¸…é™¤ï¼Œé‡æ–°è¿›è¡Œåˆ†ç‰‡</td></tr><tr><td>åŠ¨æ€åˆ†ç‰‡ç­–ç•¥</td><td>ä»¥æ‰§è¡Œå™¨ä¸ºç»´åº¦è¿›è¡Œåˆ†ç‰‡ã€æ”¯æŒåŠ¨æ€çš„æ‰©å®¹</td><td>å¹³å‡åˆ†é…/ä½œä¸šåhashåˆ†é…/è‡ªå®šä¹‰ç­–ç•¥</td></tr><tr><td>å¤±è´¥å¤„ç†ç­–ç•¥</td><td>å¤±è´¥å‘Šè­¦/å¤±è´¥é‡è¯•</td><td>æ‰§è¡Œå®Œæ¯•åä¸»åŠ¨è·å–æœªåˆ†é…åˆ†ç‰‡ä»»åŠ¡ æœåŠ¡å™¨ä¸‹çº¿åä¸»åŠ¨å¯»æ‰¾å¯ä»¥ç”¨çš„æœåŠ¡å™¨æ‰§è¡Œä»»åŠ¡</td></tr><tr><td>ç›‘æ§</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>æ—¥å¿—</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table>
<ul>
<li>XXL-Jobå’ŒElastic-Jobéƒ½å…·æœ‰å¹¿æ³›çš„ç”¨æˆ·åŸºç¡€å’Œå®Œå–„çš„æŠ€æœ¯æ–‡æ¡£ï¼Œéƒ½å¯ä»¥æ»¡è¶³å®šæ—¶ä»»åŠ¡çš„åŸºæœ¬åŠŸèƒ½éœ€æ±‚</li>
<li>xxl-jobä¾§é‡åœ¨ä¸šåŠ¡å®ç°ç®€å•å’Œç®¡ç†æ–¹ä¾¿ï¼Œå®¹æ˜“å­¦ä¹ ï¼Œå¤±è´¥ä¸è·¯ç”±ç­–ç•¥ä¸°å¯Œ, æ¨èä½¿ç”¨åœ¨ç”¨æˆ·åŸºæ•°ç›¸å¯¹è¾ƒå°‘ï¼ŒæœåŠ¡å™¨çš„æ•°é‡åœ¨ä¸€å®šçš„èŒƒå›´å†…çš„åœºæ™¯ä¸‹ä½¿ç”¨</li>
<li>elastic-jobå…³æ³¨çš„ç‚¹åœ¨æ•°æ®ï¼Œæ·»åŠ äº†å¼¹æ€§æ‰©å®¹å’Œæ•°æ®åˆ†ç‰‡çš„æ€è·¯ï¼Œæ›´æ–¹ä¾¿åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡å™¨çš„èµ„æº, ä½†æ˜¯å­¦ä¹ éš¾åº¦è¾ƒå¤§ï¼Œæ¨èåœ¨æ•°æ®é‡åºå¤§ï¼ŒæœåŠ¡å™¨æ•°é‡å¤šçš„æ—¶å€™ä½¿ç”¨</li>
</ul>
<p><em>ç»¼åˆè€ƒè™‘ï¼Œæœ€åæˆ‘ä»¬é€‰æ‹©äº†xxl-jobè¿™ä¸€è§£å†³æ–¹æ³•ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå°demoï¼Œç”¨äºæ•´åˆxxl-jobåˆ°springå¾®æœåŠ¡é¡¹ç›®ä¸­å¾—ä»¥åº”ç”¨çš„æœ€ä½³å®è·µã€‚</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ç®€ä»‹">ç®€ä»‹<a href="https://jachen99.github.io/blog/product-xxl-job#%E7%AE%80%E4%BB%8B" class="hash-link" aria-label="ç®€ä»‹çš„ç›´æ¥é“¾æ¥" title="ç®€ä»‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»€ä¹ˆæ˜¯xxl-job">ä»€ä¹ˆæ˜¯XXL-Job<a href="https://jachen99.github.io/blog/product-xxl-job#%E4%BB%80%E4%B9%88%E6%98%AFxxl-job" class="hash-link" aria-label="ä»€ä¹ˆæ˜¯XXL-Jobçš„ç›´æ¥é“¾æ¥" title="ä»€ä¹ˆæ˜¯XXL-Jobçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>XXL-JOB<!-- -->
<ul>
<li>å¤§ä¼—ç‚¹è¯„çš„å‘˜å·¥å¾é›ªé‡Œåœ¨15å¹´å‘å¸ƒçš„åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œæ˜¯è½»é‡çº§çš„åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦æ¡†æ¶ï¼Œç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€ç®€å•ã€æ¸…ç†ã€æ˜“æ‰©å±•; è€ç‰ˆæœ¬æ˜¯ä¾èµ–quartzçš„å®šæ—¶ä»»åŠ¡è§¦å‘ï¼Œåœ¨v2.1.0ç‰ˆæœ¬å¼€å§‹ ç§»é™¤quartzä¾èµ–</li>
<li>å®˜ç½‘åœ°å€ï¼š<a href="https://www.xuxueli.com/xxl-job/" target="_blank" rel="noopener noreferrer">https://www.xuxueli.com/xxl-job/</a></li>
<li>GitHubåœ°å€ï¼š<a href="https://github.com/xuxueli/xxl-job/" target="_blank" rel="noopener noreferrer">https://github.com/xuxueli/xxl-job/</a></li>
</ul>
</li>
<li>xxl-jobçš„è®¾è®¡æ€æƒ³<!-- -->
<ul>
<li>å°†è°ƒåº¦è¡Œä¸ºæŠ½è±¡å½¢æˆâ€œè°ƒåº¦ä¸­å¿ƒâ€å…¬å…±å¹³å°ï¼Œè€Œå¹³å°è‡ªèº«å¹¶ä¸æ‰¿æ‹…ä¸šåŠ¡é€»è¾‘ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€è´Ÿè´£å‘èµ·è°ƒåº¦è¯·æ±‚ã€‚</li>
<li>å°†ä»»åŠ¡æŠ½è±¡æˆåˆ†æ•£çš„JobHandlerï¼Œäº¤ç”±â€œæ‰§è¡Œå™¨â€ç»Ÿä¸€ç®¡ç†</li>
<li>â€œæ‰§è¡Œå™¨â€è´Ÿè´£æ¥æ”¶è°ƒåº¦è¯·æ±‚å¹¶æ‰§è¡Œå¯¹åº”çš„JobHandlerä¸­ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li>å› æ­¤ï¼Œâ€œè°ƒåº¦â€å’Œâ€œä»»åŠ¡â€ä¸¤éƒ¨åˆ†å¯ä»¥ç›¸äº’è§£è€¦ï¼Œæé«˜ç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§å’Œæ‰©å±•æ€§</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®˜ç½‘æ¶æ„å›¾">å®˜ç½‘æ¶æ„å›¾<a href="https://jachen99.github.io/blog/product-xxl-job#%E5%AE%98%E7%BD%91%E6%9E%B6%E6%9E%84%E5%9B%BE" class="hash-link" aria-label="å®˜ç½‘æ¶æ„å›¾çš„ç›´æ¥é“¾æ¥" title="å®˜ç½‘æ¶æ„å›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>è°ƒåº¦ä¸­å¿ƒ<!-- -->
<ul>
<li>è´Ÿè´£ç®¡ç†è°ƒåº¦çš„ä¿¡æ¯ï¼ŒæŒ‰ç…§è°ƒåº¦çš„é…ç½®æ¥å‘å‡ºè°ƒåº¦è¯·æ±‚</li>
<li>æ”¯æŒå¯è§†åŒ–ã€ç®€å•çš„åŠ¨æ€ç®¡ç†è°ƒåº¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–°å»ºã€åˆ é™¤ã€æ›´æ–°ç­‰ï¼Œè¿™äº›æ“ä½œéƒ½ä¼šå®æ—¶ç”Ÿæ•ˆï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒç›‘æ§è°ƒåº¦ç»“æœä»¥åŠæ‰§è¡Œæ—¥å¿—ã€‚</li>
</ul>
</li>
<li>æ‰§è¡Œå™¨<!-- -->
<ul>
<li>è´Ÿè´£æ¥æ”¶è¯·æ±‚å¹¶ä¸”æ‰§è¡Œä»»åŠ¡çš„é€»è¾‘ã€‚ä»»åŠ¡æ¨¡å—ä¸“æ³¨äºä»»åŠ¡çš„æ‰§è¡Œæ“ä½œç­‰ç­‰ï¼Œä½¿å¾—å¼€å‘å’Œç»´æŠ¤æ›´åŠ çš„ç®€å•ä¸é«˜æ•ˆ</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://file.xdclass.net/note/2022/81-XXL-JOB/img/image-20220519181542821.png" alt="image-20220519181542821" class="img_ev3q"></p>
<ul>
<li>XXL-Jobå…·æœ‰å“ªäº›ç‰¹æ€§<!-- -->
<ul>
<li>è°ƒåº¦ä¸­å¿ƒHAï¼ˆä¸­å¿ƒå¼ï¼‰ï¼šè°ƒåº¦é‡‡ç”¨äº†ä¸­å¿ƒå¼è¿›è¡Œè®¾è®¡ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯è°ƒåº¦ä¸­å¿ƒHA</li>
<li>æ‰§è¡Œå™¨HAï¼ˆåˆ†å¸ƒå¼ï¼‰ï¼šä»»åŠ¡åˆ†å¸ƒå¼çš„æ‰§è¡Œï¼Œä»»åŠ¡æ‰§è¡Œå™¨æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯ä»»åŠ¡æ‰§è¡ŒHA</li>
<li>è§¦å‘ç­–ç•¥ï¼šæœ‰Cronè§¦å‘ã€å›ºå®šé—´éš”è§¦å‘ã€å›ºå®šå»¶æ—¶è§¦å‘ã€APIäº‹ä»¶è§¦å‘ã€äººå·¥è§¦å‘ã€çˆ¶å­ä»»åŠ¡è§¦å‘</li>
<li>è·¯ç”±ç­–ç•¥ï¼šæ‰§è¡Œå™¨åœ¨é›†ç¾¤éƒ¨ç½²çš„æ—¶å€™æä¾›äº†ä¸°å¯Œçš„è·¯ç”±ç­–ç•¥ï¼Œå¦‚ï¼šç¬¬ä¸€ä¸ªã€æœ€åä¸€ä¸ªã€è½®è¯¢ã€éšæœºã€ä¸€è‡´æ€§HASHã€æœ€ä¸ç»å¸¸ä½¿ç”¨LFUã€æœ€ä¹…æœªä½¿ç”¨LRUã€æ•…éšœè½¬ç§»ç­‰ç­‰</li>
<li>æ•…éšœè½¬ç§»ï¼šå¦‚æœæ‰§è¡Œå™¨é›†ç¾¤çš„ä¸€å°æœºå™¨å‘ç”Ÿæ•…éšœï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸€å°æ­£å¸¸çš„æ‰§è¡Œå™¨å‘é€ä»»åŠ¡è°ƒåº¦</li>
<li>Rollingå®æ—¶æ—¥å¿—çš„ç›‘æ§ï¼šæ”¯æŒrollingæ–¹å¼æŸ¥çœ‹è¾“å…¥çš„å®Œæ•´æ‰§è¡Œæ—¥å¿—</li>
<li>è„šæœ¬ä»»åŠ¡ï¼šæ”¯æŒGLUEæ¨¡å¼å¼€å‘å’Œè¿è¡Œè„šæœ¬ä»»åŠ¡ï¼ŒåŒ…æ‹¬Shellã€pythonã€node.jsã€phpç­‰ç­‰ç±»å‹è„šæœ¬</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å¿«é€Ÿéƒ¨ç½²">å¿«é€Ÿéƒ¨ç½²<a href="https://jachen99.github.io/blog/product-xxl-job#%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2" class="hash-link" aria-label="å¿«é€Ÿéƒ¨ç½²çš„ç›´æ¥é“¾æ¥" title="å¿«é€Ÿéƒ¨ç½²çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æµç¨‹å›¾">æµç¨‹å›¾ï¼š<a href="https://jachen99.github.io/blog/product-xxl-job#%E6%B5%81%E7%A8%8B%E5%9B%BE" class="hash-link" aria-label="æµç¨‹å›¾ï¼šçš„ç›´æ¥é“¾æ¥" title="æµç¨‹å›¾ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20230214195315186" src="https://jachen99.github.io/assets/images/image-20230214195315186-428690aea674f569b2ab260bae532441.png" width="838" height="707" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç¯å¢ƒ">ç¯å¢ƒï¼š<a href="https://jachen99.github.io/blog/product-xxl-job#%E7%8E%AF%E5%A2%83" class="hash-link" aria-label="ç¯å¢ƒï¼šçš„ç›´æ¥é“¾æ¥" title="ç¯å¢ƒï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Maven3+ã€jdk1.8+ã€mysql5.7+</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸‹è½½é“¾æ¥">ä¸‹è½½é“¾æ¥ï¼š<a href="https://jachen99.github.io/blog/product-xxl-job#%E4%B8%8B%E8%BD%BD%E9%93%BE%E6%8E%A5" class="hash-link" aria-label="ä¸‹è½½é“¾æ¥ï¼šçš„ç›´æ¥é“¾æ¥" title="ä¸‹è½½é“¾æ¥ï¼šçš„ï¿½ï¿½ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><a href="https://github.com/xuxueli/xxl-job.git" target="_blank" rel="noopener noreferrer">https://github.com/xuxueli/xxl-job.git</a>  ç‰ˆæœ¬ï¼š2.3.0</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è¿è¡Œæ•°æ®åº“è„šæœ¬">è¿è¡Œæ•°æ®åº“è„šæœ¬<a href="https://jachen99.github.io/blog/product-xxl-job#%E8%BF%90%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%84%9A%E6%9C%AC" class="hash-link" aria-label="è¿è¡Œæ•°æ®åº“è„šæœ¬çš„ç›´æ¥é“¾æ¥" title="è¿è¡Œæ•°æ®åº“è„šæœ¬çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><code>/xxl-job/doc/db/tables_xxl_job.sql</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è°ƒåº¦ä¸­å¿ƒ">è°ƒåº¦ä¸­å¿ƒ<a href="https://jachen99.github.io/blog/product-xxl-job#%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83" class="hash-link" aria-label="è°ƒåº¦ä¸­å¿ƒçš„ç›´æ¥é“¾æ¥" title="è°ƒåº¦ä¸­å¿ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><code>è°ƒåº¦ä¸­å¿ƒé¡¹ç›®ï¼šxxl-job-admin</code> ä¿®æ”¹è¯¥æ¨¡å—ä¸‹çš„é…ç½®æ–‡ä»¶å¹¶å¯åŠ¨server</p>
<div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">### web</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.port=8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.servlet.context-path=/xxl-job-admin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">......</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">### xxl-job, datasource</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/xxl_job?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spring.datasource.username=root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spring.datasource.password=123456</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">......</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">### xxl-job, access token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">xxl.job.accessToken=jiguanchen.space</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uiç•Œé¢">UIç•Œé¢<a href="https://jachen99.github.io/blog/product-xxl-job#ui%E7%95%8C%E9%9D%A2" class="hash-link" aria-label="UIç•Œé¢çš„ç›´æ¥é“¾æ¥" title="UIç•Œé¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>è¿è¡ŒæŠ¥è¡¨<!-- -->
<ul>
<li>ä»¥å›¾å½¢åŒ–æ¥å±•ç¤ºäº†æ•´ä½“çš„ä»»åŠ¡æ‰§è¡Œæƒ…å†µ<!-- -->
<ul>
<li>ä»»åŠ¡æ•°é‡ï¼šèƒ½å¤Ÿçœ‹åˆ°è°ƒåº¦ä¸­å¿ƒè¿è¡Œçš„ä»»åŠ¡æ•°é‡</li>
<li>è°ƒåº¦æ¬¡æ•°ï¼šè°ƒåº¦ä¸­å¿ƒæ‰€è§¦å‘çš„è°ƒåº¦æ¬¡æ•°</li>
<li>æ‰§è¡Œå™¨æ•°é‡ï¼šåœ¨æ•´ä¸ªè°ƒåº¦ä¸­å¿ƒä¸­ï¼Œåœ¨çº¿çš„æ‰§è¡Œå™¨æ•°é‡æœ‰å¤šå°‘</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230214195933783" src="https://jachen99.github.io/assets/images/image-20230214195933783-ffa529f61bf3bd47ceee76cee3a5f845.png" width="1920" height="991" class="img_ev3q"></p>
<ul>
<li>ä»»åŠ¡ç®¡ç†ï¼ˆé…ç½®æ‰§è¡Œä»»åŠ¡ï¼‰<!-- -->
<ul>
<li>ç¤ºä¾‹æ‰§è¡Œå™¨ï¼šæ‰€ç”¨åˆ°çš„æ‰§è¡Œå™¨</li>
<li>ä»»åŠ¡æè¿°ï¼šæ¦‚è¿°è¯¥ä»»åŠ¡æ˜¯åšä»€ä¹ˆçš„</li>
<li>è·¯ç”±ç­–ç•¥ï¼š<!-- -->
<ul>
<li>ç¬¬ä¸€ä¸ªï¼šé€‰æ‹©ç¬¬ä¸€ä¸ªæœºå™¨</li>
<li>æœ€åä¸€ä¸ªï¼šé€‰æ‹©æœ€åä¸€ä¸ªæœºå™¨</li>
<li>è½®è¯¢ï¼šä¾æ¬¡é€‰æ‹©æ‰§è¡Œ</li>
<li>éšæœºï¼šéšæœºé€‰æ‹©åœ¨çº¿çš„æœºå™¨</li>
<li>ä¸€è‡´æ€§HASHï¼šæ¯ä¸ªä»»åŠ¡æŒ‰ç…§Hashç®—æ³•å›ºå®šé€‰æ‹©æŸä¸€å°æœºå™¨ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ä»»åŠ¡å‡åŒ€æ•£åˆ—åœ¨ä¸åŒçš„æœºå™¨ä¸Š</li>
<li>æœ€ä¸ç»å¸¸ä½¿ç”¨ï¼šä½¿ç”¨é¢‘ç‡æœ€ä½çš„æœºå™¨ä¼˜å…ˆè¢«ä½¿ç”¨</li>
<li>æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ï¼šæœ€ä¹…æœªä½¿ç”¨çš„æœºå™¨ä¼˜å…ˆè¢«é€‰ä¸¾</li>
<li>æ•…éšœè½¬ç§»ï¼šæŒ‰ç…§é¡ºåºä¾æ¬¡è¿›è¡Œå¿ƒè·³æ£€æµ‹ï¼Œç¬¬ä¸€ä¸ªå¿ƒè·³æ£€æµ‹æˆåŠŸçš„æœºå™¨é€‰å®šä¸ºç›®æ ‡çš„æ‰§è¡Œå™¨å¹¶ä¸”ä¼šå‘èµ·ä»»åŠ¡è°ƒåº¦</li>
<li>å¿™ç¢Œè½¬ç§»ï¼šæŒ‰ç…§é¡ºåºæ¥ä¾æ¬¡è¿›è¡Œç©ºé—²æ£€æµ‹ï¼Œç¬¬ä¸€ä¸ªç©ºé—²æ£€æµ‹æˆåŠŸçš„æœºå™¨ä¼šè¢«é€‰å®šä¸ºç›®æ ‡ç¾¤æœºå™¨ï¼Œå¹¶ä¸”ä¼šå‘èµ·ä»»åŠ¡è°ƒåº¦</li>
<li>åˆ†ç‰‡å¹¿æ’­ï¼šå¹¿æ’­è§¦å‘å¯¹äºé›†ç¾¤ä¸­çš„æ‰€æœ‰æœºå™¨æ‰§è¡Œä»»åŠ¡ï¼ŒåŒæ—¶ä¼šç³»ç»Ÿä¼šè‡ªåŠ¨ä¼ é€’åˆ†ç‰‡çš„å‚æ•°</li>
</ul>
</li>
<li>Cronï¼šæ‰§è¡Œè§„åˆ™</li>
<li>è°ƒåº¦è¿‡æœŸç­–ç•¥ï¼šè°ƒåº¦ä¸­å¿ƒé”™è¿‡è°ƒåº¦æ—¶é—´çš„è¡¥å¿å¤„ç†ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼šå¿½ç•¥ã€ç«‹å³è¡¥å¿è§¦å‘ä¸€æ¬¡ç­‰</li>
<li>JobHandlerï¼šå®šä¹‰æ‰§è¡Œå™¨çš„åå­—</li>
<li>é˜»å¡å¤„ç†ç­–ç•¥ï¼š<!-- -->
<ul>
<li>å•æœºä¸²è¡Œï¼šæ–°çš„è°ƒåº¦ä»»åŠ¡åœ¨è¿›å…¥åˆ°æ‰§è¡Œå™¨ä¹‹åï¼Œè¯¥è°ƒåº¦ä»»åŠ¡è¿›å…¥FIFOé˜Ÿåˆ—ï¼Œå¹¶ä»¥ä¸²è¡Œçš„æ–¹å¼å»è¿›è¡Œ</li>
<li>ä¸¢å¼ƒåç»­è°ƒåº¦ï¼šæ–°çš„è°ƒåº¦ä»»åŠ¡åœ¨è¿›å…¥åˆ°æ‰§è¡Œå™¨ä¹‹åï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„ä¸”æ­£åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œæœ¬æ¬¡çš„è°ƒåº¦ä»»åŠ¡è¯·æ±‚å°±ä¼šè¢«ä¸¢å¼ƒæ‰ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºå¤±è´¥</li>
<li>è¦†ç›–ä¹‹å‰çš„è°ƒåº¦ï¼šæ–°çš„è°ƒåº¦ä»»åŠ¡åœ¨è¿›å…¥åˆ°æ‰§è¡Œå™¨ä¹‹åï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„ä¸”æ­£åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œå°±ä¼šç»ˆæ­¢æ‰å½“å‰æ­£åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œå¹¶ä¸”æ¸…ç©ºé˜Ÿåˆ—ï¼Œè¿è¡Œæ–°çš„è°ƒåº¦ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li>å­ä»»åŠ¡IDï¼šè¾“å…¥å­ä»»åŠ¡çš„ä»»åŠ¡idï¼Œå¯å¡«å†™å¤šä¸ª</li>
<li>ä»»åŠ¡è¶…æ—¶æ—¶é—´ï¼šæ·»åŠ ä»»åŠ¡è¶…æ—¶çš„æ—¶å€™ï¼Œå•ä½sï¼Œè®¾ç½®æ—¶é—´å¤§äº0çš„æ—¶å€™å°±ä¼šç”Ÿæ•ˆ</li>
<li>å¤±è´¥é‡è¯•æ¬¡æ•°ï¼šè®¾ç½®å¤±è´¥é‡è¯•çš„æ¬¡æ•°ï¼Œè®¾ç½®æ—¶é—´å¤§äº0çš„æ—¶å€™å°±ä¼šç”Ÿæ•ˆ</li>
<li>è´Ÿè´£äººï¼šå¡«å†™è¯¥ä»»åŠ¡è°ƒåº¦çš„è´Ÿè´£äºº</li>
<li>æŠ¥è­¦é‚®ä»¶ï¼šå‡ºç°æŠ¥è­¦ï¼Œåˆ™å‘é€é‚®ä»¶</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230214200224214" src="https://jachen99.github.io/assets/images/image-20230214200224214-886206b0dd0a466984fc0206dfe6f442.png" width="1603" height="484" class="img_ev3q"></p>
<p>åˆ›å»ºä»»åŠ¡ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20230214200338357" src="https://jachen99.github.io/assets/images/image-20230214200338357-198452a996e4e5e0853b5b555a1bdabd.png" width="1207" height="874" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="åå°æœåŠ¡æ•´åˆxxl-job">åå°æœåŠ¡æ•´åˆxxl-job<a href="https://jachen99.github.io/blog/product-xxl-job#%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1%E6%95%B4%E5%90%88xxl-job" class="hash-link" aria-label="åå°æœåŠ¡æ•´åˆxxl-jobçš„ç›´æ¥é“¾æ¥" title="åå°æœåŠ¡æ•´åˆxxl-jobçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ymlé…ç½®">ymlé…ç½®<a href="https://jachen99.github.io/blog/product-xxl-job#yml%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="ymlé…ç½®çš„ç›´æ¥é“¾æ¥" title="ymlé…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">#  xxl-jobä»»åŠ¡è°ƒåº¦é…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">xxl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">admin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">addresses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">8080/xxl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">admin  </span><span class="token comment" style="color:rgb(98, 114, 164)">#è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²åœ°å€,å¤šä¸ªé…ç½®é€—å·åˆ†éš” "http://address01,http://address02"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">accessToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> jiguanchen.space  </span><span class="token comment" style="color:rgb(98, 114, 164)">#æ‰§è¡Œå™¨tokenï¼Œéç©ºæ—¶å¯ç”¨ xxl-job, access token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">executor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">appname</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> yygh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">order  </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ‰§è¡Œå™¨appåç§°,å’Œæ§åˆ¶å°é‚£è¾¹é…ç½®ä¸€æ ·çš„åç§°ï¼Œä¸ç„¶æ³¨å†Œä¸ä¸Šå»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">6666</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ‰§è¡Œå™¨çš„ç«¯å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">logpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ./data/logs/xxl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">job/executor  </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ‰§è¡Œå™¨æ—¥å¿—æ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼Œéœ€è¦å¯¹è¯¥è·¯å¾„æ‹¥æœ‰è¯»å†™æƒé™ï¼›ä¸ºç©ºåˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">logretentiondays</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">30</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ‰§è¡Œå™¨æ—¥å¿—ä¿å­˜å¤©æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># [é€‰å¡«]æ‰§è¡Œå™¨IP ï¼šé»˜è®¤ä¸ºç©ºè¡¨ç¤ºè‡ªåŠ¨è·å–IPï¼ˆå³springbootå®¹å™¨çš„ipå’Œç«¯å£ï¼Œå¯ä»¥è‡ªåŠ¨è·å–ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šï¼‰ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># å¤šç½‘å¡æ—¶å¯æ‰‹åŠ¨è®¾ç½®æŒ‡å®šIPï¼Œè¯¥IPä¸ä¼šç»‘å®šHostä»…ä½œä¸ºé€šè®¯å®ç”¨ï¼›åœ°å€ä¿¡æ¯ç”¨äº "æ‰§è¡Œå™¨æ³¨å†Œ" å’Œ "è°ƒåº¦ä¸­å¿ƒè¯·æ±‚å¹¶è§¦å‘ä»»åŠ¡"ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># [é€‰å¡«]æ‰§è¡Œå™¨æ³¨å†Œï¼šä¼˜å…ˆä½¿ç”¨è¯¥é…ç½®ä½œä¸ºæ³¨å†Œåœ°å€ï¼Œä¸ºç©ºæ—¶ä½¿ç”¨å†…åµŒæœåŠ¡ â€IP:PORTâ€œ ä½œä¸ºæ³¨å†Œåœ°å€ã€‚ä»è€Œæ›´çµæ´»çš„æ”¯æŒå®¹å™¨ç±»å‹æ‰§è¡Œå™¨åŠ¨æ€IPå’ŒåŠ¨æ€æ˜ å°„ç«¯å£é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ·»åŠ pomæ–‡ä»¶">æ·»åŠ pomæ–‡ä»¶<a href="https://jachen99.github.io/blog/product-xxl-job#%E6%B7%BB%E5%8A%A0pom%E6%96%87%E4%BB%B6" class="hash-link" aria-label="æ·»åŠ pomæ–‡ä»¶çš„ç›´æ¥é“¾æ¥" title="æ·»åŠ pomæ–‡ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-pom codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pom codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;!-- xxl_jobåˆ†å¸ƒå¼è°ƒåº¦ --&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;dependency&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;groupId&gt;com.xuxueli&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;artifactId&gt;xxl-job-core&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;version&gt;2.3.0&lt;/version&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;/dependency&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ·»åŠ configé…ç½®ç±»">æ·»åŠ configé…ç½®ç±»<a href="https://jachen99.github.io/blog/product-xxl-job#%E6%B7%BB%E5%8A%A0config%E9%85%8D%E7%BD%AE%E7%B1%BB" class="hash-link" aria-label="æ·»åŠ configé…ç½®ç±»çš„ç›´æ¥é“¾æ¥" title="æ·»åŠ configé…ç½®ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.order.config;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.xxl.job.core.executor.impl.XxlJobSpringExecutor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.beans.factory.annotation.Value;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.context.annotation.Bean;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.context.annotation.Configuration;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2023/2/14 15:46</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class XxlJobConfig {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.admin.addresses}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String adminAddresses;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.executor.appname}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String appName;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.executor.ip}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String ip;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.executor.port}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private int port;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.accessToken}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String accessToken;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.executor.logpath}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String logPath;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Value("${xxl.job.executor.logretentiondays}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private int logRetentionDays;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public XxlJobSpringExecutor xxlJobExecutor() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        XxlJobSpringExecutor xxlJobSpringExecutor = new XxlJobSpringExecutor();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setAppname(appName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setIp(ip);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setPort(port);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setAccessToken(accessToken);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setLogPath(logPath);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return xxlJobSpringExecutor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ·»åŠ handerå¤„ç†å™¨</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.order.handler;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2024/2/14 15:53</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class MyJobHandler {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private RabbitService rabbitService;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private OrderInfoMapper orderInfoMapper;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * å°±è¯Šæé†’çš„handleræ–¹æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param param  null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return  ReturnT&lt;String&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @XxlJob(value = "demoJobHandler1",init = "init",destroy = "destroy")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public ReturnT&lt;String&gt; execute(String param){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("executeæ–¹æ³•æ‰§è¡Œäº† ====ã€‹ ");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–æŸ¥è¯¢çš„æ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        DateTime dateTime = new DateTime().plusDays(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String dateString = dateTime.toString("yyyy-MM-dd");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Date date = new DateTime(dateString).toDate();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        LambdaQueryWrapper&lt;OrderInfo&gt; queryWrapper = new LambdaQueryWrapper&lt;OrderInfo&gt;(){{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            eq(OrderInfo::getReserveDate,date);  // æŸ¥è¯¢å°±è¯Šæ—¥æœŸ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ne(OrderInfo::getOrderStatus, OrderStatusEnum.CANCLE.getStatus());  // æŸ¥è¯¢æ²¡æœ‰å–æ¶ˆçš„è®¢å•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;OrderInfo&gt; orderInfoList = orderInfoMapper.selectList(queryWrapper);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for(OrderInfo orderInfo : orderInfoList) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // çŸ­ä¿¡æç¤º</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            MsmVo msmVo = new MsmVo();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            msmVo.setPhone(orderInfo.getPatientPhone());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // ç»“åˆmqå¿«é€Ÿå“åº”å…¶ä»–æ¨¡å— å‘é€æ¶ˆæ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            rabbitService.sendMessage(MqConst.EXCHANGE_DIRECT_MSM, MqConst.ROUTING_MSM_ITEM, msmVo);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return ReturnT.SUCCESS;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private void init(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("MyJobHandler init &gt;&gt;&gt;&gt;&gt; " + true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String jobParam = XxlJobHelper.getJobParam();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("jobParam = " + jobParam);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ•ˆæœå›¾">æ•ˆæœå›¾<a href="https://jachen99.github.io/blog/product-xxl-job#%E6%95%88%E6%9E%9C%E5%9B%BE" class="hash-link" aria-label="æ•ˆæœå›¾çš„ç›´æ¥é“¾æ¥" title="æ•ˆæœå›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®Œæˆè§„åˆ™å†…çš„å®šæ—¶ä»»åŠ¡ï¼Œåˆ°æŒ‡å®šæ—¶é—´å‘å°±è¯Šäººå‘é€æ¶ˆæ¯</p>
<p><img decoding="async" loading="lazy" alt="image-20230214201137647" src="https://jachen99.github.io/assets/images/image-20230214201137647-78853315d90bec43fb641d44f62ae203.png" width="1498" height="329" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20230214201148157" src="https://jachen99.github.io/assets/images/image-20230214201148157-e16f4946aad02ccb28495a972fde1805.png" width="1485" height="258" class="img_ev3q"></p>
<p>è°ƒåº¦æ—¥å¿—</p>
<p><img decoding="async" loading="lazy" alt="image-20230214201947305" src="https://jachen99.github.io/assets/images/image-20230214201947305-25fa330099f9149f279b07395476a6ec.png" width="1601" height="807" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="xxl-jobé›†ç¾¤éƒ¨ç½²å’Œé«˜å¯ç”¨æ¡ˆä¾‹é…ç½®">XXL-Jobé›†ç¾¤éƒ¨ç½²å’Œé«˜å¯ç”¨æ¡ˆä¾‹é…ç½®<a href="https://jachen99.github.io/blog/product-xxl-job#xxl-job%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E5%92%8C%E9%AB%98%E5%8F%AF%E7%94%A8%E6%A1%88%E4%BE%8B%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="XXL-Jobé›†ç¾¤éƒ¨ç½²å’Œé«˜å¯ç”¨æ¡ˆä¾‹é…ç½®çš„ç›´æ¥é“¾æ¥" title="XXL-Jobé›†ç¾¤éƒ¨ç½²å’Œé«˜å¯ç”¨æ¡ˆä¾‹é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é›†ç¾¤æ¶æ„å›¾">é›†ç¾¤æ¶æ„å›¾<a href="https://jachen99.github.io/blog/product-xxl-job#%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84%E5%9B%BE" class="hash-link" aria-label="é›†ç¾¤æ¶æ„å›¾çš„ç›´æ¥é“¾æ¥" title="é›†ç¾¤æ¶æ„å›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20230214203111017" src="https://jachen99.github.io/assets/images/image-20230214203111017-a88e2f9bec270b41851edadd8e1016ee.png" width="1408" height="733" class="img_ev3q"></p>
<p>æ‰§è¡Œå™¨é…ç½®è°ƒåº¦ä¸­å¿ƒé›†ç¾¤</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">#è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²åœ°å€,å¤šä¸ªé…ç½®é€—å·åˆ†éš” "http://address01,http://address02"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">xxl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">admin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">addresses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">8080/xxl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">admin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">8081/xxl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">admin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="xxl-jobå¤„ç†æµ·é‡æ•°æ®-åˆ†ç‰‡ä»»åŠ¡å®æ“">XXL-Jobå¤„ç†æµ·é‡æ•°æ®-åˆ†ç‰‡ä»»åŠ¡å®æ“<a href="https://jachen99.github.io/blog/product-xxl-job#xxl-job%E5%A4%84%E7%90%86%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE-%E5%88%86%E7%89%87%E4%BB%BB%E5%8A%A1%E5%AE%9E%E6%93%8D" class="hash-link" aria-label="XXL-Jobå¤„ç†æµ·é‡æ•°æ®-åˆ†ç‰‡ä»»åŠ¡å®æ“çš„ç›´æ¥é“¾æ¥" title="XXL-Jobå¤„ç†æµ·é‡æ•°æ®-åˆ†ç‰‡ä»»åŠ¡å®æ“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æˆ‘ä»¬çš„éœ€æ±‚ï¼š</p>
<ul>
<li>æœ‰ä¸€ä¸ªä»»åŠ¡éœ€è¦å¤„ç†100Wæ¡æ•°æ®ï¼Œæ¯æ¡æ•°æ®çš„ä¸šåŠ¡é€»è¾‘å¤„ç†è¦0.1s</li>
<li>å¯¹äºæ™®é€šä»»åŠ¡æ¥è¯´ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç† å¯èƒ½éœ€è¦10ä¸‡ç§’æ‰èƒ½å¤„ç†å®Œï¼Œä¸šåŠ¡åˆ™ä¸¥é‡å—å½±å“</li>
<li>æ¡ˆä¾‹ï¼šåŒåä¸€å¤§ä¿ƒï¼Œç»™1000ä¸‡ç”¨æˆ·å‘è¥é”€çŸ­ä¿¡</li>
</ul>
<p>è§£å†³æ€è·¯ï¼š</p>
<ul>
<li>å¦‚æœå°†100Wæ•°æ®å‡åŒ€åˆ†ç»™é›†ç¾¤é‡Œçš„10å°æœºå™¨åŒæ—¶å¤„ç†ï¼Œ</li>
<li>æ¯å°æœºå™¨è€—æ—¶ï¼Œ1ä¸‡ç§’å³å¯ï¼Œè€—æ—¶ä¼šå¤§å¤§ç¼©çŸ­ï¼Œä¹Ÿèƒ½å……åˆ†åˆ©ç”¨é›†ç¾¤èµ„æº</li>
<li>åœ¨xxl-jobé‡Œï¼Œå¯ä»¥é…ç½®æ‰§è¡Œå™¨é›†ç¾¤æœ‰10ä¸ªæœºå™¨ï¼Œé‚£ä¹ˆåˆ†ç‰‡æ€»æ•°æ˜¯10ï¼Œåˆ†ç‰‡åºå·0~9 åˆ†åˆ«å¯¹åº”é‚£10å°æœºå™¨ã€‚</li>
<li>åˆ†ç‰‡æ–¹å¼<!-- -->
<ul>
<li>id % åˆ†ç‰‡æ€»æ•° ä½™æ•°æ˜¯0 çš„ï¼Œåœ¨ç¬¬1ä¸ªæ‰§è¡Œå™¨ä¸Šæ‰§è¡Œ</li>
<li>id % åˆ†ç‰‡æ€»æ•° ä½™æ•°æ˜¯1 çš„ï¼Œåœ¨ç¬¬2ä¸ªæ‰§è¡Œå™¨ä¸Šæ‰§è¡Œ</li>
<li>id % åˆ†ç‰‡æ€»æ•° ä½™æ•°æ˜¯2 çš„ï¼Œåœ¨ç¬¬3ä¸ªæ‰§è¡Œå™¨ä¸Šæ‰§è¡Œ</li>
<li>...</li>
<li>id % åˆ†ç‰‡æ€»æ•° ä½™æ•°æ˜¯9 çš„ï¼Œåœ¨ç¬¬10ä¸ªæ‰§è¡Œå™¨ä¸Šæ‰§è¡Œ</li>
</ul>
</li>
</ul>
<p>å…¶ä»–è§£å†³æ–¹å¼</p>
<ul>
<li>ä¹Ÿå¯ä»¥å¯åŠ¨å¤šä¸ªjobï¼Œä½¿ç”¨åŒä¸ªjobHandler,é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ§åˆ¶</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é€‰ç”¨åˆ†ç‰‡å¹¿æ’­çš„è·¯ç”±ç­–ç•¥å®æ“">é€‰ç”¨åˆ†ç‰‡å¹¿æ’­çš„è·¯ç”±ç­–ç•¥å®æ“<a href="https://jachen99.github.io/blog/product-xxl-job#%E9%80%89%E7%94%A8%E5%88%86%E7%89%87%E5%B9%BF%E6%92%AD%E7%9A%84%E8%B7%AF%E7%94%B1%E7%AD%96%E7%95%A5%E5%AE%9E%E6%93%8D" class="hash-link" aria-label="é€‰ç”¨åˆ†ç‰‡å¹¿æ’­çš„è·¯ç”±ç­–ç•¥å®æ“çš„ç›´æ¥é“¾æ¥" title="é€‰ç”¨åˆ†ç‰‡å¹¿æ’­çš„è·¯ç”±ç­–ç•¥å®æ“çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20230214203833637" src="https://jachen99.github.io/assets/images/image-20230214203833637-06704b31c35de3df3a903312bd7add3b.png" width="969" height="297" class="img_ev3q"></p>
<p>ä¸»è¦å‚æ•°</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// åˆ†ç‰‡å¹¿æ’­ä»»åŠ¡	    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// å½“å‰åˆ†ç‰‡æ•°ï¼Œä»0å¼€å§‹ï¼Œå³æ‰§è¡Œå™¨çš„åºå·</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int shardIndex = XxlJobHelper.getShardIndex();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//æ€»åˆ†ç‰‡æ•°ï¼Œæ‰§è¡Œå™¨é›†ç¾¤æ€»æœºå™¨æ•°é‡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int shardTotal = XxlJobHelper.getShardTotal();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// ä¸šåŠ¡é€»è¾‘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>xxl-job</category>
        </item>
        <item>
            <title><![CDATA[MongoDBå®ç°é€»è¾‘åˆ é™¤]]></title>
            <link>https://jachen99.github.io/blog/product-logic-delete</link>
            <guid>https://jachen99.github.io/blog/product-logic-delete</guid>
            <pubDate>Wed, 28 Jun 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šæˆ‘ä»¬å¯¹MongoDBé‡‡ç”¨çš„é€»è¾‘åˆ é™¤çš„æ–¹æ¡ˆï¼Œä¸MySQLå®Œå…¨ä¸åŒã€‚ å¾—ç›ŠäºMongoDBæ“…é•¿å‚¨å­˜éç»“æ„åŒ–æ•°æ®çš„ä¼˜ç‚¹ï¼Œå³ä½¿ä¸šåŠ¡æ•°æ®ç»“æ„å‘ç”Ÿï¼Œä¹Ÿä¸ä¼šå½±å“åŸæ¥çš„æ•°æ®ï¼Œè¿˜èƒ½ä¿è¯ä¸šåŠ¡è¡¨æŸ¥è¯¢æ•ˆç‡ã€‚ è‹¥MySQLé‡‡ç”¨æ­¤æ–¹æ¡ˆï¼Œåˆ™æœ‰ä¸šåŠ¡æ•°æ®åº“è¡¨ç»“æ„å˜åŠ¨å¯¼è‡´æ•°æ®è¿ç§»å¤±è´¥çš„é£é™©ï¼Œç”šè‡³å½±å“æ­£å¸¸ä¸šåŠ¡æµç¨‹ã€‚ ç»¼åˆè€ƒè™‘ï¼Œå…³ç³»å‹æ•°æ®åº“é€‚åˆé€šè¿‡â€œåˆ é™¤æ ‡è®°â€å®ç°é€»è¾‘åˆ é™¤ï¼Œéå…³ç³»å‹æ•°æ®åº“æ›´é€‚åˆå°†â€œå·²åˆ é™¤â€çš„æ•°æ®è¿ç§»è‡³å›æ”¶è¡¨ä¸­ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>æˆ‘ä»¬å¯¹<code>MongoDB</code>é‡‡ç”¨çš„é€»è¾‘åˆ é™¤çš„æ–¹æ¡ˆï¼Œä¸<code>MySQL</code>å®Œå…¨ä¸åŒã€‚ å¾—ç›Šäº<code>MongoDB</code>æ“…é•¿å‚¨å­˜éç»“æ„åŒ–æ•°æ®çš„ä¼˜ç‚¹ï¼Œå³ä½¿ä¸šåŠ¡æ•°æ®ç»“æ„å‘ç”Ÿï¼Œä¹Ÿä¸ä¼šå½±å“åŸæ¥çš„æ•°æ®ï¼Œè¿˜èƒ½ä¿è¯ä¸šåŠ¡è¡¨æŸ¥è¯¢æ•ˆç‡ã€‚ è‹¥<code>MySQL</code>é‡‡ç”¨æ­¤æ–¹æ¡ˆï¼Œåˆ™æœ‰ä¸šåŠ¡æ•°æ®åº“è¡¨ç»“æ„å˜åŠ¨å¯¼è‡´æ•°æ®è¿ç§»å¤±è´¥çš„é£é™©ï¼Œç”šè‡³å½±å“æ­£å¸¸ä¸šåŠ¡æµç¨‹ã€‚ ç»¼åˆè€ƒè™‘ï¼Œå…³ç³»å‹æ•°æ®åº“é€‚åˆé€šè¿‡â€œåˆ é™¤æ ‡è®°â€å®ç°é€»è¾‘åˆ é™¤ï¼Œéå…³ç³»å‹æ•°æ®åº“æ›´é€‚åˆå°†â€œå·²åˆ é™¤â€çš„æ•°æ®è¿ç§»è‡³å›æ”¶è¡¨ä¸­ã€‚</em></p>
<p>ä¸¾ä¸ªå°demo</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å¦‚æœæ”¹å˜è¡¨å­—æ®µ">å¦‚æœæ”¹å˜è¡¨å­—æ®µï¼š<a href="https://jachen99.github.io/blog/product-logic-delete#%E5%A6%82%E6%9E%9C%E6%94%B9%E5%8F%98%E8%A1%A8%E5%AD%97%E6%AE%B5" class="hash-link" aria-label="å¦‚æœæ”¹å˜è¡¨å­—æ®µï¼šçš„ç›´æ¥é“¾æ¥" title="å¦‚æœæ”¹å˜è¡¨å­—æ®µï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>â€‹		é¦–å…ˆå¯¼å…¥äº† MongoDB é©±åŠ¨ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ª MongoDB å®¢æˆ·ç«¯ï¼ˆ<code>MongoClient</code>ï¼‰ï¼Œå¹¶è¿æ¥åˆ°äº†æœ¬åœ°çš„ MongoDB æœåŠ¡å™¨ï¼ˆ"mongodb://localhost:27017"ï¼‰ã€‚é€šè¿‡å®¢æˆ·ç«¯è·å–äº†æ•°æ®åº“ "test" ä¸­çš„é›†åˆ "collection"ã€‚åœ¨é€»è¾‘åˆ é™¤ä»£ç ä¸­ï¼Œé¦–å…ˆé€šè¿‡ ObjectId åˆ›å»ºäº†ä¸€ä¸ª ObjectId å¯¹è±¡ï¼Œå…¶å€¼ä¸º "5f36f47a06c5a722497f37b5"ã€‚ç„¶åï¼Œé€šè¿‡è°ƒç”¨ <code>updateOne</code> æ–¹æ³•å¯¹è¯¥æ–‡æ¡£è¿›è¡Œäº†é€»è¾‘åˆ é™¤æ“ä½œï¼Œå³åœ¨è¯¥æ–‡æ¡£ä¸­æ·»åŠ /æ›´æ–°äº†ä¸€ä¸ª "deleted" å­—æ®µï¼Œè¯¥å­—æ®µçš„å€¼ä¸º trueã€‚</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.mongodb</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">mongodb-driver-sync</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">4.0.5</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoClients;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoCollection;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.model.Filters;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.model.Updates;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bson.Document;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bson.types.ObjectId;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class MongoDBLogicDeleteExample {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åˆ›å»º MongoDB å®¢æˆ·ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoClient mongoClient = MongoClients.create("mongodb://localhost:27017");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–æ•°æ®åº“å’Œé›†åˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoCollection&lt;Document&gt; collection = mongoClient.getDatabase("test").getCollection("collection");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // é€»è¾‘åˆ é™¤</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ObjectId id = new ObjectId("5f36f47a06c5a722497f37b5");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        collection.updateOne(Filters.eq("_id", id), Updates.set("deleted", true));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å…³é—­ MongoDB å®¢æˆ·ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        mongoClient.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>â€‹		ç„¶ååœ¨æŸ¥è¯¢ä»£ç ä¸­ï¼Œé€šè¿‡è°ƒç”¨ <code>find</code> æ–¹æ³•æŸ¥è¯¢ "deleted" å­—æ®µä¸ç­‰äº true çš„æ–‡æ¡£ï¼Œå³æŸ¥è¯¢æœªè¢«é€»è¾‘åˆ é™¤çš„æ–‡æ¡£ã€‚ç„¶åï¼Œå°†æŸ¥è¯¢ç»“æœå­˜å…¥ <code>documents</code> é›†åˆä¸­ã€‚æœ€åï¼Œé€šè¿‡å¾ªç¯æ‰“å°å‡ºäº†æŸ¥è¯¢ç»“æœä¸­çš„æ¯ä¸€ä¸ªæ–‡æ¡£ã€‚æœ€åï¼Œå…³é—­äº† MongoDB å®¢æˆ·ç«¯ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoClients;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoCollection;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.model.Filters;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bson.Document;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class MongoDBQueryExample {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åˆ›å»º MongoDB å®¢æˆ·ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoClient mongoClient = MongoClients.create("mongodb://localhost:27017");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–æ•°æ®åº“å’Œé›†åˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoCollection&lt;Document&gt; collection = mongoClient.getDatabase("test").getCollection("collection");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æŸ¥è¯¢</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;Document&gt; documents = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        collection.find(Filters.ne("deleted", true)).into(documents);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æ‰“å°ç»“æœ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (Document document : documents) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.println(document);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å…³é—­ MongoDB å®¢æˆ·ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸æ”¹å˜è¡¨å­—æ®µ">ä¸æ”¹å˜è¡¨å­—æ®µ<a href="https://jachen99.github.io/blog/product-logic-delete#%E4%B8%8D%E6%94%B9%E5%8F%98%E8%A1%A8%E5%AD%97%E6%AE%B5" class="hash-link" aria-label="ä¸æ”¹å˜è¡¨å­—æ®µçš„ç›´æ¥é“¾æ¥" title="ä¸æ”¹å˜è¡¨å­—æ®µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¦‚æœä¸æƒ³æ·»åŠ å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ MongoDB çš„å¦ä¸€ç§å®ç°é€»è¾‘åˆ é™¤çš„æ–¹æ³•ï¼Œå³ä½¿ç”¨è½¯åˆ é™¤ã€‚è½¯åˆ é™¤çš„æ€æƒ³æ˜¯å°†æ–‡æ¡£ç§»åŠ¨åˆ°å¦ä¸€ä¸ªé›†åˆä¸­ï¼Œè€Œä¸æ˜¯çœŸæ­£åˆ é™¤æ–‡æ¡£ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.MongoClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoCollection;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.mongodb.client.MongoDatabase;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bson.Document;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.bson.types.ObjectId;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class LogicalDeletionExample {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åˆ›å»º MongoDB å®¢æˆ·ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoClient mongoClient = new MongoClient("mongodb://localhost:27017");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–æ•°æ®åº“</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoDatabase database = mongoClient.getDatabase("test");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–åŸå§‹é›†åˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoCollection&lt;Document&gt; collection = database.getCollection("collection");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–æ–°é›†åˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MongoCollection&lt;Document&gt; deletedCollection = database.getCollection("deleted_collection");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // é€»è¾‘åˆ é™¤</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ObjectId id = new ObjectId("5f36f47a06c5a722497f37b5");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Document deletedDocument = collection.find(new Document("_id", id)).first();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        deletedCollection.insertOne(deletedDocument);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        collection.deleteOne(new Document("_id", id));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æŸ¥è¯¢</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;Document&gt; documents = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        collection.find().into(documents);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æ‰“å°ç»“æœ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (Document document : documents) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.println(document);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å…³é—­å®¢æˆ·ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        mongoClient.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä»¥ä¸Šä»£ç é€šè¿‡å°†æ–‡æ¡£ç§»åŠ¨åˆ°æ–°é›†åˆä¸­ï¼Œå®ç°äº† MongoDB çš„é€»è¾‘åˆ é™¤ï¼Œå¹¶ä¸”ä¸æ·»åŠ å­—æ®µã€‚</p>]]></content:encoded>
            <category>æ•°æ®åº“</category>
            <category>MongoDB</category>
        </item>
        <item>
            <title><![CDATA[å®ç”¨æ¡†æ¶EasyExcel]]></title>
            <link>https://jachen99.github.io/blog/product-easyexcel</link>
            <guid>https://jachen99.github.io/blog/product-easyexcel</guid>
            <pubDate>Thu, 20 Apr 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šEasyExcelæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ç®€å•ã€çœå†…å­˜çš„è¯»å†™Excelçš„å¼€æºé¡¹ç›®ã€‚åœ¨å°½å¯èƒ½èŠ‚çº¦å†…å­˜çš„æƒ…å†µä¸‹æ”¯æŒè¯»å†™ç™¾Mçš„Excelã€‚å®ƒæœ‰è®¸è®¸å¤šå¤šçš„åº”ç”¨åœºæ™¯ ä¾‹å¦‚ æ•°æ®å¯¼å…¥ï¼šå‡è½»å½•å…¥å·¥ä½œé‡ ï¼›æ•°æ®å¯¼å‡ºï¼šç»Ÿè®¡ä¿¡æ¯å½’æ¡£ ï¼› æ•°æ®ä¼ è¾“ï¼šå¼‚æ„ç³»ç»Ÿä¹‹é—´æ•°æ®ä¼ è¾“ç­‰ç­‰]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>EasyExcelæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ç®€å•ã€çœå†…å­˜çš„è¯»å†™Excelçš„å¼€æºé¡¹ç›®ã€‚åœ¨å°½å¯èƒ½èŠ‚çº¦å†…å­˜çš„æƒ…å†µä¸‹æ”¯æŒè¯»å†™ç™¾Mçš„Excelã€‚å®ƒæœ‰è®¸è®¸å¤šå¤šçš„åº”ç”¨åœºæ™¯ ä¾‹å¦‚ æ•°æ®å¯¼å…¥ï¼šå‡è½»å½•å…¥å·¥ä½œé‡ ï¼›æ•°æ®å¯¼å‡ºï¼šç»Ÿè®¡ä¿¡æ¯å½’æ¡£ ï¼› æ•°æ®ä¼ è¾“ï¼šå¼‚æ„ç³»ç»Ÿä¹‹é—´æ•°æ®ä¼ è¾“ç­‰ç­‰</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1easyexcelä»‹ç»">1ã€EasyExcelä»‹ç»<a href="https://jachen99.github.io/blog/product-easyexcel#1easyexcel%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="1ã€EasyExcelä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1ã€EasyExcelä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li>Javaé¢†åŸŸè§£æã€ç”ŸæˆExcelæ¯”è¾ƒæœ‰åçš„æ¡†æ¶æœ‰Apache poiã€jxlç­‰ã€‚ä½†ä»–ä»¬éƒ½å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜å°±æ˜¯éå¸¸çš„è€—å†…å­˜ã€‚å¦‚æœä½ çš„ç³»ç»Ÿå¹¶å‘é‡ä¸å¤§çš„è¯å¯èƒ½è¿˜è¡Œï¼Œä½†æ˜¯ä¸€æ—¦å¹¶å‘ä¸Šæ¥åä¸€å®šä¼šOOMæˆ–è€…JVMé¢‘ç¹çš„full gcã€‚</li>
<li>EasyExcelæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ªexcelå¤„ç†æ¡†æ¶ï¼Œ<strong>ä»¥ä½¿ç”¨ç®€å•ã€èŠ‚çœå†…å­˜è‘—ç§°</strong>ã€‚EasyExcelèƒ½å¤§å¤§å‡å°‘å ç”¨å†…å­˜çš„ä¸»è¦åŸå› æ˜¯åœ¨è§£æExcelæ—¶æ²¡æœ‰å°†æ–‡ä»¶æ•°æ®ä¸€æ¬¡æ€§å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œæ˜¯ä»ç£ç›˜ä¸Šä¸€è¡Œè¡Œè¯»å–æ•°æ®ï¼Œé€ä¸ªè§£æã€‚</li>
<li>EasyExcelé‡‡ç”¨ä¸€è¡Œä¸€è¡Œçš„è§£ææ¨¡å¼ï¼Œå¹¶å°†ä¸€è¡Œçš„è§£æç»“æœä»¥è§‚å¯Ÿè€…çš„æ¨¡å¼é€šçŸ¥å¤„ç†ï¼ˆAnalysisEventListenerï¼‰</li>
</ul>
<p>æ–‡æ¡£åœ°å€ï¼š<a href="https://easyexcel.opensource.alibaba.com/" target="_blank" rel="noopener noreferrer">https://easyexcel.opensource.alibaba.com</a></p>
<p>githubåœ°å€ï¼š<a href="https://github.com/alibaba/easyexcel" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2easyexcelå†™æ“ä½œ">2ã€EasyExcelå†™æ“ä½œ<a href="https://jachen99.github.io/blog/product-easyexcel#2easyexcel%E5%86%99%E6%93%8D%E4%BD%9C" class="hash-link" aria-label="2ã€EasyExcelå†™æ“ä½œçš„ç›´æ¥é“¾æ¥" title="2ã€EasyExcelå†™æ“ä½œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21åˆ›å»ºé¡¹ç›®">2.1ã€åˆ›å»ºé¡¹ç›®<a href="https://jachen99.github.io/blog/product-easyexcel#21%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE" class="hash-link" aria-label="2.1ã€åˆ›å»ºé¡¹ç›®çš„ç›´æ¥é“¾æ¥" title="2.1ã€åˆ›å»ºé¡¹ç›®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><strong>pomä¸­å¼•å…¥xmlç›¸å…³ä¾èµ–</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependencies</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">easyexcel</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependencies</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“å¼•å…¥è¯¥ä¾èµ–ä¹‹åï¼Œä¼šå‘ç°åœ¨é¡¹ç›®çš„ä¾èµ–æ–‡ä»¶ä¸­åŒæ—¶å¤šå‡ºäº†poiçš„ç±»åº“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒEasyExcelæ˜¯åŸºäºpoiæ¥è¿›è¡Œå®ç°çš„ï¼Œé—´æ¥åœ°å¼•å…¥äº†å¦‚ä¸‹ä¾èµ–ï¼š</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.apache.poi</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">poi</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.apache.poi</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">poi-ooxml</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22åˆ›å»ºå®ä½“ç±»">2.2ã€åˆ›å»ºå®ä½“ç±»<a href="https://jachen99.github.io/blog/product-easyexcel#22%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB" class="hash-link" aria-label="2.2ã€åˆ›å»ºå®ä½“ç±»çš„ç›´æ¥é“¾æ¥" title="2.2ã€åˆ›å»ºå®ä½“ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><strong>è®¾ç½®è¡¨å¤´å’Œæ·»åŠ çš„æ•°æ®å­—æ®µ</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class Stu {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è®¾ç½®è¡¨å¤´åç§°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @ExcelProperty("å­¦ç”Ÿç¼–å·")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private int sno;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è®¾ç½®è¡¨å¤´åç§°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @ExcelProperty("å­¦ç”Ÿå§“å")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String sname;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>@ExcelPropertyï¼šç”¨äºè®¾ç½®Excelè¡¨å¤´ï¼Œå…¶ä¸­indexç”¨æˆ·è¡¨å¤´çš„ç¼–å·ï¼Œä»0å¼€å§‹ï¼›valueä¸ºè¡¨å¤´å¯¹åº”çš„å†…å®¹ã€‚</li>
<li>@DateTimeFormatï¼šç”¨äºæ—¥æœŸçš„æ ¼å¼åŒ–</li>
</ul>
<p>å®Œæˆä¸Šè¿°åŠŸèƒ½å‡†å¤‡å·¥ä½œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥ç”Ÿæˆä¸€ä¸ªExceläº†ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-å®ç°å†™æ“ä½œ">2.3 ã€å®ç°å†™æ“ä½œ<a href="https://jachen99.github.io/blog/product-easyexcel#23-%E5%AE%9E%E7%8E%B0%E5%86%99%E6%93%8D%E4%BD%9C" class="hash-link" aria-label="2.3 ã€å®ç°å†™æ“ä½œçš„ç›´æ¥é“¾æ¥" title="2.3 ã€å®ç°å†™æ“ä½œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»ºæ–¹æ³•å¾ªç¯è®¾ç½®è¦æ·»åŠ åˆ°Excelçš„æ•°æ®</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¾ªç¯è®¾ç½®è¦æ·»åŠ çš„æ•°æ®ï¼Œæœ€ç»ˆå°è£…åˆ°listé›†åˆä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">private static List&lt;Stu&gt; data() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    List&lt;Stu&gt; list = new ArrayList&lt;Stu&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Stu data = new Stu();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        data.setSno(i);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        data.setSname("å¼ ä¸‰"+i);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        list.add(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return list;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ï¼ˆ2ï¼‰å®ç°æœ€ç»ˆçš„æ·»åŠ æ“ä½œ</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String fileName = "E:\\11.xlsx";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // å¦‚æœè¿™é‡Œæƒ³ä½¿ç”¨03 åˆ™ ä¼ å…¥excelTypeå‚æ•°å³å¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    EasyExcel.write(fileName, Stu.class).sheet("å†™å…¥æ–¹æ³•ä¸€").doWrite(data());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è§£æExcelå‘¢ï¼Ÿæ¥ç€çœ‹....</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3easyexcelè¯»æ“ä½œ">3ã€EasyExcelè¯»æ“ä½œ<a href="https://jachen99.github.io/blog/product-easyexcel#3easyexcel%E8%AF%BB%E6%93%8D%E4%BD%9C" class="hash-link" aria-label="3ã€EasyExcelè¯»æ“ä½œçš„ç›´æ¥é“¾æ¥" title="3ã€EasyExcelè¯»æ“ä½œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31åˆ›å»ºå®ä½“ç±»">3.1ã€åˆ›å»ºå®ä½“ç±»<a href="https://jachen99.github.io/blog/product-easyexcel#31%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB" class="hash-link" aria-label="3.1ã€åˆ›å»ºå®ä½“ç±»çš„ç›´æ¥é“¾æ¥" title="3.1ã€åˆ›å»ºå®ä½“ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class Stu {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è®¾ç½®è¡¨å¤´åç§°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è®¾ç½®åˆ—å¯¹åº”çš„å±æ€§</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @ExcelProperty(value = "å­¦ç”Ÿç¼–å·",index = 0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private int sno;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è®¾ç½®è¡¨å¤´åç§°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è®¾ç½®åˆ—å¯¹åº”çš„å±æ€§</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @ExcelProperty(value = "å­¦ç”Ÿå§“å",index = 1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String sname;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç›‘å¬å™¨ExcelListenerï¼Œé›†æˆEasyExcelæä¾›AnalysisEventListenerç±»ï¼š</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32åˆ›å»ºè¯»å–æ“ä½œç›‘å¬å™¨">3.2ã€åˆ›å»ºè¯»å–æ“ä½œç›‘å¬å™¨<a href="https://jachen99.github.io/blog/product-easyexcel#32%E5%88%9B%E5%BB%BA%E8%AF%BB%E5%8F%96%E6%93%8D%E4%BD%9C%E7%9B%91%E5%90%AC%E5%99%A8" class="hash-link" aria-label="3.2ã€åˆ›å»ºè¯»å–æ“ä½œç›‘å¬å™¨çš„ç›´æ¥é“¾æ¥" title="3.2ã€åˆ›å»ºè¯»å–æ“ä½œç›‘å¬å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class ExcelListener extends AnalysisEventListener&lt;Stu&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //åˆ›å»ºlisté›†åˆå°è£…æœ€ç»ˆçš„æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    List&lt;Stu&gt; list = new ArrayList&lt;Stu&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //ä¸€è¡Œä¸€è¡Œå»è¯»å–excleå†…å®¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void invoke(Stu user, AnalysisContext analysisContext) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("***"+user);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        list.add(user);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è¯»å–excelè¡¨å¤´ä¿¡æ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void invokeHeadMap(Map&lt;Integer, String&gt; headMap, AnalysisContext context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("è¡¨å¤´ä¿¡æ¯ï¼š"+headMap);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //è¯»å–å®Œæˆåæ‰§è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void doAfterAllAnalysed(AnalysisContext analysisContext) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("list = " + list);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨è¯¥ç›‘å¬å™¨ä¸­ï¼Œé€šè¿‡é‡å†™AnalysisEventListenerçš„æ–¹æ³•æ¥è·å¾—è§£æçš„æ•°æ®ã€è¡¨å¤´ä¿¡æ¯ï¼Œä»¥åŠè§£æå®Œæ¯•ä¹‹åæ‰§è¡Œçš„æ“ä½œä¿¡æ¯ã€‚</p>
<p>åŒæ ·å†™Excelä¸€æ ·ï¼Œé€šè¿‡EasyExcelç±»çš„é™æ€æ–¹æ³•æ¥æ‰§è¡Œè¯»æ“ä½œï¼š</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33è°ƒç”¨æ–¹æ³•å®ç°è¯»å–">3.3ã€è°ƒç”¨æ–¹æ³•å®ç°è¯»å–<a href="https://jachen99.github.io/blog/product-easyexcel#33%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0%E8%AF%BB%E5%8F%96" class="hash-link" aria-label="3.3ã€è°ƒç”¨æ–¹æ³•å®ç°è¯»å–çš„ç›´æ¥é“¾æ¥" title="3.3ã€è°ƒç”¨æ–¹æ³•å®ç°è¯»å–çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String fileName = "E:\\11.xlsx";</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // è¿™é‡Œ éœ€è¦æŒ‡å®šè°ƒç”¨å“ªä¸ªclasså»è¯»ï¼Œç„¶åè¯»å–ç¬¬ä¸€ä¸ªsheet æ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    EasyExcel.read(fileName, Stu.class, new ExcelListener()).sheet().doRead();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šé¢æåˆ°çš„@DateTimeFormatæ³¨è§£å¯è½¬æ¢æ—¥æœŸæ ¼å¼ï¼Œè¿˜æœ‰å…¶ä»–ç±»ä¼¼åŠŸèƒ½çš„æ³¨è§£å’Œè‡ªå®šä¹‰è½¬æ¢å™¨ã€‚</p>]]></content:encoded>
            <category>EasyExcel</category>
        </item>
        <item>
            <title><![CDATA[spring-securityæ•´åˆå¾®æœåŠ¡å®è·µ]]></title>
            <link>https://jachen99.github.io/blog/product-spring-security-microservices</link>
            <guid>https://jachen99.github.io/blog/product-spring-security-microservices</guid>
            <pubDate>Wed, 15 Mar 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èµ·å› ï¼šéšç€è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡è½¬ç§»åˆ°äº’è”ç½‘ä¸Šï¼Œå®‰å…¨æ€§å·²ç»æˆä¸ºä»»ä½•ä¸€ä¸ªåº”ç”¨ç¨‹åºå¼€å‘çš„é‡è¦è€ƒè™‘å› ç´ ã€‚è€Œåœ¨ Java åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼ŒSpring Security æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å®‰å…¨æ¡†æ¶ï¼Œå¯ä»¥æä¾›å¯é çš„èº«ä»½éªŒè¯ã€æˆæƒå’Œä¼šè¯ç®¡ç†ç­‰å®‰å…¨ç‰¹æ€§ã€‚æ— è®ºæ˜¯å¼€å‘ Web åº”ç”¨ç¨‹åºã€RESTful æœåŠ¡ã€å•é¡µåº”ç”¨ç¨‹åºæˆ–è€…å…¶ä»–ç±»å‹çš„åº”ç”¨ç¨‹åºï¼Œéƒ½å¯ä»¥ä½¿ç”¨ Spring Security æ¥ä¿æŠ¤åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚åŒæ—¶ï¼ŒSpring Security è¿˜å…·æœ‰éå¸¸å¥½çš„å¯æ‰©å±•æ€§ï¼Œå¯ä»¥ä¸ Spring ç”Ÿæ€ç³»ç»Ÿä¸­çš„å…¶ä»–æ¡†æ¶å’Œåº“è¿›è¡Œæ— ç¼é›†æˆï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ„å»ºå‡ºå¤æ‚çš„ã€é«˜åº¦å¯å®šåˆ¶çš„å®‰å…¨è§£å†³æ–¹æ¡ˆã€‚å› æ­¤ï¼Œä½¿ç”¨ Spring Security æ˜¯ä¿éšœåº”ç”¨ç¨‹åºå®‰å…¨çš„ä¸äºŒé€‰æ‹©ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èµ·å› </strong>ï¼š<em>éšç€è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡è½¬ç§»åˆ°äº’è”ç½‘ä¸Šï¼Œå®‰å…¨æ€§å·²ç»æˆä¸ºä»»ä½•ä¸€ä¸ªåº”ç”¨ç¨‹åºå¼€å‘çš„é‡è¦è€ƒè™‘å› ç´ ã€‚è€Œåœ¨ Java åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼ŒSpring Security æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å®‰å…¨æ¡†æ¶ï¼Œå¯ä»¥æä¾›å¯é çš„èº«ä»½éªŒè¯ã€æˆæƒå’Œä¼šè¯ç®¡ç†ç­‰å®‰å…¨ç‰¹æ€§ã€‚æ— è®ºæ˜¯å¼€å‘ Web åº”ç”¨ç¨‹åºã€RESTful æœåŠ¡ã€å•é¡µåº”ç”¨ç¨‹åºæˆ–è€…å…¶ä»–ç±»å‹çš„åº”ç”¨ç¨‹åºï¼Œéƒ½å¯ä»¥ä½¿ç”¨ Spring Security æ¥ä¿æŠ¤åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚åŒæ—¶ï¼ŒSpring Security è¿˜å…·æœ‰éå¸¸å¥½çš„å¯æ‰©å±•æ€§ï¼Œå¯ä»¥ä¸ Spring ç”Ÿæ€ç³»ç»Ÿä¸­çš„å…¶ä»–æ¡†æ¶å’Œåº“è¿›è¡Œæ— ç¼é›†æˆï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ„å»ºå‡ºå¤æ‚çš„ã€é«˜åº¦å¯å®šåˆ¶çš„å®‰å…¨è§£å†³æ–¹æ¡ˆã€‚å› æ­¤ï¼Œä½¿ç”¨ Spring Security æ˜¯ä¿éšœåº”ç”¨ç¨‹åºå®‰å…¨çš„ä¸äºŒé€‰æ‹©ã€‚</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æŠ€æœ¯é€‰å‹">æŠ€æœ¯é€‰å‹<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B" class="hash-link" aria-label="æŠ€æœ¯é€‰å‹çš„ç›´æ¥é“¾æ¥" title="æŠ€æœ¯é€‰å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<table><thead><tr><th></th><th>Spring Security</th><th>Apache Shiro</th><th>Apache Knox</th><th>Keycloak</th><th>Stormpath</th></tr></thead><tbody><tr><td>æ¦‚è¿°</td><td>Spring Security æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ Java åº”ç”¨ç¨‹åºå®‰å…¨æ¡†æ¶ï¼Œæä¾›äº†å®Œæ•´çš„èº«ä»½éªŒè¯ã€æˆæƒå’Œä¼šè¯ç®¡ç†åŠŸèƒ½ã€‚å®ƒå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œèƒ½å¤Ÿä¸ Spring ç”Ÿæ€ç³»ç»Ÿä¸­çš„å…¶ä»–æ¡†æ¶å’Œåº“æ— ç¼é›†æˆ</td><td>Apache Shiro æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å®‰å…¨æ¡†æ¶ï¼Œæä¾›äº†èº«ä»½éªŒè¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†ç­‰åŠŸèƒ½ã€‚å®ƒæ˜“äºä½¿ç”¨å’Œé›†æˆï¼Œèƒ½å¤Ÿä¸ä»»ä½•åº”ç”¨ç¨‹åºæ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œæ”¯æŒå¤šç§æ•°æ®æºï¼Œå¦‚ LDAPã€JDBC å’Œ Active Directory</td><td>Apache Knox æ˜¯ä¸€ä¸ªå¼€æºç½‘å…³ï¼Œæä¾›äº† REST API çš„è®¤è¯ã€æˆæƒå’Œå®¡è®¡åŠŸèƒ½ã€‚å®ƒå¯ä»¥ä¿æŠ¤ Hadoop é›†ç¾¤çš„ REST APIï¼Œæä¾›äº†å•ç‚¹ç™»å½•å’Œ OAuth2 æ”¯æŒ</td><td>Keycloak æ˜¯ä¸€ä¸ªå¼€æºçš„èº«ä»½è®¤è¯å’Œè®¿é—®ç®¡ç†è§£å†³æ–¹æ¡ˆï¼ŒåŸºäº OpenID Connect å’Œ OAuth2 åè®®ã€‚å®ƒæä¾›äº†å¯æ‰©å±•çš„èº«ä»½éªŒè¯å’ŒæˆæƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬å•ç‚¹ç™»å½•ã€å¤šå› ç´ èº«ä»½éªŒè¯å’ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ç­‰</td><td>Stormpath æ˜¯ä¸€ä¸ªäº‘èº«ä»½è®¤è¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ï¼Œæä¾›äº†å®Œæ•´çš„èº«ä»½éªŒè¯ã€æˆæƒå’Œç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºæ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼ŒåŒ…æ‹¬ Javaã€Node.js å’Œ .NET</td></tr><tr><td>ä¼˜ç‚¹</td><td>å®Œæ•´çš„å®‰å…¨ç‰¹æ€§ã€ä¸ Spring æ¡†æ¶æ— ç¼é›†æˆã€ä¸°å¯Œçš„æ’ä»¶å’Œæ‰©å±•ã€è‰¯å¥½çš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒ</td><td>æ‹¬è½»é‡çº§ã€æ˜“äºä½¿ç”¨å’Œé›†æˆã€æ”¯æŒå¤šç§æ•°æ®æºã€ä¼˜ç§€çš„æ–‡æ¡£</td><td>ä¿æŠ¤ Hadoop é›†ç¾¤çš„ REST APIã€æ”¯æŒå•ç‚¹ç™»å½•å’Œ OAuth2ã€æ˜“äºé…ç½®å’Œä½¿ç”¨</td><td>å¯æ‰©å±•çš„èº«ä»½éªŒè¯å’ŒæˆæƒåŠŸèƒ½ã€å¤šç§èº«ä»½éªŒè¯æ–¹å¼ã€åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ã€æ˜“äºä½¿ç”¨å’Œéƒ¨ç½²</td><td>äº‘èº«ä»½è®¤è¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€æ˜“äºä½¿ç”¨å’Œé›†æˆã€æä¾›å®Œæ•´çš„èº«ä»½éªŒè¯ã€æˆæƒå’Œç”¨æˆ·ç®¡ç†åŠŸèƒ½</td></tr><tr><td>ç¼ºç‚¹</td><td>é…ç½®å¤æ‚ã€ä¸Šæ‰‹è¾ƒéš¾</td><td>ä¸ Spring æ¡†æ¶çš„æ·±åº¦é›†æˆã€ä¸å¤Ÿå®Œæ•´çš„å®‰å…¨ç‰¹æ€§</td><td>ä»…é€‚ç”¨äºä¿æŠ¤ Hadoop é›†ç¾¤çš„ REST API</td><td>é…ç½®å¤æ‚ã€æ€§èƒ½è¾ƒå·®</td><td>éœ€è¦ä½¿ç”¨äº‘æœåŠ¡ã€éœ€è¦æ”¯ä»˜æœåŠ¡è´¹ç”¨ï¼Œæˆæœ¬é«˜</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>é€‚ç”¨äºåŸºäº Spring æ¡†æ¶æ„å»ºçš„åº”ç”¨ç¨‹åº</td><td>é€‚ç”¨äºä¸ä¾èµ–äº Spring æ¡†æ¶çš„åº”ç”¨ç¨‹åº</td><td>é€‚ç”¨äºéœ€è¦ä¿æŠ¤ Hadoop é›†ç¾¤çš„ REST API çš„åœºæ™¯</td><td>é€‚ç”¨äºéœ€è¦å•ç‹¬éƒ¨ç½²ä¸€ä¸ªèº«ä»½è®¤è¯å’Œè®¿é—®ç®¡ç†ç³»ç»Ÿçš„åœºæ™¯</td><td>é€‚ç”¨äºéœ€è¦ä½¿ç”¨äº‘èº«ä»½è®¤è¯å’Œè®¿é—®ç®¡ç†æœåŠ¡çš„åœºæ™¯ã€‚</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å°ç»“">å°ç»“ï¼š<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E5%B0%8F%E7%BB%93" class="hash-link" aria-label="å°ç»“ï¼šçš„ç›´æ¥é“¾æ¥" title="å°ç»“ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å›½å†…ç›®å‰éå¸¸æµè¡Œçš„å°±æ˜¯Spring Securityå’ŒApache Shiro ã€‚</p>
<p>Spring Securityå‡ºç°çš„æ—¶é—´è¾ƒæ—©ï¼Œåœ¨springbootæ²¡ç«èµ·æ¥ä¹‹å‰ä¸€ç›´éƒ½æ˜¯Shiro çš„å¤©ä¸‹ï¼Œä½†ç›®å‰æœ€èƒ½å’Œspringå…¨å®¶æ¡¶æ•´åˆèµ·æ¥çš„å°±æ˜¯Spring Securityï¼ŒSpring Security æ˜¯æœ€ä¸ºå®Œæ•´ã€å¯æ‰©å±•å’Œçµæ´»çš„å®‰å…¨æ¡†æ¶ï¼Œè€Œä¸”ä¸ Spring æ¡†æ¶çš„æ·±åº¦é›†æˆä½¿å¾—ä½¿ç”¨å’Œé…ç½®å˜å¾—ç®€å•æ–¹ä¾¿ã€‚Spring Security æä¾›äº†å…¨é¢çš„èº«ä»½éªŒè¯ã€æˆæƒå’Œä¼šè¯ç®¡ç†ç‰¹æ€§ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°æ‰©å±•åˆ°æ”¯æŒè‡ªå®šä¹‰çš„å®‰å…¨ç­–ç•¥å’Œç‰¹æ€§ã€‚è€Œä¸”ç¤¾åŒºä¹Ÿæ˜¯ååˆ†æ´»è·ƒçš„ã€‚æ‰€ä»¥æ­¤ç¯‡æ–‡ç« ä¸»è¦ä»å®è·µæµç¨‹å‡ºå‘ï¼Œå®ç°ä¸springé¡¹ç›®æ•´åˆçš„å¿«é€Ÿæ­å»ºè§£å†³æ–¹æ¡ˆã€‚</p>
<p>ç›¸å¯¹äº Shiroï¼Œåœ¨ SSM ä¸­æ•´åˆ Spring Security éƒ½æ˜¯æ¯”è¾ƒéº»çƒ¦çš„æ“ä½œï¼Œæ‰€ä»¥ï¼ŒSpring Security è™½ç„¶åŠŸèƒ½æ¯” Shiro å¼ºå¤§ï¼Œä½†æ˜¯ä½¿ç”¨åè€Œæ²¡æœ‰ Shiro å¤šï¼ˆShiro è™½ç„¶åŠŸèƒ½æ²¡æœ‰Spring Security å¤šï¼Œä½†æ˜¯å¯¹äºå¤§éƒ¨åˆ†é¡¹ç›®è€Œè¨€ï¼ŒShiro ä¹Ÿå¤Ÿç”¨äº†ï¼‰ã€‚è‡ªä»æœ‰äº† Spring Boot ä¹‹åï¼ŒSpring Boot å¯¹äº Spring Security æä¾›äº†è‡ªåŠ¨åŒ–é…ç½®æ–¹æ¡ˆï¼Œå¯ä»¥ä½¿ç”¨æ›´å°‘çš„é…ç½®æ¥ä½¿ç”¨ Spring Securityã€‚</p>
<p>å› æ­¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¸¸è§çš„å®‰å…¨ç®¡ç†æŠ€æœ¯æ ˆçš„ç»„åˆæ˜¯è¿™æ ·çš„ï¼š
â€¢ SSM + Shiro
â€¢ Spring Boot/Spring Cloud + Spring Security</p>
<p>å¦‚æœè¿˜æƒ³äº†è§£shiroè¿™ä¸€æ¡†æ¶ï¼Œæˆ‘ä¹Ÿåœ¨githubå¼€æºäº†ä¸€ä¸ªå°demoï¼Œç”¨äºæ•´åˆSpringBootä¸shiroï¼Œå®ç°å¿«é€Ÿä¸Šæ‰‹ï¼Œä»“åº“åœ°å€ï¼š<a href="https://github.com/Jachen99/rbac_shiro" target="_blank" rel="noopener noreferrer">https://github.com/Jachen99/rbac_shiro</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä»‹ç»">ä»‹ç»<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spring-securityç®€ä»‹">Spring Securityç®€ä»‹<a href="https://jachen99.github.io/blog/product-spring-security-microservices#spring-security%E7%AE%80%E4%BB%8B" class="hash-link" aria-label="Spring Securityç®€ä»‹çš„ç›´æ¥é“¾æ¥" title="Spring Securityç®€ä»‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Spring æ˜¯éå¸¸æµè¡Œå’ŒæˆåŠŸçš„ Java åº”ç”¨å¼€å‘æ¡†æ¶ï¼ŒSpring Security æ­£æ˜¯ Spring å®¶æ—ä¸­çš„æˆå‘˜ã€‚Spring Security åŸºäº Spring æ¡†æ¶ï¼Œæä¾›äº†ä¸€å¥— Web åº”ç”¨å®‰å…¨æ€§çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æ­£å¦‚ä½ å¯èƒ½çŸ¥é“çš„å…³äºå®‰å…¨æ–¹é¢çš„ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½æ˜¯â€œ<strong>è®¤è¯</strong>â€å’Œâ€œ<strong>æˆæƒ</strong>â€ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒWeb åº”ç”¨çš„å®‰å…¨æ€§åŒ…æ‹¬**ç”¨æˆ·è®¤è¯ï¼ˆAuthenticationï¼‰å’Œç”¨æˆ·æˆæƒï¼ˆAuthorizationï¼‰**ä¸¤ä¸ªéƒ¨åˆ†ï¼Œè¿™ä¸¤ç‚¹ä¹Ÿæ˜¯ SpringSecurity é‡è¦æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<p>ï¼ˆ1ï¼‰ç”¨æˆ·è®¤è¯æŒ‡çš„æ˜¯ï¼šéªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦ä¸ºç³»ç»Ÿä¸­çš„åˆæ³•ä¸»ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·èƒ½å¦è®¿é—®è¯¥ç³»ç»Ÿã€‚ç”¨æˆ·è®¤è¯ä¸€èˆ¬è¦æ±‚ç”¨æˆ·æä¾›ç”¨æˆ·åå’Œå¯†ç ï¼Œç³»ç»Ÿé€šè¿‡æ ¡éªŒç”¨æˆ·åå’Œå¯†ç æ¥å®Œæˆè®¤è¯è¿‡ç¨‹ã€‚</p>
<p><strong>é€šä¿—ç‚¹è¯´å°±æ˜¯ç³»ç»Ÿè®¤ä¸ºç”¨æˆ·æ˜¯å¦èƒ½ç™»å½•</strong></p>
<p>ï¼ˆ2ï¼‰ç”¨æˆ·æˆæƒæŒ‡çš„æ˜¯éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦æœ‰æƒé™æ‰§è¡ŒæŸä¸ªæ“ä½œã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œä¸åŒç”¨æˆ·æ‰€å…·æœ‰çš„æƒé™æ˜¯ä¸åŒçš„ã€‚æ¯”å¦‚å¯¹ä¸€ä¸ªæ–‡ä»¶æ¥è¯´ï¼Œæœ‰çš„ç”¨æˆ·åªèƒ½è¿›è¡Œè¯»å–ï¼Œè€Œæœ‰çš„ç”¨æˆ·å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¼šä¸ºä¸åŒçš„ç”¨æˆ·åˆ†é…ä¸åŒçš„è§’è‰²ï¼Œè€Œæ¯ä¸ªè§’è‰²åˆ™å¯¹åº”ä¸€ç³»åˆ—çš„æƒé™ã€‚</p>
<p><strong>é€šä¿—ç‚¹è®²å°±æ˜¯ç³»ç»Ÿåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™å»åšæŸäº›äº‹æƒ…ã€‚</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å†å²">å†å²<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E5%8E%86%E5%8F%B2" class="hash-link" aria-label="å†å²çš„ç›´æ¥é“¾æ¥" title="å†å²çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>â€œSpring Security å¼€å§‹äº 2003 å¹´å¹´åº•,â€œâ€œspring çš„ acegi å®‰å…¨ç³»ç»Ÿâ€ã€‚ èµ·å› æ˜¯ Springå¼€å‘è€…é‚®ä»¶åˆ—è¡¨ä¸­çš„ä¸€ä¸ªé—®é¢˜,æœ‰äººæé—®æ˜¯å¦è€ƒè™‘æä¾›ä¸€ä¸ªåŸºäº spring çš„å®‰å…¨å®ç°ã€‚</p>
<p>Spring Security ä»¥â€œThe Acegi Secutity System for Springâ€ çš„åå­—å§‹äº 2013 å¹´æ™šäº›æ—¶å€™ã€‚ä¸€ä¸ªé—®é¢˜æäº¤åˆ° Spring å¼€å‘è€…çš„é‚®ä»¶åˆ—è¡¨ï¼Œè¯¢é—®æ˜¯å¦å·²ç»æœ‰è€ƒè™‘ä¸€ä¸ªåŸºäºSpring çš„å®‰å…¨æ€§ç¤¾åŒºå®ç°ã€‚é‚£æ—¶å€™ Spring çš„ç¤¾åŒºç›¸å¯¹è¾ƒå°ï¼ˆç›¸å¯¹ç°åœ¨ï¼‰ã€‚å®é™…ä¸Š Spring è‡ªå·±åœ¨2013 å¹´åªæ˜¯ä¸€ä¸ªå­˜åœ¨äº ScourseForge çš„é¡¹ç›®ï¼Œè¿™ä¸ªé—®é¢˜çš„å›ç­”æ˜¯ä¸€ä¸ªå€¼å¾—ç ”ç©¶çš„é¢†åŸŸï¼Œè™½ç„¶ç›®å‰æ—¶é—´çš„ç¼ºä¹ç»„ç»‡äº†æˆ‘ä»¬å¯¹å®ƒçš„æ¢ç´¢ã€‚</p>
<p>è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä¸€ä¸ªç®€å•çš„å®‰å…¨å®ç°å»ºæˆä½†æ˜¯å¹¶æ²¡æœ‰å‘å¸ƒã€‚å‡ å‘¨åï¼ŒSpring ç¤¾åŒºçš„å…¶ä»–æˆå‘˜è¯¢é—®äº†å®‰å…¨æ€§ï¼Œè¿™æ¬¡è¿™ä¸ªä»£ç è¢«å‘é€ç»™ä»–ä»¬ã€‚å…¶ä»–å‡ ä¸ªè¯·æ±‚ä¹Ÿè·Ÿéšè€Œæ¥ã€‚åˆ° 2014 å¹´ä¸€æœˆå¤§çº¦æœ‰ 20 ä¸‡äººä½¿ç”¨äº†è¿™ä¸ªä»£ç ã€‚è¿™äº›åˆ›ä¸šè€…çš„äººæå‡ºä¸€ä¸ª SourceForge é¡¹ç›®åŠ å…¥æ˜¯ä¸ºäº†ï¼Œè¿™æ˜¯åœ¨ 2004 ä¸‰æœˆæ­£å¼æˆç«‹ã€‚</p>
<p>åœ¨æ—©äº›æ—¶å€™ï¼Œè¿™ä¸ªé¡¹ç›®æ²¡æœ‰ä»»ä½•è‡ªå·±çš„éªŒè¯æ¨¡å—ï¼Œèº«ä»½éªŒè¯è¿‡ç¨‹ä¾èµ–äºå®¹å™¨ç®¡ç†çš„å®‰å…¨æ€§å’Œ Acegi å®‰å…¨æ€§ã€‚è€Œä¸æ˜¯ä¸“æ³¨äºæˆæƒã€‚å¼€å§‹çš„æ—¶å€™è¿™å¾ˆé€‚åˆï¼Œä½†æ˜¯è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è¯·æ±‚é¢å¤–çš„å®¹å™¨æ”¯æŒã€‚å®¹å™¨ç‰¹å®šçš„è®¤è¯é¢†åŸŸæ¥å£çš„åŸºæœ¬é™åˆ¶å˜å¾—æ¸…æ™°ã€‚è¿˜æœ‰ä¸€ä¸ªç›¸å…³çš„é—®é¢˜å¢åŠ æ–°çš„å®¹å™¨çš„è·¯å¾„ï¼Œè¿™æ˜¯æœ€ç»ˆç”¨æˆ·çš„å›°æƒ‘å’Œé”™è¯¯é…ç½®çš„å¸¸è§é—®é¢˜ã€‚</p>
<p>Acegi å®‰å…¨ç‰¹å®šçš„è®¤è¯æœåŠ¡ä»‹ç»ã€‚å¤§çº¦ä¸€å¹´åï¼ŒAcegi å®‰å…¨æ­£å¼æˆä¸ºäº† Spring æ¡†æ¶çš„å­é¡¹ç›®ã€‚1.0.0 æœ€ç»ˆç‰ˆæœ¬æ˜¯å‡ºç‰ˆäº 2006 -åœ¨è¶…è¿‡ä¸¤å¹´åŠçš„å¤§é‡ç”Ÿäº§çš„è½¯ä»¶é¡¹ç›®å’Œæ•°ä»¥ç™¾è®¡çš„æ”¹è¿›å’Œç§¯æåˆ©ç”¨ç¤¾åŒºçš„è´¡çŒ®ã€‚</p>
<p>Acegi å®‰å…¨ 2007 å¹´åº•æ­£å¼æˆä¸ºäº† Spring ç»„åˆé¡¹ç›®ï¼Œæ›´åä¸º"Spring Security"ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æµç¨‹ä»‹ç»">æµç¨‹ä»‹ç»<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E6%B5%81%E7%A8%8B%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="æµç¨‹ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="æµç¨‹ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>è¦å¯¹Webèµ„æºè¿›è¡Œä¿æŠ¤ï¼Œæœ€å¥½çš„åŠæ³•è«è¿‡äºFilter
è¦æƒ³å¯¹æ–¹æ³•è°ƒç”¨è¿›è¡Œä¿æŠ¤ï¼Œæœ€å¥½çš„åŠæ³•è«è¿‡äº<a href="https://so.csdn.net/so/search?q=AOP&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">AOP</a>ã€‚</p>
<p>Spring Securityè¿›è¡Œè®¤è¯å’Œé‰´æƒçš„æ—¶å€™,å°±æ˜¯åˆ©ç”¨çš„ä¸€ç³»åˆ—çš„Filteræ¥è¿›è¡Œæ‹¦æˆªçš„ã€‚</p>
<p><img decoding="async" loading="lazy" src="https://img-blog.csdnimg.cn/20201231155747261.png" alt="img" class="img_ev3q"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œä¸€ä¸ªè¯·æ±‚æƒ³è¦è®¿é—®åˆ°APIå°±ä¼šä»å·¦åˆ°å³ç»è¿‡è“çº¿æ¡†é‡Œçš„è¿‡æ»¤å™¨ï¼Œå…¶ä¸­<strong>ç»¿è‰²éƒ¨åˆ†æ˜¯è´Ÿè´£è®¤è¯çš„è¿‡æ»¤å™¨ï¼Œè“è‰²éƒ¨åˆ†æ˜¯è´Ÿè´£å¼‚å¸¸å¤„ç†ï¼Œæ©™è‰²éƒ¨åˆ†åˆ™æ˜¯è´Ÿè´£æˆæƒ</strong>ã€‚ç»è¿‡ä¸€ç³»åˆ—æ‹¦æˆªæœ€ç»ˆè®¿é—®åˆ°æˆ‘ä»¬çš„APIã€‚</p>
<p>è¿™é‡Œé¢æˆ‘ä»¬åªéœ€è¦é‡ç‚¹å…³æ³¨ä¸¤ä¸ªè¿‡æ»¤å™¨å³å¯ï¼š<code>UsernamePasswordAuthenticationFilter</code>è´Ÿè´£ç™»å½•è®¤è¯ï¼Œ<code>FilterSecurityInterceptor</code>è´Ÿè´£æƒé™æˆæƒã€‚</p>
<p>è¯´æ˜ï¼š<strong>Spring Securityçš„æ ¸å¿ƒé€»è¾‘å…¨åœ¨è¿™ä¸€å¥—è¿‡æ»¤å™¨ä¸­ï¼Œè¿‡æ»¤å™¨é‡Œä¼šè°ƒç”¨å„ç§ç»„ä»¶å®ŒæˆåŠŸèƒ½ï¼ŒæŒæ¡äº†è¿™äº›è¿‡æ»¤å™¨å’Œç»„ä»¶ä½ å°±æŒæ¡äº†Spring Security</strong>ï¼è¿™ä¸ªæ¡†æ¶çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯å¯¹è¿™äº›è¿‡æ»¤å™¨å’Œç»„ä»¶è¿›è¡Œæ‰©å±•ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å¿«é€Ÿå®è·µ">å¿«é€Ÿå®è·µ<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E5%BF%AB%E9%80%9F%E5%AE%9E%E8%B7%B5" class="hash-link" aria-label="å¿«é€Ÿå®è·µçš„ç›´æ¥é“¾æ¥" title="å¿«é€Ÿå®è·µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ­å»ºæƒé™æ¡†æ¶åŸºæœ¬éª¨æ¶">æ­å»ºæƒé™æ¡†æ¶åŸºæœ¬éª¨æ¶<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E6%90%AD%E5%BB%BA%E6%9D%83%E9%99%90%E6%A1%86%E6%9E%B6%E5%9F%BA%E6%9C%AC%E9%AA%A8%E6%9E%B6" class="hash-link" aria-label="æ­å»ºæƒé™æ¡†æ¶åŸºæœ¬éª¨æ¶çš„ç›´æ¥é“¾æ¥" title="æ­å»ºæƒé™æ¡†æ¶åŸºæœ¬éª¨æ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>1ã€ç»™spring-securityåˆ›å»ºå•ç‹¬çš„å…¬å…±æ¨¡å—</p>
<p>2ã€å¯¼å…¥ç›¸å…³jaråŒ…ï¼Œå¦‚æœæ˜¯mavenå·¥ç¨‹ï¼Œç›´æ¥å¼•å…¥</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- Spring Securityä¾èµ– --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">spring-boot-starter-security</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯´æ˜ï¼šä¾èµ–åŒ…ï¼ˆspring-boot-starter-securityï¼‰å¯¼å…¥åï¼ŒSpring Securityå°±é»˜è®¤æä¾›äº†è®¸å¤šåŠŸèƒ½å°†æ•´ä¸ªåº”ç”¨ç»™ä¿æŠ¤äº†èµ·æ¥ï¼š</p>
<ul>
<li>è¦æ±‚ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·æ‰èƒ½ä¸åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’</li>
<li>åˆ›å»ºå¥½äº†é»˜è®¤ç™»å½•è¡¨å•</li>
<li>ç”Ÿæˆç”¨æˆ·åä¸º<code>user</code>çš„éšæœºå¯†ç å¹¶æ‰“å°åœ¨æ§åˆ¶å°ä¸Š</li>
<li><code>CSRF</code>æ”»å‡»é˜²æŠ¤ã€<code>Session Fixation</code>æ”»å‡»é˜²æŠ¤</li>
</ul>
<p>3ã€åœ¨éœ€è¦ä½¿ç”¨æƒé™æ¡†æ¶çš„æ¨¡å—å¯¼å…¥ä¾èµ–</p>
<p>è¿™é‡Œä»¥åŒ»é™¢é¢„çº¦æŒ‚å·ç³»ç»Ÿçš„orderæ¨¡å—ä¸ºä¾‹ï¼Œä»“åº“åœ°å€ï¼š<a href="https://github.com/Jachen99/yygh_parent" target="_blank" rel="noopener noreferrer">https://github.com/Jachen99/yygh_parent</a></p>
<p>å¯¼å…¥ä¾èµ–åˆ°service-orderæ¨¡å—</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">space.jachen</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">spring-security</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">1.0.1</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>4ã€å¯åŠ¨è¯¥orderæ¨¡å—ï¼Œä¼šå‘ç°æ§åˆ¶å°æ˜¾ç¤ºUsing generated security password</p>
<p><img decoding="async" loading="lazy" alt="image-20230216104643176" src="https://jachen99.github.io/assets/images/image-20230216104643176-f4f96f5b1dc242b1cd0a8cbec3971064.png" width="1054" height="248" class="img_ev3q"></p>
<p>è¯´æ˜è¯¥æ¨¡å—å·²ç»è¢«spring securityä¿æŠ¤ã€‚</p>
<p>5ã€æ­¤æ—¶æˆ‘ä»¬é€šè¿‡æµè§ˆå™¨å»è®¿é—®è¯¥æ¨¡å—ä¸‹çš„apiè·¯å¾„ï¼Œä¼šè¿›å…¥æ¡†æ¶è‡ªå¸¦çš„ç™»å½•é¡µé¢ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20230216112805097" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWQAAACjCAIAAAAy4/PPAAAZL0lEQVR4nO3de3gU533o8d87l53dnd3Zm3ZXWt0FEkjcwZi7wfEFEztxbezYjnNqOyVx/LhPmpzTJmmaPs1pkrZ+0hwnJ23SNHFxk9g5DmlqE0PAGF9ABmzuF4EAgVbS6rIrae/Xubzv+QOSAKbPTihkwfv7PA9/gEajd8Xsd9+ZnZkl8XgcEEKoHK7SA0AI3RgwFgghUzAWCCFTMBYIIVMwFgghUzAWCCFTMBYIIVMwFgghUzAWCCFTMBYIIVMwFgghUzAWCCFTMBYIIVMwFgghUzAWCCFTMBYIIVMwFgghUzAWCCFThEoP4EaQj544HQ6Ppn7zd84TaJja2ljjkQEAgAKkP/v0FwbE2Z//9IOruoIVG2c5jBaGwuH+0cyMBTf7rECuwU8YHzjdPzQuBprndTRc/dWjisJYmJCNbHnlpe0HBn7zd2K1OdyBpjX3rb1t6Wy3BQBoNBobllLZglbBYZaVGTy06YV/fz0szdUav7ii1sJf5VwwQ3/rjc0vbdnbuuCWeV948uquHFUcxsIEvZhJTSZKZMbS1cta7Ewvne3Zv7f3yI/XFwzyyQdXTrsGL9HXhGB3BYKhYI7rDNq4azFoQvyBQKg2WB+qvwZrRxWGsTDL6grMuPX+x5b7mKGNnJ2rP/tP2471dL/d/cAt08gNUgtbTfuq+z49K5VvanPz1+BoFeGEBYs/1Nq1BOy+q792VGkYi98b4cX69vmtXdPIwVOZxCBl7P2v0pQa6UQik8upmg6cYLXJisvltIkAAFTL5nKZTK5YVHVKOV6QHYrH5ZQsAgAYup5NJzO5XEnVKXCi1aG4XF6HBQCAqslkOpP9zTrtssfns/LkcnMEmstk05lMoVgyKOMFwRsIOawib6gCoaIk5TWQJAAAqpeymUwqnStqBi+IiturpRMltSS73f4aHzW0THQwXiS+QA1hNJ1MF0o6J4iKx+d2WIXL9IYVKa9RZqd5AAUAMrGhRF6zKy67VUolkrlCifCC0+VxOWVJ5K/qfwu65jAWV4RRYAyA8OQyL9DU0NPx0Z//+4+7DxwajqWI1Tmlc/6aex/6yLKpPAEoRHds+fVrb+8/3R9J5oqC3Tn/5js++dgDXS0BjhnpiaGXf/bijv2HB6IpDUT/1IVrH3n80VuagdF8rO8XL728Y8/BSCzJSa7WmfMfXvfk0laPTbx0DFo+0b311c3bd54KR3IlJiueh774zXvnNyrJky/+6w9+eaT06Neef7QDRI4mR0//6j/+c8vO/YOTeYevYeWHH1Df+eU7vadX/Y8n/+qpj5eyide++cT3D5I//tz/qtHGNm56+3h/VFACt937+KceWB502y/NFDU2/nz9v7y4ecmtq//v1/8SgO358Ve/t+1M110fv2uO75cbNu3rCVOre/mdD37ykdUd9d4bZEKGzsNYXJFiNBkbYSA75BD3vp2QieH+55758qajxQ/dfdd90+qTkZ7uXe+t//5Aa+cPujxEnDxx9PSwtb7r/iUrSTHbu3Pju2/9wtnS9ic1d9bp/Qe2/PNzrxybtuy2j390lsJlRxNUJjoANfTJv/7C3x5I2W9ecvtHp4fiZ4+/vnXr3zx9+gc//LuulrqLR8De+cn312/cwWqn3fvwY40Be2xoyCFZGbv0QVB1/Ec/ev6VN47UNrbdt3a2TLQT7/xwYCCVv2Q5Rrf+v39rbOuctXhlS8vga1ve3vyTby1a2HqLq91q5unOjMPdWwuRUMvsxW3t0zdv3Lpz4/NtU2ob/uhWGWtxQ8FYmFXKxAeP7t6uylTL7962ufvQqYaumbf+0Ycv3QtQE6On33mzL3vL03/zxMoOv8NC9SU+r/fvn9vyjZ/s/+Gn57jcMx9bN5vnJcnCA9VKq6c++dQ/7jg+uGpFVuEmzh49QjnLh9c+tKwtIAvMoMDxFi2X7N/0zZ6R2NpPffHe2xe7JcHIzZzdrH/u2e3bTsb9wdqA7YJBMHj31NhYsnjr3YvW3nePLHC6phGrcm4f6EIDb/2s5/jxxlkLnvjMUzc3KRywwr23f/UrXx89PXLRcozZZ65+8OGPttfIpdTYXOfQN14O7zmd6JrCGhwmnu4M7HXT7nzsU4uavKCXFrqHv7Ghp+fMcCRJp3nwNJ8bCcbCLDU9vu9X6/u28YxRA/jGWUvvWfvA8q66SxYrpkYHerqT2cLJNzZ8e59k4QkAnYiNaQVt5K0T6uMzwekjqZHI8JmRsehoLDI23BfPFTLjyWwmb28ONXUtZXt2/MePvh9duvzm+bNbG4Ju2ZKJ5be9tD9XUPe8vvHsgR08ATBKhdSIYainRzLZohGwXfD/SGDxgin7z/S/9+Y2C6XLFi+YPm2aTyQ8B8ZFI2WHd/QlJ/IzV81ZNK3BLXEA4FLkjhp/7yWxINycGTNaG+vcEmdIdMZN84VfDYzFC4WSAQ4T2w/hGlu7ZrU3eWw8o1rnzQudm84ksqV0wQCMxQ0FY2GWaHe1LVi1uMkOQFz+0LSumS31AY9NAKAXLqYXc7nJIUKIolgsFp4HAsAH6xqDdVMtloAkcr0Hd2/69RvhaFp2u3nJYrfVcBwPJZXpuqQEF9z5yGMZZe+h4zt//Yv9u3fMvGnlHauWhUS9P1I0ACSBswg8AABvd/in3vahqY0hl1245OWd3HTb3Y9z8vZdRw7vfvPogd3tM+bdff/9Mxq81osWYyOxYqHI/E77uVIAABDeTrhLpyCE+JyiU+IAgPC8RfEAIapODfq+HZvLIsQpix7bucOZxKK4eV7QDWoYtMw3ousMxsIsq6d27uqPP7m8zJuCvChJTh8vJOasfuiu9hrn744+coRYZSu39dWXN++LzVu15oE75jkVp9uWOPjue+dODqXE4qntWPdkw7ITvYf2vfPaazt/vWFEBekza6bXeHkuRVesue+WedOlC95GEB0+l+3S12droOO2jwZnLVxxaP/e19/e+eqGH48ZDX/5+MrGCxdiIFkJz7NsScvpTBYIADCqJg299L4H9d+cABC4FmeLoj80nAdeZZISqJ+6kAete1e/TgWHw6E4nU7Z5rBLwTo3z+tnxlIpOdQ+Z35HW1Ot21oaOV4s6ee+V82nY5GhdAnaps+675F1a5YsZPHh4bNHrDbbLXe0SBbhTGRSBdHhcCpOp8NulwTitXPSpTMLCI+OT+aoO9j4oTX3fGbdI8DY0e29k5MXH7gkpKvT73SIfT3HjpyNJlOpVDIxOtDTFxsv/mF+U+hGgzOLq4yzB+u6bu1UXj269dnvZg7Pnt7mtnG59ERRo4/+6ec9xOKUbcKxnt2vvCjGumgmvnVvXzJXAjcAQCrSs2X9d0ZDt0+fPlWbGOzu6S3ava6aJsnpvvmJL/l3fWXbC8+N9R5eMKdDtvLZxHjk5P6nvvyPDXUXX43C6Pf++QcGb104a6pDKJ44epQXhPpF7bJiu3ik5Ka1D7WfjG7f3/2tr4+vWDRbNEoHuvdkEqmL91YQOg9jcdWR+rbOr3/3W+uf++m+o/s37O/mRVsg1DB38VIJgAC37uF7BfjPPcf2vhDu7Zi79GvPfP6vnvyzMAAA2F013lDzq9s3b92Y4yRbbUPrx9Y9cv/dq4ATeFfHs//7sy9seHXPoSMvHt7NWe2+uqY5MxeLku39A5jf5tr6Vvf6d18zmOj1hVbf89ATjy9vCsgwcdFyYs2MdY896rS/3H3o1C9fDje0zfjw018Zeum78UM9PIdTTnQpEo/HKz2G656amYgnUyrv9AYClzn+zwBoODxUIna/z+V1SACMGlp8Mp7N5TXdAMKJFkl2OHxeNwegFbLJVCqdK1DgbbIjGPREBiIqsfu9LpfE8pnkRDKvGQZwnGS1KS6X03HueAJQNZ9IpTPZvKoZwHGCKDlku9ftEoRLT4VMxCcymWxJ0xjjRNEiOxxejyLwPNNyqWQynmeuYINXAkJAK2bTqXQqV9ApSJLd5VX+/kt/sfNA5MF1T3/+idVU19LR8GSB1NTWOh0ODgCYrhcz4eFJyVPnU+x28ZI9IBaLjSdTabssN4TqACAdHUzkVLvb5/Oee+eDUTUdGUswyeVxuxQJk3QjwVhUMaan8jrP8Q6bCIzqar5nz9a/+85P4vbpTz396fuXtFV6fOj6grsh1Yux/OubNo+lNa/LLnAsGx/ftWN7htmWrlwxpwMvG0WXwlhUMUaS0XD3nmMlTec4TjVAUQKLbl/5ibtumuKTKj04dN3B3ZBqxrKJiaHI4Oh4vKSBxaG0tk6r9zvxelB0WRgLhJApeDgaIWQKxgIhZAoe4CxDpzBRFFKqyF2Tu1aiGwZjTCBUEfUam1F+6Q8ijEUZkYxYBKnOJQhX+17Y6MbCgCULNF4gGAt0eb0Jy7JWocmNpUDEa+P6J6v3KYPHLMoo6oQyLAUCABB5Yn/fHU+rR/U+coTQ7wVjgRAyBWOBEDIFY4EQMgVjgRAyBWNxJdRcWlfP39fWoCyWKpq91TVCNyyMxZUYPbbnzJnwuT6kM7n128/kirphGLquG7/Jhq7rum5QxoAxRg1KDV0//8fQdYNSBsAY03Vd13XKGABQxnSD6rquG+zc2ig9d798Ro3frg6hyqjeM0yuupHBwWg8Jbu9rW2NvK4f6TmhG3zblGa/lWaT40kDRuOSn09aBJIoaIJS09rSwGnaiWO9RUZDLS21PncymQ1H00Z+0uJt9ahjyVzeHahrqQ8YmjYZPj6YIY5QS6PfJeMV5KgScGZxlajhcI7zt0ypcdsz6fS+17dPaW2bFeJPDMYi48nhociJlHPGlJpoX29/Rqxrbc6kku8eH2dAlM72rq6WI8eHwiOpiVj05MBo55Tm07u3hHNiU617LBo7Hs3n0rHd+ZqpHe0TPQcHBkbKDwahawBnFlcJ75P0wcGI2tnoMwr5YyNZcrqPpwWVeDmDiKIQaPTYJM7Q1KBXUWTFJsSGJyahlR872jcmCGOxfF1ItTBesLltNqvbyDXVyE6fKI7n4+OpAOkzMs7ek/GsbrgM3BFBlYGxuBKyS46pRqKguUVDy4/Vh2oE3tLRXJ8cGRyOFOx+v8CLwVCtVRBCFrtcGteynOwQgFIAsAkg8jyjxChkMoMTqjM0xcVHhnPAGHA88DwBsHAgi0S0iAbhdEpBEqxOX33AHvK63B5HpR89qlK4G3Il3A3NHNVGo+PRicloLL50ht9iJHJ5w253SALhZXtno8MghCOEGCWrTeIESQQAAlbZwQsCAEgWXrZZeM6i1Dg5QnmLZLUIFoFzWEVCiM3h5HgegJME3i7bLTWNpXgGgBgGp/Hv+zR0hP4gcGZxJQRHQ0eTNZ5MpwuiXNvV5uRAdTKaius2d01treJsWrm0f2AsQWltMChJlkBjqwpACNc8c67TLQNAIFRn9+iy12YbGEpxctf0Vr/bxvOypBiEF9rmLnA5bQBCU1ODZgh2m7y0RU9l05xcIwp4K11UGXgPzjJe7nPcOlVs8VR6HOg6oBoQSRgePl3pgVQG7oYghEzBWCCETMFYIIRMwVgghEzBWJTBc0AIngeFAAAoBb2KrxjEt07LqLEaRZUraDzBG3FWvazKsiXqr9YzXTAWZcwPFE8lYTBFRAFnYVWNMqbruktQKz2QisHzLMpgAAY9tx+CUwvECIDAVemeCM4syrhg46jSTQShc3BqjRAyBWOBEDIFY4EQMgVjgRAyBWOBEDIFY4EQMgVjgRAyBc+zKCOdTnMcJwj4i0LAGAMAm81W6YFUBj4Hysjlcn6/v2q3D3QhSmmhUKj0KCoGY1Ge1Wp1OPCe2ggopZRSVq0fC4fHLBBCpmAsEEKmYCwQQqZgLBBCpmAsEEKmYCyue9RgWkHF22mgSsNYXAmjmCvkc7lCIV8o5kv6tf1hWiE7fGoUgF7bH4NQGXiexZXI9h04EFMFxW2UNOIMrZzdRCllDDiOEEIYY5QyAOA4DoCef1eecIxRnuPOnwZICAAwBhyBi74XgFIGjHHcuQUYqAU9M54CCAHwFXzMqOphLK5QTW2oqX1qYWxkV/cRY1bTyZOn8yW1rq6+PujNZbMnz4QZwPSOdi09ORqL61any18bHxqb0dUIqWiKs8oeL82rI2nWXiv1nurLF0vBYG1jnT9fKPUOZyAX7ZjaxhWTw9EJVVMdOP9D1wHcDK8Qx3O8wBhn5HmZkPFQKNTZrPRHxg6dHB7rPdgwtbXTwwCMo0NppoRCXiWvFiZ69qglrfdE/1vvhSPRZDrVP1w03tv0iuF0tXc0Rc707zs6kEkl9+490NLcJPPF4wMTmjNU51OGRvKVfrgIYSyuVHJ87OiR3uHJ4pJFXXpKHQgP95wZG8+UCjqRrFzkeO+E4RR54rCwyOhYkhCfLEwN8eOaEWEeVipF+85mxibaFHowJgUVp9Pu9LulQnKCAqdKNQ7ZziUjkmwP+BRF8bR4pUo/XIQwFldKkORgsLatqb6pVhk6fEDjrAGvS6IGI4In2OJ3iCeP9GTyWnNLfXuIj44NR4uWus7ppyOjotfTFJQy46MTSd5vAQF0xoABUEIYJwDhQXICEKCGphsGZQalRfUaH0NFyASMxZXgLFaXx1Mb9HvdLgDQwQi4LVaB5ySLQCCRzEk1IavIAS0V8gWH0+m1CZomir72bKS/3itNa3TaRaLZA6IoLmyxjMXjE/HJeJb6grU8TxS7QAiAJ0QL+WhsMp5MxAq8BT+2BFUafshQGaOjo42NjU6n88J/VJNRVbBLslMkAEABsn1nJgyLgxdsNk7nCxOTJU5U6pr9/Hh0PJXJOxWlMVQLjA2cDfvramWLEc9oReIIuUUAONMfLpZUv98f8HnyJW1wotBe5+Q5kh6PTSRSRBQCXrvmCiqY9kqjlKbT6aq96hRjUcZlY4GqU5XHAl+rEEKmYCwQQqZgLBBCpmAsEEKmYCzKIATfskTnMcaq9ugm4LUhZYmiaBiGYRiVHgiqPE3TVFW1WCyVHkhl4FunZRiGUSgUCCE8j9d8VjVKqWEYHMfJslzpsVQGzizK4Hm+ajcOdAnGWDXvlmIsyqvm7QNdqMq3BDzAiRAyBWOBEDIFY4EQMgVjgRAyBWOBEDIFY4EQMgVjgRAyBc+zKO/YOL8rIkwWuCq+LACBxLOuGmNhSK+xV+l2gLEooy/BfXev9Y2wOFmo6hNykMSzaT76mfnFh2eolR5LZeBuSBk/PSq9GRawFKhkkBMT/Is91fuxDBiLMo6O84kS/pYQAIBGIVWq3pcNfBqUwRh+fjlCABgLhJBJGAuEkCkYC4SQKRgLhJApGAsEAMBzoFjBSq5kg+A58FiBq953CaoFxqJKcRwIHIgciDzwHDis8InFsEQC2++5HkKgxgmfXQJu6zUZJ7p+4Bmc1UiywD2L4XNd4BBA5GDHEfjyPnCIYLmi2YHAgSziy84HH8ai6hACPjt8dR78w3Y4NgkcQKoI2QI8vwfyRSj+nmtjDGJpeHY3JErXZLTo+oGxqEYCByEZaBEGJiGpAgC47fCJZbD+bcgVYWEzrJ4KCgeaAS4HPPMmjGbh4VkQlMHrAIGHs32wYRDi5+pAQFHgK0vhq29AYzMsVYCjEPIBT+EX78GRLBTwE1c+KHDyWHUYg2QRfnoGVs+Gx2bBQj+4BHBYYc0csFvAE4CPzYWZDojnwSnDn8wHnw14DpY3w8faIVsAg8DnVkDDBZ+O4JThiXnglKC1Hu7phCVeSKrgD8KXFoCrSj+O54MJY1GNMkX4623w9gSs7IIvLYeldb/70rzpUM/g53vgmXfgmd1QYudPdicMtp2Cf+iGb++CmiC47Jdfs5aHjT3wf3bB9/bBimngxFh8gGAsqhKFYhKe3wGffQ0GRHhqye++Ms0JpQSMTQADoAC/3YcolSBdAAZQZEAJcP/FhjMxDOPDYGhQSIFgvcIjpuj6hLGoOgTALsIiBWw8DMfgRBSMC45cjRQhWAdtdUA4sNvBRgCf7+gcPMBZfQi4ZHjmERB0KAFYdHj50O++uH03rLgT/udH4JE0OOxQInjNLToPY1F1GIOJLPzZq2AhQAAKKoxmIK7Cn/8MxnOgGfCdt+DnTiAMPAr87EEAAM2Ab797/mr9fA7WvgBHY79dHcTGYc1PYTQL2YNwRIMEAGVwdhI+sgHCuco9TnS1YSyqkarD3qFL//HwIAAAR8DQIZ0HEKBeAS0NqgqUwdnU+cV0HboHLvrGfAneDgMAFOJwviEMcirsjFzLx4D+4DAW6CKEwOpOaJIBBPAr8KNdMJav9JjQ9QFjgS7CGOwOw7ALCIN0AXaPAN7THJ2DsUAXoQxOxOBErPySqNrgW6cIIVMwFmWQ838QqnYYizLavVSx4F47AgAQOHCI1bsxYCzKeLCztKhed1urdxNB51h4aHUbH2nXKj2QiiHxeLzSY7je7RkWfnVaHM1iWKuaVYDFIf2ONq3OQSs9lsrAWCCETMFXS4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCkYC4SQKRgLhJApGAuEkCn/HzFPDRfNstOFAAAAAElFTkSuQmCC" width="356" height="163" class="img_ev3q"></p>
<p>é»˜è®¤ç”¨æˆ·åä¸ºuserï¼Œå¯†ç ä¸ºæ§åˆ¶å°è¾“å‡ºçš„éšæœºå¯†ç ï¼Œè®¤è¯æˆåŠŸåæ‰å¯ä»¥ç™»å½•ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®ç°ç”¨æˆ·è®¤è¯åŠŸèƒ½">å®ç°ç”¨æˆ·è®¤è¯åŠŸèƒ½<a href="https://jachen99.github.io/blog/product-spring-security-microservices#%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="å®ç°ç”¨æˆ·è®¤è¯åŠŸèƒ½çš„ç›´æ¥é“¾æ¥" title="å®ç°ç”¨æˆ·è®¤è¯åŠŸèƒ½çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><em>ç›®å‰ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†è‡ªå¸¦çš„ç™»å½•é¡µé¢çš„è®¿é—®ï¼Œç”¨æˆ·åå’Œå¯†ç éƒ½æ¥è‡ªäºå†…å­˜ã€‚é‚£ä¹ˆè¦è®¿é—®æ¥è‡ªäºmysqlã€redisç”šè‡³çš„ç”¨æˆ·åã€å¯†ç æ€ä¹ˆåŠå‘¢ï¼Ÿ</em></p>
<ul>
<li>åŠ å¯†å™¨PasswordEncoder</li>
<li>ç”¨æˆ·å¯¹è±¡UserDetails</li>
<li>ä¸šåŠ¡å¯¹è±¡UserDetailsService</li>
</ul>
<p>åŠŸèƒ½1ï¼šè‡ªå¸¦ç™»å½•é¡µé¢ï¼Œè®¿é—®çœŸæ­£çš„æ•°æ®åº“ï¼Œéœ€è¦åšä»€ä¹ˆï¼Ÿ</p>
<p>1ã€è®¿é—®åŸºäºå†…å­˜çš„ç”¨æˆ·åå’Œå¯†ç ä½¿ç”¨çš„æ˜¯InMeoryUserDetailsManagerï¼ˆå®ç°äº†UserDetailsServerï¼‰ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰UserDetailsServerçš„å®ç°ç±»ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.order.security;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.GrantedAuthority;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.userdetails.UserDetails;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.userdetails.UserDetailsService;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.userdetails.UsernameNotFoundException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.security.custom.CustomUser;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.user.PatientFeignClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.vo.user.LoginVo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.annotation.Resource;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Collection;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/23 22:35</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class UserDetailsServiceImpl implements UserDetailsService {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Resource</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private PatientFeignClient userInfoFeignClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public UserDetails loadUserByUsername(String phone) throws UsernameNotFoundException {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        LoginVo login = userInfoFeignClient.loginSecurity(phone);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if(login == null) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            throw new UsernameNotFoundException("ç”¨æˆ·åä¸å­˜åœ¨ï¼");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è¿™é‡Œä¸æ¯”è¾ƒå¯†ç  ï¼Œåé¢é€šè¿‡PasswordEncoderæ¯”è¾ƒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è¿”å›æ•°æ®ã€æš‚æ—¶ä¸åšæˆæƒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Collection&lt;GrantedAuthority&gt; authorities = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return new CustomUser(login,authorities);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2ã€è®¿é—®æ•°æ®åº“çš„æ–¹æ³•loadUserByUsernameï¼Œè¿”å›å€¼ä¸ºUserdetailsï¼Œå®ƒå°è£…äº†ä»æ•°æ®åº“ä¸­è¿”å›çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯å’Œæˆ‘ä»¬æ•°æ®åº“è¡¨ä¸ä¸€è‡´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦è‡ªå®šä¹‰UserDetailså®ç°ç±»ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.security.custom;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import lombok.Getter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import lombok.Setter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.GrantedAuthority;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.userdetails.User;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.vo.user.LoginVo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Collection;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * è®¿é—®æ•°æ®åº“çš„æ–¹æ³•loadUserByUsernameï¼Œè¿”å›å€¼ä¸ºUserdetailsï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * å®ƒå°è£…äº†ä»æ•°æ®åº“ä¸­è¿”å›çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯å’Œæˆ‘ä»¬æ•°æ®åº“è¡¨ä¸ä¸€è‡´ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦è‡ªå®šä¹‰UserDetailså®ç°ç±»ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/23 22:31</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class CustomUser extends User {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * æˆ‘ä»¬è‡ªå·±çš„ç”¨æˆ·å®ä½“å¯¹è±¡ï¼Œè¦è°ƒå–ç”¨æˆ·ä¿¡æ¯æ—¶ç›´æ¥è·å–è¿™ä¸ªå®ä½“å¯¹è±¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private LoginVo loginVo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param loginVo  ä»æ•°æ®åº“ä¸­æŸ¥è¯¢çš„ç”¨æˆ·ä¿¡æ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param authorities  ä»æ•°æ®åº“ä¸­æŸ¥è¯¢çš„æƒé™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public CustomUser(LoginVo loginVo,Collection&lt;? extends GrantedAuthority&gt; authorities) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        super(loginVo.getPhone(), loginVo.getCode(), authorities);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.loginVo = loginVo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>ç°åœ¨æ•°æ®éƒ½æœ‰äº†ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œå¯†ç çš„æ¯”è¾ƒã€‚</em></p>
<p>3ã€ä½¿ç”¨PasswordEncoderæ¥å£ï¼Œä½†æ˜¯ä¸åŒçš„æ•°æ®åº“é‡‡ç”¨çš„åŠ å¯†ç®—æ³•ä¸åŒï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨securityè‡ªå¸¦çš„PasswordEncoderå®ç°ç±»ï¼Œå¦‚æœä¸åˆé€‚ï¼Œå°±è‡ªå®šä¹‰ä¸€ä¸‹PasswordEncoderçš„å®ç°ç±»å³å¯ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.security.custom;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.data.redis.core.StringRedisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.crypto.password.PasswordEncoder;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * è‡ªå®šä¹‰å¯†ç ç»„ä»¶ å¯†ç å¤„ç†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * æ­¤é¡¹ç›®ä¸éœ€è¦md5åŠ å¯†å¤„ç†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * ä¸éœ€è¦å¼€å‘è€…è‡ªå·±è°ƒç”¨æ­¤ç±»ï¼ŒSpringSecurityæµç¨‹ä¸­è¿›è¡Œå¯†ç æ¯”è¾ƒæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/23 22:25</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Component  // å¿…é¡»æ·»åŠ åˆ°IOC ,SpringSecurityæ‰å¯ä»¥ä½¿ç”¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class CustomPasswordEncoder implements PasswordEncoder {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private StringRedisTemplate stringRedisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * å¦‚æœéœ€è¦åŠ å¯†è¿›è¡ŒåŠ å¯†æ“ä½œåè¿”å›ï¼Œè¿™é‡Œä¸éœ€è¦å¤„ç†ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * å› ä¸ºæœ¬é¡¹ç›®æ²¡æœ‰å¯¹ç”¨æˆ·å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * é‡‡ç”¨çš„æ˜¯æ‰‹æœºå·+éªŒè¯ç çš„æ–¹å¼è¿›è¡Œç™»å½•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * éªŒè¯ç å­˜åœ¨redisä¸­ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œç‰¹å®šæ­¤æ¡éªŒè¯ç æ°¸ä¸è¿‡æœŸï¼Œå½“ä½œå¯†ç ä½¿ç”¨ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param rawPassword  æ˜æ–‡  ç”¨æˆ·è¾“å…¥çš„å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return  å¯†æ–‡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public String encode(CharSequence rawPassword) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return rawPassword.toString();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param rawPassword  ç”¨æˆ·è¾“å…¥çš„å¯†ç   å³4ä½éªŒè¯ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encodedPassword  ä»redisä¸­æŸ¥è¯¢å‡ºæ¥çš„éªŒè¯ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return boolean</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public boolean matches(CharSequence rawPassword, String encodedPassword) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å†™æ­»</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        encodedPassword = stringRedisTemplate.opsForValue().get("13243922402");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encodedPassword.equals(encode(encodedPassword));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…ˆæ¥çœ‹çœ‹æ•´ä¸ªè®¤è¯çš„æµç¨‹å›¾ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20230216133620298" src="https://jachen99.github.io/assets/images/image-20230216133620298-5f63300eb8e0aa01307e67ad37ce956b.png" width="1067" height="650" class="img_ev3q"></p>
<p><em>ç°åœ¨ï¼Œè™½ç„¶å·²ç»å®ç°äº†å¯¹çœŸå®æ•°æ®åº“çš„è®¿é—®ï¼Œä½†æ˜¯è¿˜æ˜¯ä½¿ç”¨è‡ªå¸¦çš„ç™»å½•é¡µé¢ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½é€šè¿‡å‰ç«¯é¡¹ç›®çš„çœŸå®çš„ç”¨æˆ·ç™»å½•é¡µé¢è®¿é—®å‘¢ï¼Ÿ</em></p>
<p>ç™»å½•æˆåŠŸåï¼Œæ¯æ¬¡è®¿é—®å…¶ä»–èµ„æºéƒ½è¦åˆ¤æ–­ä¸€ä¸‹tokenæ˜¯å¦æ­£ç¡®,å¦‚æœæ­£ç¡®æ‰èƒ½è®¿é—®ï¼Œå¦‚æœä¸æ­£ç¡®è¿”å›å¼‚å¸¸ä¿¡æ¯ã€‚</p>
<p>4ã€è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯æ¥å£ï¼ˆè¿‡æ»¤å™¨1ï¼‰</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// ä¸ç”¨åŠ Componentæ³¨è§£ ä¸éœ€è¦åŠ å…¥IOC  è¿‡æ»¤å™¨ç”±tomcatè¿›è¡Œç®¡ç† </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.security.filter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/23 22:45</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.data.redis.core.RedisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.authentication.AuthenticationManager;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.Authentication;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.AuthenticationException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.web.util.matcher.AntPathRequestMatcher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.result.JsonData;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.result.ResultCodeEnum;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.utils.JwtHelper;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.utils.ResponseUtil;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.security.custom.CustomUser;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.vo.user.LoginVo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.annotation.Resource;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.FilterChain;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.ServletException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.http.HttpServletRequest;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.http.HttpServletResponse;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * &lt;p&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * ç™»å½•è¿‡æ»¤å™¨ï¼Œç»§æ‰¿UsernamePasswordAuthenticationFilterï¼Œå¯¹ç”¨æˆ·åå¯†ç è¿›è¡Œç™»å½•æ ¡éªŒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * &lt;/p&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TokenLoginFilter extends UsernamePasswordAuthenticationFilter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Resource</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private RedisTemplate redisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public TokenLoginFilter(AuthenticationManager authenticationManager,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                            RedisTemplate redisTemplate ) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //è®¾ç½®è®¤è¯ç®¡ç†å™¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.setAuthenticationManager(authenticationManager);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //è®¾ç½®ç™»å½•çš„åœ°å€å’Œè¯·æ±‚æ–¹å¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.setRequiresAuthenticationRequestMatcher(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                new AntPathRequestMatcher("/yygh/user/loginSecurity", "POST"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.redisTemplate = redisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * ç™»å½•è®¤è¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * èµ°è¿™ä¸ªç™»å½•è®¤è¯æµç¨‹ ä¸èµ°åŸå…ˆçš„ç™»å½•æ¥å£äº†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param req</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param res</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @throws AuthenticationException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Authentication attemptAuthentication(HttpServletRequest req, HttpServletResponse res)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            throws AuthenticationException {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // è·å–ç”¨æˆ·åçš„æ–¹æ³•  ç®€å•å°è£…æ–¹æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            LoginVo loginVo = new ObjectMapper().readValue(req.getInputStream(), LoginVo.class);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            String pwd = (String) redisTemplate.opsForValue().get(loginVo.getPhone());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // å°†ç”¨æˆ·åå’Œå¯†ç å°è£…åˆ°Authentication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Authentication authenticationToken =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    new UsernamePasswordAuthenticationToken(loginVo.getPhone(), pwd);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // è°ƒå–getAuthenticationManagerè®¤è¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return this.getAuthenticationManager().authenticate(authenticationToken);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * ç™»å½•æˆåŠŸ è®¤è¯æˆåŠŸè°ƒç”¨çš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param response</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param chain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param auth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @throws IOException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @throws ServletException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected void successfulAuthentication(HttpServletRequest request, HttpServletResponse response, FilterChain chain,Authentication auth) throws IOException, ServletException {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 1ã€é€šè¿‡Authenticationè·å–è®¤è¯çš„å¯¹è±¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        CustomUser customUser = (CustomUser) auth.getPrincipal();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 2ã€é€šè¿‡JwtHelperç”Ÿæˆtoken</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String token = JwtHelper.createToken(Long.parseLong(customUser.getLoginVo().getOpenid()), customUser.getLoginVo().getPhone());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 3ã€è·å–ç”¨æˆ·çš„æƒé™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // Collection&lt;GrantedAuthority&gt; authorities = customUser.getAuthorities();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 4ã€å°†æƒé™ä¿å­˜åˆ°Redisä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // redisTemplate.boundValueOps(customUser.getUsername()).set(authorities);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 5ã€ä¿å­˜ç™»å½•æ—¥å¿—</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // loginLogService.recordLoginLog(customUser.getUsername(), IpUtil.getIpAddress(request),1,"ç™»å½•æˆåŠŸ");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åˆ›å»ºä¸€ä¸ªMap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        map.put("token", token);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 6ã€é€šè¿‡ResponseUtilå·¥å…·ç±»å“åº”åˆ°å‰ç«¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ResponseUtil.out(response, JsonData.ok(map));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * ç™»å½•å¤±è´¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param response</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @throws IOException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @throws ServletException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException e) throws IOException, ServletException {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (e.getCause() instanceof RuntimeException){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ResponseUtil.out(response, JsonData.build(null,204,e.getMessage()));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ResponseUtil.out(response,JsonData.build(null, ResultCodeEnum.LOGIN_MOBLE_ERROR));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// å¦‚æœæƒ³åœ¨é‡Œé¢åŠ å…¥@Autowired  åˆ™éœ€è¦æ·»åŠ é…ç½®ç±»</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.security.config;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.context.annotation.Configuration;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.data.redis.core.RedisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.config.annotation.web.builders.WebSecurity;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.config.http.SessionCreationPolicy;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.security.filter.TokenLoginFilter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.annotation.Resource;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/23 22:24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@EnableWebSecurity //@EnableWebSecurityæ˜¯å¼€å¯SpringSecurityçš„é»˜è®¤è¡Œä¸º</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@EnableGlobalMethodSecurity(prePostEnabled = true)//å¼€å¯æ³¨è§£åŠŸèƒ½ï¼Œé»˜è®¤ç¦ç”¨æ³¨è§£</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class WebSecurityConfig extends WebSecurityConfigurerAdapter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Resource</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private RedisTemplate redisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected void configure(HttpSecurity http) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è¿™æ˜¯é…ç½®çš„å…³é”®ï¼Œå†³å®šå“ªäº›æ¥å£å¼€å¯é˜²æŠ¤ï¼Œå“ªäº›æ¥å£ç»•è¿‡é˜²æŠ¤</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        http</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //å…³é—­csrf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .csrf().disable()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // å¼€å¯è·¨åŸŸä»¥ä¾¿å‰ç«¯è°ƒç”¨æ¥å£</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .cors().and()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .authorizeRequests()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // æŒ‡å®šæŸäº›æ¥å£ä¸éœ€è¦é€šè¿‡éªŒè¯å³å¯è®¿é—®ã€‚ç™»é™†æ¥å£è‚¯å®šæ˜¯ä¸éœ€è¦è®¤è¯çš„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .antMatchers("/yygh/user/login").permitAll()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // è¿™é‡Œæ„æ€æ˜¯å…¶å®ƒæ‰€æœ‰æ¥å£éœ€è¦è®¤è¯æ‰èƒ½è®¿é—®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .anyRequest().authenticated()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .and()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //TokenAuthenticationFilteræ”¾åˆ°UsernamePasswordAuthenticationFilterçš„å‰é¢ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // è¿™æ ·åšå°±æ˜¯ä¸ºäº†é™¤äº†ç™»å½•çš„æ—¶å€™å»æŸ¥è¯¢æ•°æ®åº“å¤–ï¼Œå…¶ä»–æ—¶å€™éƒ½ç”¨tokenè¿›è¡Œè®¤è¯ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//                .addFilterBefore(new TokenAuthenticationFilter(redisTemplate), UsernamePasswordAuthenticationFilter.class)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .addFilter(new TokenLoginFilter(authenticationManager(), redisTemplate));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //ç¦ç”¨session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * é…ç½®å“ªäº›è¯·æ±‚ä¸æ‹¦æˆª</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * æ’é™¤swaggerç›¸å…³è¯·æ±‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param web</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void configure(WebSecurity web) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        web.ignoring().antMatchers("/favicon.ico","/swagger-resources/**", "/webjars/**", "/v2/**", "/swagger-ui.html/**", "/doc.html");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>5ã€é…ç½®ç”¨æˆ·è®¤è¯ ï¼ˆè¿‡æ»¤å™¨2ï¼‰</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.yygh.security.filter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/23 23:04</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.data.redis.core.RedisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.GrantedAuthority;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.security.core.context.SecurityContextHolder;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.util.StringUtils;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.springframework.web.filter.OncePerRequestFilter;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.result.JsonData;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.result.ResultCodeEnum;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.utils.JwtHelper;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import space.jachen.yygh.common.utils.ResponseUtil;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.annotation.Resource;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.FilterChain;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.ServletException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.http.HttpServletRequest;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import javax.servlet.http.HttpServletResponse;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Collection;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * &lt;p&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * è®¤è¯è§£ætokenè¿‡æ»¤å™¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * &lt;/p&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TokenAuthenticationFilter extends OncePerRequestFilter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Resource</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private RedisTemplate redisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public TokenAuthenticationFilter(RedisTemplate redisTemplate) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.redisTemplate = redisTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain)throws IOException, ServletException {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger.info("è®¤è¯è§£ætokenè¿‡æ»¤å™¨çš„url:"+request.getRequestURI());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //å¦‚æœæ˜¯ç™»å½•æ¥å£ï¼Œç›´æ¥æ”¾è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if("/yygh/user/login".equals(request.getRequestURI())) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            chain.doFilter(request, response);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        UsernamePasswordAuthenticationToken authentication = getAuthentication(request);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if(null != authentication) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SecurityContextHolder.getContext().setAuthentication(authentication);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //æ”¾è¡Œè¯·æ±‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            chain.doFilter(request, response);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ResponseUtil.out(response, JsonData.build(null, ResultCodeEnum.PERMISSION));//209  æ²¡æœ‰æƒé™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private UsernamePasswordAuthenticationToken getAuthentication(HttpServletRequest request) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // tokenç½®äºheaderé‡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String token = request.getHeader("token");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger.info("token:"+token);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (!StringUtils.isEmpty(token)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            String username = JwtHelper.getUserName(token);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            logger.info("username:"+username);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (!StringUtils.isEmpty(username)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //ä»Redisä¸­è·å–æƒé™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Collection&lt;GrantedAuthority&gt; authorities = (Collection&lt;GrantedAuthority&gt;) redisTemplate.boundValueOps(username).get();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return new UsernamePasswordAuthenticationToken(username, null, authorities);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //è¿”å›ä¸€ä¸ªè®¤è¯å¯¹è±¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //return new UsernamePasswordAuthenticationToken(username, null, Collections.emptyList());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç°åœ¨å°±å¯ä»¥é€šè¿‡swaggeræµ‹è¯•ç™»å½•äº†ã€‚</p>]]></content:encoded>
            <category>Spring Security</category>
        </item>
        <item>
            <title><![CDATA[SQLä¼˜åŒ–ç§¯ç´¯ç¬”è®°]]></title>
            <link>https://jachen99.github.io/blog/product-management-system</link>
            <guid>https://jachen99.github.io/blog/product-management-system</guid>
            <pubDate>Thu, 02 Mar 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šå› ä¸ºæ—¥å¸¸å·¥ä½œå’Œå­¦ä¹ ä¸­éš¾å…ä¼šä¸æ•°æ®åº“æ‰“äº¤é“ï¼Œå…¶ä¸­å¦‚ä½•å¿«é€Ÿçš„ä»åºå¤§çš„æ•°æ®åº“ä¸­ç²¾å‡†çš„æŸ¥æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ä¸€ç›´æ˜¯å¾ˆçƒ­çš„è¯é¢˜ï¼Œæ‰€ä»¥å†™ä¸‹æ­¤ç¯‡ç¬”è®°ï¼Œäº¦åœ¨ä¸æ–­åœ°ç§¯ç´¯æœ‰å…³æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–æ–¹é¢çš„ç»éªŒï¼Œä»è€Œèƒ½é«˜æ•ˆçš„ä½¿æ•°æ®ä¼ é€’ç»™å¤–ç•Œï¼Œç»™ç”¨æˆ·æ›´å¥½çš„ä½“éªŒï¼Œè¿™ç¯‡æ–‡ç« ä¼šä¸€ç›´æ›´æ–°ä¸‹å»ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>å› ä¸ºæ—¥å¸¸å·¥ä½œå’Œå­¦ä¹ ä¸­éš¾å…ä¼šä¸æ•°æ®åº“æ‰“äº¤é“ï¼Œå…¶ä¸­å¦‚ä½•å¿«é€Ÿçš„ä»åºå¤§çš„æ•°æ®åº“ä¸­ç²¾å‡†çš„æŸ¥æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ä¸€ç›´æ˜¯å¾ˆçƒ­çš„è¯é¢˜ï¼Œæ‰€ä»¥å†™ä¸‹æ­¤ç¯‡ç¬”è®°ï¼Œäº¦åœ¨ä¸æ–­åœ°ç§¯ç´¯æœ‰å…³æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–æ–¹é¢çš„ç»éªŒï¼Œä»è€Œèƒ½é«˜æ•ˆçš„ä½¿æ•°æ®ä¼ é€’ç»™å¤–ç•Œï¼Œç»™ç”¨æˆ·æ›´å¥½çš„ä½“éªŒï¼Œè¿™ç¯‡æ–‡ç« ä¼šä¸€ç›´æ›´æ–°ä¸‹å»</em>ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="orä¸unionçš„æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒ">orä¸unionçš„æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒ<a href="https://jachen99.github.io/blog/product-management-system#or%E4%B8%8Eunion%E7%9A%84%E6%89%A7%E8%A1%8C%E6%95%88%E7%8E%87%E6%AF%94%E8%BE%83" class="hash-link" aria-label="orä¸unionçš„æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒçš„ç›´æ¥é“¾æ¥" title="orä¸unionçš„æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>stackoverflowé“¾æ¥: <a href="https://leetcode.cn/link/?target=https://stackoverflow.com/questions/13750475/sql-performance-union-vs-or%EF%BC%89" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/13750475/sql-performance-union-vs-orï¼‰</a></p>
<p>å½“SQLè¯­å¥æœ‰å¤šä¸ªorè¯­å¥æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨unionæˆ–è€…union allä»£æ›¿æ¥æé«˜é€Ÿåº¦ã€‚ä½¿ç”¨orçš„SQLè¯­å¥å¾€å¾€æ— æ³•è¿›è¡Œä¼˜åŒ–ï¼Œå¯¼è‡´é€Ÿåº¦å˜æ…¢ã€‚ä½†è¿™ä¸æ˜¯å›ºå®šçš„ï¼Œæœ‰æ—¶å€™ä½¿ç”¨oré€Ÿåº¦ä¼šæ›´å¿«äº›ã€‚å…·ä½“æƒ…å†µè¿˜è¦ç»è¿‡æµ‹è¯•ä¸ºå‡†ã€‚å¦‚æœåŠ ç´¢å¼•çš„è¯ï¼Œä¹Ÿå¯èƒ½å®ç°é€Ÿåº¦ä¼˜åŒ–ã€‚</p>
<p>å®éªŒè¡¨æ ¼å¦‚ä¸‹,å®é™…æ•°æ®æœ‰2,000,000æ¡ï¼Œä»é‡Œé¢è¿”å›å¤§çº¦æœ€å¤š1000è¡Œå·¦å³çš„æ•°æ®ã€‚</p>
<table><thead><tr><th>X</th><th>Y</th><th>Inline</th><th>CDP</th><th>T</th></tr></thead><tbody><tr><td>12002400</td><td>5801000</td><td>300</td><td>300</td><td>3400</td></tr><tr><td>12002408</td><td>5801005</td><td>300</td><td>301</td><td>3402</td></tr><tr><td>12002416</td><td>5801010</td><td>300</td><td>302</td><td>3404</td></tr><tr><td>12002424</td><td>5801015</td><td>300</td><td>303</td><td>3406</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr></tbody></table>
<p>orè¯­å¥ï¼ˆéƒ¨åˆ†èŠ‚é€‰ï¼‰</p>
<p>SELECT * FROM tablename where (cdp= 300 and inline=301) or (cdp= 301 and inline=301) or (cdp= 302 and inline=301) or (cdp= 303 and inline=301) or (cdp= 304 and inline=301) or (cdp= 305 and inline=301) or (cdp= 306 and inline=301) or (cdp= 307 and inline=301)</p>
<p>union allè¯­å¥ï¼ˆéƒ¨åˆ†èŠ‚é€‰ï¼‰</p>
<p>SELECT * FROM tablename where (inline= 300 and cdp=300) union all SELECT * FROM tablename where (inline= 301 and cdp=300) union all SELECT * FROM tablename where (inline= 302 and cdp=300) union all SELECT * FROM tablename where (inline= 303 and cdp=300)
è¿”å›ä¸è§„åˆ™çš„900æ¡æ•°æ®ï¼Œå‰è€…ç”¨äº†60å¤šç§’ï¼Œåè€…ç”¨äº†8ç§’å·¦å³ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<ol>
<li>Unionï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œä¸åŒ…æ‹¬é‡å¤è¡Œï¼ŒåŒæ—¶è¿›è¡Œé»˜è®¤è§„åˆ™çš„æ’åºï¼› å³ï¼šå»é‡+æ’åº</li>
<li>Union Allï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼ŒåŒ…æ‹¬é‡å¤è¡Œï¼Œä¸è¿›è¡Œæ’åºï¼› å³ï¼šä¸å»é‡+ä¸æ’åº</li>
<li>å¯¹äºå•åˆ—æ¥è¯´ï¼Œç”¨oræ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œä½†æ˜¯oræ¶‰åŠåˆ°å¤šä¸ªåˆ—çš„æ—¶å€™ï¼Œæ¯æ¬¡selectåªèƒ½é€‰å–ä¸€ä¸ªindexï¼Œå¦‚æœé€‰æ‹©äº†areaï¼Œpopulationå°±éœ€è¦è¿›è¡Œtable-scanï¼Œå³å…¨éƒ¨æ‰«æä¸€éï¼Œä½†æ˜¯ä½¿ç”¨unionå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåˆ†åˆ«ä½¿ç”¨areaå’Œpopulationä¸Šé¢çš„indexè¿›è¡ŒæŸ¥è¯¢ã€‚ ä½†æ˜¯è¿™é‡Œè¿˜ä¼šæœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼ŒUNIONä¼šå¯¹ç»“æœè¿›è¡Œæ’åºå»é‡ï¼Œå¯èƒ½ä¼šé™ä½ä¸€äº›performance(è¿™æœ‰å¯èƒ½æ˜¯æ–¹æ³•ä¸€æ¯”æ–¹æ³•äºŒå¿«çš„åŸå› ï¼‰ï¼Œæ‰€ä»¥æœ€ä½³çš„é€‰æ‹©åº”è¯¥æ˜¯ä¸¤ç§æ–¹æ³•éƒ½è¿›è¡Œå°è¯•æ¯”è¾ƒã€‚</li>
</ol>
<p>2023/02/09</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="shellè„šæœ¬æ‰¹é‡æ’å…¥mockæ•°æ®">shellè„šæœ¬æ‰¹é‡æ’å…¥mockæ•°æ®<a href="https://jachen99.github.io/blog/product-management-system#shell%E8%84%9A%E6%9C%AC%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5mock%E6%95%B0%E6%8D%AE" class="hash-link" aria-label="shellè„šæœ¬æ‰¹é‡æ’å…¥mockæ•°æ®çš„ç›´æ¥é“¾æ¥" title="shellè„šæœ¬æ‰¹é‡æ’å…¥mockæ•°æ®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>shellè„šæœ¬</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo "è¯·è¾“å…¥å­—æ®µservnumberçš„å€¼ï¼š"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">read serber</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo "è¯·è¾“å…¥åˆ›å»ºsqlè¯­å¥çš„æ•°é‡ï¼š"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">read number</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># char=`head /dev/urandom | tr -dc 0-9 | head -c 11`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">for (( i=0;i&lt;$number;i++ ))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        do</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pass=`head /dev/urandom | tr -dc a-z | head -c 8`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        let serber=serber+1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        echo "insert into test(id,username,servnumber,password,createtime) values('$i','user${i}','${serber}','$pass',now());" &gt;&gt;sql1.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°½é‡é¿å…ä½¿ç”¨select *from ï¼Œå°½é‡ç²¾ç¡®åˆ°æƒ³è¦çš„ç»“æœå­—æ®µã€‚
å°½é‡é¿å…æ¡ä»¶ä½¿ç”¨orã€‚
è®°å¾—åŠ ä¸Šlimit é™åˆ¶è¡Œæ•°ï¼Œé¿å…æ•°æ®é‡è¿‡å¤§æ¶ˆè€—æ€§èƒ½ã€‚
ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢æ—¶ï¼Œ%æ”¾åœ¨å‰é¢æ˜¯ä¼šä½¿ç´¢å¼•å¤±æ•ˆã€‚
è¦å°å¿ƒæ¡ä»¶å­—æ®µç±»å‹çš„è½¬æ¢ã€‚</p>
<p>2023/02/11</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="çº¿ä¸Šè°ƒä¼˜-æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®">çº¿ä¸Šè°ƒä¼˜-æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®<a href="https://jachen99.github.io/blog/product-management-system#%E7%BA%BF%E4%B8%8A%E8%B0%83%E4%BC%98-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="çº¿ä¸Šè°ƒä¼˜-æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®çš„ç›´æ¥é“¾æ¥" title="çº¿ä¸Šè°ƒä¼˜-æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æœ€å¥½ nginxiè®¿é—®æ—¥å¿—ï¼Œæµé‡é‡æ”¾åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼›è¿«ä¸å¾—å·²å†çº¿ä¸Šè°ƒ</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹æ˜¯å¦å·²ç»å¼€å¯äº†æ…¢æŸ¥è¯¢æ—¥å¿—</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; show variables like 'slow%';</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------------+--------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Variable_name       | Value                                |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------------+--------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| slow_launch_time    | 2                                    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| slow_query_log      | OFF                                  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| slow_query_log_file | /data/mydata/jachen-public-slow.log |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------------+--------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¬¬äºŒæ­¥ï¼šå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">set global slow_query_log = on ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ—¥å¿—è·¯å¾„ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">set global slow_query_log_file = 'è·¯å¾„';</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹æ…¢æŸ¥è¯¢çš„æ—¶é—´ä¸´ç•Œå€¼</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">show variables like '%long%';</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¬¬å››æ­¥ï¼šè®¾ç½®æ…¢æŸ¥è¯¢çš„æ—¶é—´æ ‡å‡†</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">set long_query_time=0.4;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>æ³¨æ„ï¼šå‡å¦‚è¿è¡Œæ—¶é—´æ­£å¥½ç­‰äºlong_query_timeçš„æƒ…å†µï¼Œå¹¶ä¸ä¼šè¢«è®°å½•ä¸‹æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨mysqlæºç é‡Œæ˜¯åˆ¤æ–­å¤§äºlong_query_timeï¼Œè€Œéå¤§äºç­‰äºã€‚</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ°¸ä¹…ç”Ÿæ•ˆçš„è®¾ç½®æ–¹æ³•ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ vi /etc/my.cnf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[mysqld]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slow_query_log = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">long_query_time = 0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slow_query_log_file =/usr/local/mysql/mysql_slow.log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æœ€åé‡æ–°è¿æ¥æ‰èƒ½ç”Ÿæ•ˆï¼Œä¸å¿…é‡å¯æœåŠ¡å™¨ï¼</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>æ‰§è¡Œè€—æ—¶sqlï¼š</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT * FROM emp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT * FROM emp WHERE deptid &gt; 1;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>æŸ¥è¯¢æ…¢æŸ¥è¯¢è®°å½•æ•°ï¼š</strong></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SHOW</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GLOBAL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">STATUS</span><span class="token plain"> </span><span class="token operator">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">'%Slow_queries%'</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>æŸ¥è¯¢æ—¥å¿—ï¼š</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim /var/lib/mysql/bogon-slow.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>mysqldumpslowåˆ†æå·¥å…·ï¼š</strong></p>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¦‚æœè¦æ‰‹å·¥åˆ†ææ—¥å¿—ï¼ŒæŸ¥æ‰¾ã€åˆ†æSQLï¼Œæ˜¾ç„¶æ˜¯ä¸ªä½“åŠ›æ´»ï¼ŒMySQLæä¾›äº†æ—¥å¿—åˆ†æå·¥å…·mysqldumpslowã€‚é€€å‡ºmysqlå‘½ä»¤è¡Œï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">-- æŸ¥çœ‹mysqldumpslowçš„å¸®åŠ©ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysqldumpslow </span><span class="token comment" style="color:rgb(98, 114, 164)">--help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- å·¥ä½œå¸¸ç”¨å‚è€ƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- 1.å¾—åˆ°è¿”å›è®°å½•é›†æœ€å¤šçš„10ä¸ªSQL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysqldumpslow </span><span class="token operator">-</span><span class="token plain">s r </span><span class="token operator">-</span><span class="token plain">t </span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">var</span><span class="token operator">/</span><span class="token plain">lib</span><span class="token operator">/</span><span class="token plain">mysql</span><span class="token operator">/</span><span class="token plain">bogon</span><span class="token operator">-</span><span class="token plain">slow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- 2.å¾—åˆ°è®¿é—®æ¬¡æ•°æœ€å¤šçš„10ä¸ªSQL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysqldumpslow </span><span class="token operator">-</span><span class="token plain">s c </span><span class="token operator">-</span><span class="token plain">t </span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">var</span><span class="token operator">/</span><span class="token plain">lib</span><span class="token operator">/</span><span class="token plain">mysql</span><span class="token operator">/</span><span class="token plain">bogon</span><span class="token operator">-</span><span class="token plain">slow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- 3.å¾—åˆ°æŒ‰ç…§æ—¶é—´æ’åºçš„å‰10æ¡é‡Œé¢å«æœ‰å·¦è¿æ¥çš„æŸ¥è¯¢è¯­å¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysqldumpslow </span><span class="token operator">-</span><span class="token plain">s t </span><span class="token operator">-</span><span class="token plain">t </span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">-</span><span class="token plain">g </span><span class="token string" style="color:rgb(255, 121, 198)">"left join"</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">var</span><span class="token operator">/</span><span class="token plain">lib</span><span class="token operator">/</span><span class="token plain">mysql</span><span class="token operator">/</span><span class="token plain">bogon</span><span class="token operator">-</span><span class="token plain">slow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- 4.å¦å¤–å»ºè®®åœ¨ä½¿ç”¨è¿™äº›å‘½ä»¤æ—¶ç»“åˆ | å’Œmore ä½¿ç”¨ ï¼Œå¦åˆ™æœ‰å¯èƒ½å‡ºç°çˆ†å±æƒ…å†µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysqldumpslow </span><span class="token operator">-</span><span class="token plain">s r </span><span class="token operator">-</span><span class="token plain">t </span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">var</span><span class="token operator">/</span><span class="token plain">lib</span><span class="token operator">/</span><span class="token plain">mysql</span><span class="token operator">/</span><span class="token plain">bogon</span><span class="token operator">-</span><span class="token plain">slow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log </span><span class="token operator">|</span><span class="token plain"> more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>-a: å°†æ•°å­—æŠ½è±¡æˆNï¼Œå­—ç¬¦ä¸²æŠ½è±¡æˆS</p>
</li>
<li>
<p>-s: æ˜¯è¡¨ç¤ºæŒ‰ç…§ä½•ç§æ–¹å¼æ’åº</p>
</li>
<li>
<ul>
<li>c: è®¿é—®æ¬¡æ•°<!-- -->
<ul>
<li>l: é”å®šæ—¶é—´</li>
<li>r: è¿”å›è®°å½•</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>t: æŸ¥è¯¢æ—¶é—´</li>
<li>al:å¹³å‡é”å®šæ—¶é—´</li>
<li>ar:å¹³å‡è¿”å›è®°å½•æ•°</li>
<li>at:å¹³å‡æŸ¥è¯¢æ—¶é—´</li>
</ul>
</li>
<li>
<p>-t: å³ä¸ºè¿”å›å‰é¢å¤šå°‘æ¡çš„æ•°æ®</p>
</li>
<li>
<p>-g: åè¾¹æ­é…ä¸€ä¸ªæ­£åˆ™åŒ¹é…æ¨¡å¼ï¼Œå¤§å°å†™ä¸æ•æ„Ÿçš„</p>
</li>
</ul>
<p>2023/02/15</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sqlè¯­å¥æ‰§è¡Œè¿‡ç¨‹è§£æ">sqlè¯­å¥æ‰§è¡Œè¿‡ç¨‹è§£æ<a href="https://jachen99.github.io/blog/product-management-system#sql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90" class="hash-link" aria-label="sqlè¯­å¥æ‰§è¡Œè¿‡ç¨‹è§£æçš„ç›´æ¥é“¾æ¥" title="sqlè¯­å¥æ‰§è¡Œè¿‡ç¨‹è§£æçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="image-20230223160243626" src="https://jachen99.github.io/assets/images/image-20230223160243626-852c258d2994473f82bad8ae86bcd5df.png" width="1081" height="132" class="img_ev3q"></p>
<p>ä»‹ç»å¦‚ä½•å¼€å¯æ€§èƒ½è¯¦æƒ…</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹æ€§èƒ½è¯¦æƒ…æ˜¯å¦å¼€å¯</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; show variables like '%profiling%';</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------------------+-------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Variable_name          | Value |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------------------+-------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| have_profiling         | YES   |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| profiling              | OFF   |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| profiling_history_size | 15    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------------------+-------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¬¬äºŒæ­¥ï¼šå¼€å¯æ€§èƒ½è®°å½•åŠŸèƒ½</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">set profiling = on ;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹æ€§èƒ½çš„è®°å½•</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; show profiles;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------+------------+---------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Query_ID | Duration   | Query                                             |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------+------------+---------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|        1 | 0.00177775 | show variables like '%profiling%'                 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|        2 | 0.00037900 | select * from test where id='087878'              |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|        3 | 0.34618025 | select * from test where servnumber='1367008787'  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|        4 | 0.31986825 | select * from test where servnumber='13670087879' |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------+------------+---------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¬¬å››æ­¥ï¼šæŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œæ€§èƒ½è¯¦æƒ…</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; show profile for query 4;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------------------+----------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Status               | Duration |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------------------+----------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| starting             | 0.000100 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| checking permissions | 0.000010 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Opening tables       | 0.000023 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| init                 | 0.000045 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| System lock          | 0.000015 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| optimizing           | 0.000016 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| statistics           | 0.000028 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| preparing            | 0.000020 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| executing            | 0.000006 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Sending data         | 0.319489 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| end                  | 0.000037 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| query end            | 0.000012 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| closing tables       | 0.000012 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| freeing items        | 0.000040 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| cleaning up          | 0.000017 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------------------+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>æ€§èƒ½çº¿ç¨‹çš„è¯¦ç»†è§£é‡Šå®˜æ–¹æ–‡æ¡£é“¾æ¥</em>ï¼š<a href="https://dev.mysql.com/doc/refman/5.7/en/general-thread-states.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/5.7/en/general-thread-states.html</a></p>
<p>2023/02/16</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="è®¾è®¡è¡¨çš„nullå€¼é—®é¢˜">è®¾è®¡è¡¨çš„NULLå€¼é—®é¢˜<a href="https://jachen99.github.io/blog/product-management-system#%E8%AE%BE%E8%AE%A1%E8%A1%A8%E7%9A%84null%E5%80%BC%E9%97%AE%E9%A2%98" class="hash-link" aria-label="è®¾è®¡è¡¨çš„NULLå€¼é—®é¢˜çš„ç›´æ¥é“¾æ¥" title="è®¾è®¡è¡¨çš„NULLå€¼é—®é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>1ã€å­—æ®µä¸æ·»åŠ null  éƒ½æ˜¯not nullï¼Œé»˜è®¤å€¼</p>
<p><img decoding="async" loading="lazy" alt="image-20230222093720407" src="https://jachen99.github.io/assets/images/image-20230222093720407-7ffbef4dda48f5ec8896c86307b97bf1.png" width="960" height="93" class="img_ev3q"></p>
<p>2ã€æŠŠå­—æ®µéƒ½è®¾ç½®ä¸ºnot null ï¼Œæ·»åŠ ç‰¹æ®Šå­—æ®µï¼ŒæŠŠæ•°æ®å­˜å‚¨jä¸ºJSONæ ¼å¼  </p>
<p>2023/02/18</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å…³è”æŸ¥è¯¢ä¼˜åŒ–">å…³è”æŸ¥è¯¢ä¼˜åŒ–<a href="https://jachen99.github.io/blog/product-management-system#%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96" class="hash-link" aria-label="å…³è”æŸ¥è¯¢ä¼˜åŒ–çš„ç›´æ¥é“¾æ¥" title="å…³è”æŸ¥è¯¢ä¼˜åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>1ã€ä¿è¯è¢«é©±åŠ¨è¡¨çš„JOINå­—æ®µå·²ç»åˆ›å»ºäº†ç´¢å¼•
2ã€éœ€è¦JOIN çš„å­—æ®µï¼Œæ•°æ®ç±»å‹ä¿æŒç»å¯¹ä¸€è‡´ã€‚
3ã€LEFT JOIN æ—¶ï¼Œé€‰æ‹©å°è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼Œå¤§è¡¨ä½œä¸ºè¢«é©±åŠ¨è¡¨ ã€‚å‡å°‘å¤–å±‚å¾ªç¯çš„æ¬¡æ•°ã€‚
4ã€INNER JOIN æ—¶ï¼ŒMySQLä¼šè‡ªåŠ¨å°†å°ç»“æœé›†çš„è¡¨é€‰ä¸ºé©±åŠ¨è¡¨ ã€‚é€‰æ‹©ç›¸ä¿¡MySQLä¼˜åŒ–ç­–ç•¥ã€‚
5ã€èƒ½å¤Ÿç›´æ¥å¤šè¡¨å…³è”çš„å°½é‡ç›´æ¥å…³è”ï¼Œä¸ç”¨å­æŸ¥è¯¢ã€‚(å‡å°‘æŸ¥è¯¢çš„è¶Ÿæ•°)
6ã€ä¸å»ºè®®ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå»ºè®®å°†å­æŸ¥è¯¢SQLæ‹†å¼€ç»“åˆç¨‹åºå¤šæ¬¡æŸ¥è¯¢ï¼Œæˆ–ä½¿ç”¨ JOIN æ¥ä»£æ›¿å­æŸ¥è¯¢ã€‚
7ã€è¡ç”Ÿè¡¨å»ºä¸äº†ç´¢å¼•</p>
<p>2023/02/19</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å­æŸ¥è¯¢ä¼˜åŒ–">å­æŸ¥è¯¢ä¼˜åŒ–<a href="https://jachen99.github.io/blog/product-management-system#%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96" class="hash-link" aria-label="å­æŸ¥è¯¢ä¼˜åŒ–çš„ç›´æ¥é“¾æ¥" title="å­æŸ¥è¯¢ä¼˜åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä½¿ç”¨è¿æ¥ï¼ˆJOINï¼‰æŸ¥è¯¢æ¥æ›¿ä»£å­æŸ¥è¯¢ã€‚**è¿æ¥æŸ¥è¯¢ä¸éœ€è¦å»ºç«‹ä¸´æ—¶è¡¨ ï¼Œå…¶é€Ÿåº¦æ¯”å­æŸ¥è¯¢ è¦å¿« ï¼Œå¦‚æœæŸ¥è¯¢ä¸­ä½¿ç”¨ç´¢å¼•çš„è¯ï¼Œæ€§èƒ½å°±ä¼šæ›´å¥½.
ä¾‹å¦‚ï¼šå°½é‡ä¸è¦ä½¿ç”¨NOT IN æˆ–è€… NOT EXISTSï¼Œç”¨LEFT JOIN xxx ON xx WHERE xx IS NULLæ›¿ä»£</p>
<p>2023/02/22</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ•°æ®åº“è¡¨è®¾è®¡">æ•°æ®åº“è¡¨è®¾è®¡<a href="https://jachen99.github.io/blog/product-management-system#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1" class="hash-link" aria-label="æ•°æ®åº“è¡¨è®¾è®¡çš„ç›´æ¥é“¾æ¥" title="æ•°æ®åº“è¡¨è®¾è®¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li>å­—æ®µé•¿åº¦ï¼šèƒ½ä½¿ç”¨intå°±ä¸è¦ä½¿ç”¨varcharã€charï¼Œèƒ½ç”¨varchar(16)å°±ä¸è¦ä½¿ç”¨varchar(256)</li>
<li>å­—æ®µé€‰æ‹©ï¼šå›ºå®šé•¿åº¦çš„ç±»å‹æœ€å¥½ä½¿ç”¨char,èƒ½ä½¿ç”¨tinyintiå°±ä¸è¦ä½¿ç”¨int</li>
<li>é»˜è®¤å€¼ï¼šæœ€å¥½ç»™æ¯ä¸ªå­—æ®µä¸ªé»˜è®¤å€¼ï¼Œæœ€å¥½ä¸èƒ½ä¸ºnull,å³not null default</li>
<li>é€‚å½“ç´¢å¼•ï¼šä¸ºæ¯ä¸ªè¡¨åˆ›å»ºåˆç†çš„ç´¢å¼•ï¼Œå¦‚å”¯ä¸€ç´¢å¼•ç»„åˆç´¢å¼•çš„åœºæ™¯ä»¥åŠæ™®é€šç´¢å¼•çš„åœºæ™¯</li>
</ul>
<p>2023/02/28</p>
<hr>]]></content:encoded>
            <category>æ•°æ®åº“</category>
            <category>MySQL</category>
        </item>
        <item>
            <title><![CDATA[æ·±å…¥æ¢ç©¶mysql8.xå»æ‰CachesBuffersåŸå› ]]></title>
            <link>https://jachen99.github.io/blog/mysql-CachesBuffers-reason</link>
            <guid>https://jachen99.github.io/blog/mysql-CachesBuffers-reason</guid>
            <pubDate>Mon, 20 Feb 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šæˆ‘ä»¬é€šå¸¸ç†è§£çš„mysql5.7è¿‡æ¸¡åˆ°8.0æ˜¯ç”±äºæŸ¥è¯¢ç¼“å­˜å¾ˆé¸¡è‚‹ï¼Œè¦ä¿è¯æ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ç›¸åŒçš„sqlæŸ¥è¯¢è¯­å¥ï¼Œå‘½ä¸­ç‡è‡ªç„¶ä¼šå¾ˆä½ã€‚ä½†æ˜¯çœŸçš„åªæ˜¯å› ä¸ºè¿™ä¸ªåŸå› å—ï¼Ÿé‚£ä¹ˆæˆ‘è¦æ˜¯åœ¨é«˜å¹¶å‘ä¸‹è¯·æ±‚åŒä¸€sqlçš„åœºæ™¯è¿™æ˜¾ç„¶ä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦å»æ‰è¿™å±‚ç¼“å­˜å‘¢ï¼Ÿ]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>æˆ‘ä»¬é€šå¸¸ç†è§£çš„mysql5.7è¿‡æ¸¡åˆ°8.0æ˜¯ç”±äºæŸ¥è¯¢ç¼“å­˜å¾ˆé¸¡è‚‹ï¼Œè¦ä¿è¯æ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ç›¸åŒçš„sqlæŸ¥è¯¢è¯­å¥ï¼Œå‘½ä¸­ç‡è‡ªç„¶ä¼šå¾ˆä½ã€‚ä½†æ˜¯çœŸçš„åªæ˜¯å› ä¸ºè¿™ä¸ªåŸå› å—ï¼Ÿé‚£ä¹ˆæˆ‘è¦æ˜¯åœ¨é«˜å¹¶å‘ä¸‹è¯·æ±‚åŒä¸€sqlçš„åœºæ™¯è¿™æ˜¾ç„¶ä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦å»æ‰è¿™å±‚ç¼“å­˜å‘¢ï¼Ÿ</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®˜æ–¹æè¿°">å®˜æ–¹æè¿°<a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E5%AE%98%E6%96%B9%E6%8F%8F%E8%BF%B0" class="hash-link" aria-label="å®˜æ–¹æè¿°çš„ç›´æ¥é“¾æ¥" title="å®˜æ–¹æè¿°çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>MySQL 8.0 åœ¨ç¼“å­˜æ–¹é¢ä¹Ÿè¿›è¡Œäº†ä¸€äº›æ”¹å˜ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦å˜åŒ–ï¼š</p>
<ol>
<li>è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼šMySQL 8.0 å¼•å…¥äº†è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œç”¨äºåœ¨å†…å­˜ä¸­ç¼“å­˜æŸ¥è¯¢ç»“æœã€‚è¿™ç§ç´¢å¼•å¯ä»¥æ ¹æ®æŸ¥è¯¢çš„é¢‘ç‡å’Œæ¨¡å¼è‡ªåŠ¨è°ƒæ•´å¤§å°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li>æŒä¹…åŒ–å†…å­˜å¼•æ“ï¼šMySQL 8.0 å¼•å…¥äº† InnoDB æŒä¹…åŒ–å†…å­˜å¼•æ“ï¼Œè¿™æ˜¯ä¸€ç§å°†æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­çš„å¼•æ“ã€‚ä¸ä¼ ç»Ÿçš„å†…å­˜å¼•æ“ä¸åŒï¼ŒæŒä¹…åŒ–å†…å­˜å¼•æ“å¯ä»¥å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼Œä»¥é¿å…æ•°æ®ä¸¢å¤±ã€‚</li>
<li>æ›´å¥½çš„æŸ¥è¯¢ç¼“å­˜ï¼šMySQL 8.0 å¼•å…¥äº†æ›´å¥½çš„æŸ¥è¯¢ç¼“å­˜æœºåˆ¶ï¼Œç”¨äºç¼“å­˜æŸ¥è¯¢ç»“æœã€‚ä¸ä¹‹å‰çš„ç‰ˆæœ¬ä¸åŒï¼ŒMySQL 8.0 ä¸å†ä½¿ç”¨å…¨å±€æŸ¥è¯¢ç¼“å­˜ï¼Œè€Œæ˜¯æ”¹ä¸ºä½¿ç”¨åŸºäºæŸ¥è¯¢è¯­å¥çš„ç¼“å­˜ã€‚</li>
<li>æ›´å¥½çš„å†…å­˜ç®¡ç†ï¼šMySQL 8.0 æ”¹è¿›äº†å†…å­˜ç®¡ç†ï¼Œä½¿å¾—å†…å­˜ä½¿ç”¨æ›´åŠ é«˜æ•ˆã€‚è¿™åŒ…æ‹¬æ”¹è¿›äº†å†…å­˜åˆ†é…å™¨ã€æä¾›äº†æ›´å¥½çš„å†…å­˜ç›‘æ§å’Œè­¦å‘ŠåŠŸèƒ½ç­‰ã€‚</li>
</ol>
<p>å…¶ä¸­ç¬¬ä¸‰ç‚¹æåˆ°äº† MySQL 8.0 å¼•å…¥äº†æ›´å¥½çš„æŸ¥è¯¢ç¼“å­˜æœºåˆ¶ï¼Œç”¨äºç¼“å­˜æŸ¥è¯¢ç»“æœï¼Œè¿™ä¸ä¹‹å‰çš„ç‰ˆæœ¬ä¸åŒï¼ŒMySQL 8.0 ä¸å†ä½¿ç”¨å…¨å±€æŸ¥è¯¢ç¼“å­˜ï¼Œè€Œæ˜¯æ”¹ä¸ºä½¿ç”¨åŸºäºæŸ¥è¯¢è¯­å¥çš„ç¼“å­˜ã€‚è¿™é‡Œæˆ‘ä»¬å…·ä½“å±•å¼€æ¥çœ‹çœ‹è¿™ä¸ªå˜åŒ–ã€‚</p>
<p>åœ¨ä¹‹å‰çš„ MySQL ç‰ˆæœ¬ä¸­ï¼ŒæŸ¥è¯¢ç¼“å­˜æ˜¯ä¸€ç§å¯ç”¨äºç¼“å­˜ SELECT è¯­å¥çš„ç»“æœé›†çš„æœºåˆ¶ã€‚è¿™ä¸ªæœºåˆ¶é€šè¿‡åœ¨å†…å­˜ä¸­ç¼“å­˜æŸ¥è¯¢ç»“æœé›†ï¼Œä»¥ä¾¿åœ¨ä»¥åæ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ—¶å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ç»“æœé›†ï¼Œè€Œæ— éœ€æ‰§è¡ŒæŸ¥è¯¢ã€‚è¿™ç§æœºåˆ¶å¯ä»¥å¤§å¤§æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨æœ‰å¤§é‡é‡å¤æŸ¥è¯¢çš„æƒ…å†µä¸‹ã€‚</p>
<p>ç„¶è€Œï¼ŒMySQL 8.0 ä¸­çš„æŸ¥è¯¢ç¼“å­˜ä¸ä¹‹å‰ç‰ˆæœ¬ä¸åŒï¼Œå®ƒä¸å†ä½¿ç”¨å…¨å±€æŸ¥è¯¢ç¼“å­˜ï¼Œè€Œæ˜¯æ”¹ä¸ºä½¿ç”¨åŸºäºæŸ¥è¯¢è¯­å¥çš„ç¼“å­˜ã€‚å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªæŸ¥è¯¢éƒ½ä¼šè¢«å•ç‹¬ç¼“å­˜ï¼Œå¹¶ä¸”åªæœ‰ç›¸åŒçš„æŸ¥è¯¢ï¼ˆåŒ…æ‹¬æŸ¥è¯¢è¯­å¥å’Œå‚æ•°ï¼‰æ‰èƒ½ä»ç¼“å­˜ä¸­è·å–ç»“æœé›†ã€‚è¿™ç§æœºåˆ¶å¯ä»¥é¿å…ä¹‹å‰ç‰ˆæœ¬ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚å…¨å±€æŸ¥è¯¢ç¼“å­˜é”å’Œå†…å­˜åˆ†é…é—®é¢˜ã€‚</p>
<p>å¦å¤–ï¼ŒMySQL 8.0 è¿˜æ”¯æŒå¯¹æŸ¥è¯¢ç¼“å­˜è¿›è¡Œæ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼ŒåŒ…æ‹¬å¯ä»¥å¯¹æŸäº›æŸ¥è¯¢ç¦ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢è¯­å¥ä¸­æŒ‡å®šæŸ¥è¯¢ç»“æœé›†æ˜¯å¦éœ€è¦è¢«ç¼“å­˜ç­‰ã€‚</p>
<p>è™½ç„¶ MySQL 8.0 å¼•å…¥äº†åŸºäºæŸ¥è¯¢è¯­å¥çš„ç¼“å­˜æœºåˆ¶ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢ç¼“å­˜å¹¶ä¸æ€»æ˜¯å¯¹æ€§èƒ½æœ‰ç›Šã€‚å¯¹äºä¸€äº›æŸ¥è¯¢é¢‘ç‡ä½ã€æ•°æ®æ›´æ–°é¢‘ç¹çš„æƒ…å†µï¼Œç¼“å­˜å¯èƒ½ä¼šæµªè´¹å†…å­˜ï¼Œè€Œä¸æ˜¯æé«˜æ€§èƒ½ã€‚å› æ­¤ï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥è¯„ä¼°æ˜¯å¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ¢ç©¶å»æ‰æŸ¥è¯¢ç¼“å­˜çš„åŸå› ">æ¢ç©¶å»æ‰æŸ¥è¯¢ç¼“å­˜çš„åŸå› <a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E6%8E%A2%E7%A9%B6%E5%8E%BB%E6%8E%89%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98%E7%9A%84%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="æ¢ç©¶å»æ‰æŸ¥è¯¢ç¼“å­˜çš„åŸå› çš„ç›´æ¥é“¾æ¥" title="æ¢ç©¶å»æ‰æŸ¥è¯¢ç¼“å­˜çš„åŸå› çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹mysql5.7æœåŠ¡ç«¯è·å–å®¢æˆ·ç«¯è¯·æ±‚çš„åŸºæœ¬æµç¨‹ï¼ŒæŸ¥è¯¢ç¼“å­˜æ˜¯åœ¨è§£æä¸ä¼˜åŒ–æ¨¡å—çš„å¼€å§‹ä½ç½®ï¼Œä¹Ÿå°±æ„å‘³ç€å®ƒæ˜¯ä»¥å…¨å±€æŸ¥è¯¢ç¼“å­˜å­˜åœ¨çš„ï¼Œé‚£ä¹ˆè¿™æ ·æœ‰ä»€ä¹ˆå¼Šç«¯å‘¢ï¼Ÿå®ƒèƒ½å¦ä¿è¯é«˜å¹¶å‘å†™çš„è¯»å†™ä¸€è‡´å‘¢ï¼Ÿ</p>
<p><img decoding="async" loading="lazy" alt="image-20230220191808225" src="https://jachen99.github.io/assets/images/image-20230220191808225-16977303370541-e4f464f4dacbee7a54fc6a8bfd0161ac.png" width="1597" height="1155" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç®¡ç†ç­–ç•¥å±‚é¢çš„ç¼ºå¤±">ç®¡ç†ç­–ç•¥å±‚é¢çš„ç¼ºå¤±<a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5%E5%B1%82%E9%9D%A2%E7%9A%84%E7%BC%BA%E5%A4%B1" class="hash-link" aria-label="ç®¡ç†ç­–ç•¥å±‚é¢çš„ç¼ºå¤±çš„ç›´æ¥é“¾æ¥" title="ç®¡ç†ç­–ç•¥å±‚é¢çš„ç¼ºå¤±çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨é«˜å¹¶å‘ä¸‹æŸ¥è¯¢åŒä¸€ä¸ªsqlè¯­å¥select *from user where id = 1;é‚£ä¹ˆå­˜åœ¨æŸ¥è¯¢ç¼“å­˜çš„ç¡®å¯ä»¥æé«˜æŸ¥è¯¢çš„æ•ˆç‡ï¼Œè¿™æ˜¯æˆ‘ä»¬æ™®éè®¤ä¸ºçš„æ­£å¸¸æƒ…å†µã€‚ä½†æ˜¯åœ¨ä¸æ­£å¸¸çš„æƒ…å†µä¸‹æ˜¯ä¼šå‡ºå¤§é—®é¢˜çš„ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»åœ¨å†…å­˜ä¸­çš„æ•°æ®åœ¨ç£ç›˜ä¸­è¿›è¡Œäº†updateä¿®æ”¹ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦ä½¿æˆ‘ä»¬ç¼“å­˜ä¸­çš„æ•°æ®æ›´æ–°ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œ<strong>ä½†æ˜¯åœ¨mysql5.7ä¸­ï¼Œå¯¹å†…å­˜æ˜¯æ²¡æœ‰ç®¡ç†ç­–ç•¥çš„ï¼Œå†…å­˜ä¸­æ•°æ®çš„ç”Ÿæ•ˆã€å¤±æ•ˆã€è¿‡æœŸéƒ½æ²¡æœ‰è¿›è¡Œæ ‡è®°</strong>ã€‚é‚£ä¹ˆå¦‚æœä¸èƒ½ä¿è¯ç¼“å­˜æ•°æ®çš„ä¸€è‡´æ€§å°±ä¼šæŸ¥åˆ°è„æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯åœ¨å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯ä¸‹çš„ç¨‹åºï¼Œé‚£ä¹ˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜æ˜¯ä¸å½±å“çš„ï¼Œæ€»ä¸èƒ½æ­£åœ¨ç©ç€æ¸¸æˆï¼Œä½ åœæœºæ¸¸æˆå¯¹æ•°æ®è¿›è¡Œæ›´æ–°ï¼Ÿ</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åº•å±‚æœ‰å®Œå–„çš„ç¼“å­˜æœºåˆ¶">åº•å±‚æœ‰å®Œå–„çš„ç¼“å­˜æœºåˆ¶<a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E5%BA%95%E5%B1%82%E6%9C%89%E5%AE%8C%E5%96%84%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6" class="hash-link" aria-label="åº•å±‚æœ‰å®Œå–„çš„ç¼“å­˜æœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="åº•å±‚æœ‰å®Œå–„çš„ç¼“å­˜æœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æˆ‘ä»¬çš„æ’åºï¼Œå¤§æ•°æ®é‡çš„æŸ¥æ‰¾ï¼Œorder by ï¼Œjoinæ“ä½œç­‰ï¼Œjoinæ˜¯å·¦è¡¨å»åŒ¹é…å³è¡¨ï¼Œå·¦è¡¨æ‹¿å‡ºä¸€è¡Œæ•°æ®åˆ°å³è¡¨ä¸€ä¸€å¯¹æ¯”ï¼Œè¿™ä¸ªæ¯”çš„è¿‡ç¨‹æ˜¯ç»å¯¹ä¸ä¼šä»ç£ç›˜ä¸­ä¸€ä¸€æ‹¿å‡ºæ¥æ¯”çš„ï¼Œå®ƒåº•å±‚ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜çš„ç¼“å†²åŒº<strong>buffer</strong>ä¸­ï¼Œå†è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>å¤„ç†è¿æ¥çš„ç“¶é¢ˆä¸­å¹¶å‘è¿æ¥æ•°ä¼šæœ‰é™åˆ¶ï¼Œæ¯”å¦‚500ä¸ªçº¿ç¨‹ï¼Œè™½ç„¶å®ƒä»ç¼“å­˜å†…å­˜ä¸­å–å¾ˆå¿«ï¼Œä½†æ˜¯å¯¹äºselectè¯­å¥ï¼Œåªè¦åšå¥½ä¼˜åŒ–ï¼Œæ¯”å¦‚åˆ›å»ºå¥½ç´¢å¼•ï¼Œåœ¨ç£ç›˜ä¸­å–ä¹Ÿæ˜¯ä¸æ…¢çš„ï¼Œè€Œä¸”mysqlåº•å±‚çš„ç£ç›˜æ˜¯æœ‰æœºçš„ç»„åˆçš„ï¼Œå¹¶ä¸”åœ¨é«˜é¢‘çš„è®¿é—®ä¸­ï¼Œå®ƒä¹Ÿä¼šæœ‰è¯»bufferï¼Œç”šè‡³è¿˜å­˜åœ¨å†™bufferï¼Œå¦‚æœè¯»bufferä¸­çš„æ•°æ®æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå®ƒæ¯æ¬¡ä¹Ÿæ˜¯åœ¨å†…å­˜ä¸­è¯»çš„ï¼Œä¹Ÿä¸ä¼šåœ¨ç£ç›˜ä¸­è¯»ï¼Œæ‰€ä»¥å°±æ²¡å¿…è¦å†åŠ æŸ¥è¯¢ç¼“å­˜äº†ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20230220200748912" src="https://jachen99.github.io/assets/images/image-20230220200748912-16977303462983-d6a6d16affe653b8e9f493d7d75b6282.png" width="1115" height="815" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æŸ¥è¯¢ç¼“å­˜å®¹é‡å°å­˜åœ¨ç“¶é¢ˆä¸”å‘½ä¸­ç‡ä¹Ÿå¾ˆä½">æŸ¥è¯¢ç¼“å­˜å®¹é‡å°ï¼Œå­˜åœ¨ç“¶é¢ˆï¼Œä¸”å‘½ä¸­ç‡ä¹Ÿå¾ˆä½<a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98%E5%AE%B9%E9%87%8F%E5%B0%8F%E5%AD%98%E5%9C%A8%E7%93%B6%E9%A2%88%E4%B8%94%E5%91%BD%E4%B8%AD%E7%8E%87%E4%B9%9F%E5%BE%88%E4%BD%8E" class="hash-link" aria-label="æŸ¥è¯¢ç¼“å­˜å®¹é‡å°ï¼Œå­˜åœ¨ç“¶é¢ˆï¼Œä¸”å‘½ä¸­ç‡ä¹Ÿå¾ˆä½çš„ç›´æ¥é“¾æ¥" title="æŸ¥è¯¢ç¼“å­˜å®¹é‡å°ï¼Œå­˜åœ¨ç“¶é¢ˆï¼Œä¸”å‘½ä¸­ç‡ä¹Ÿå¾ˆä½çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>è¿™ä¸ªç¼“å­˜æœºåˆ¶æ˜¯ç”±ä¸€ç³»åˆ—å°ç¼“å­˜ç»„æˆçš„ã€‚æ¯”å¦‚è¡¨ç¼“å­˜ï¼Œè®°å½•ç¼“å­˜ï¼Œkeyç¼“å­˜ï¼Œæƒé™ç¼“å­˜ç­‰ ã€‚åªæœ‰ç›¸åŒçš„SQLè¯­å¥æ‰ä¼šå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ã€‚ä¸¤ä¸ªæŸ¥è¯¢è¯·æ±‚åœ¨ä»»ä½•å­—ç¬¦ä¸Šçš„ä¸åŒï¼ˆä¾‹å¦‚ï¼šç©ºæ ¼ã€æ³¨é‡Šã€å¤§å°å†™ï¼‰ï¼Œéƒ½ä¼šå¯¼è‡´ç¼“å­˜ä¸ä¼šå‘½ä¸­ã€‚åœ¨ä¸¤æ¡æŸ¥è¯¢ä¹‹é—´ æœ‰ INSERT ã€ UPDATE ã€ DELETE ã€ TRUNCATE TABLE ã€ ALTER TABLE ã€ DROP TABLE æˆ– DROP DATABASE è¯­å¥ä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å¤±æ•ˆï¼Œæ‰€ä»¥åœ¨MySQL 8ä¹‹åå°±æŠ›å¼ƒäº†è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<p>å¦‚æœä¸€å¼ è¡¨ä¸­æœ‰8000ä¸‡æ¡æ•°æ®ï¼ŒæŸ¥è¯¢ç¼“å­˜æ˜¾ç„¶å°±ä¼šåŠ›ä¸ä»å¿ƒï¼Œå¦‚æœåªå­˜çƒ­ç‚¹æ•°æ®å‘¢ï¼Ÿå³ä¾¿æ˜¯ä½¿ç”¨lruç®—æ³•ï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•ç¡®å®šå·²ç»å­˜åœ¨mysqlçš„ç¼“å­˜æ•°æ®ï¼Œå³ä¾¿æˆ‘ä»¬ç¼“å­˜äº†10wæ¡æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“æ˜¯8000wæ¡ä¸­çš„å“ªä¸€ä¸ªï¼Œå°±ä¼šå‘ç”Ÿç¼“å­˜ç©¿é€ï¼Œæ— æ³•å‘½ä¸­ã€‚åŠ ç¼“å­˜é›†ç¾¤æ›´æ˜¯æ— ä»è°ˆèµ·ï¼Œæ‰€ä»¥mysql8.0å°±ç›´æ¥åºŸå¼ƒäº†ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ›¿ä»£æ–¹æ¡ˆ">æ›¿ä»£æ–¹æ¡ˆ<a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88" class="hash-link" aria-label="æ›¿ä»£æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥" title="æ›¿ä»£æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åº”ç”¨å±‚ç»„ç»‡ç¼“å­˜ï¼Œæœ€ç®€å•çš„æ˜¯ä½¿ç”¨redis,ehcachedç­‰</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“<a href="https://jachen99.github.io/blog/mysql-CachesBuffers-reason#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç¼“å­˜çš„æ„ä¹‰åœ¨äºå¿«é€ŸæŸ¥è¯¢æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œå¯ä»¥çµæ´»æ§åˆ¶ç¼“å­˜çš„ä¸€è‡´æ€§
8.0ä¹‹å‰è®©DBAä¸€ç›´ç¦ç”¨çš„mysqlç¼“å­˜çš„é™åˆ¶ï¼š</p>
<ol>
<li>MySQLåŸºæœ¬æ²¡æœ‰æ‰‹æ®µçµæ´»çš„ç®¡ç†ç¼“å­˜å¤±æ•ˆå’Œç”Ÿæ•ˆï¼Œå°¤å…¶å¯¹äºé¢‘ç¹æ›´æ–°çš„è¡¨ï¼›</li>
<li>SQLå¿…é¡»å®Œå…¨ä¸€è‡´æ‰ä¼šå¯¼è‡´cacheå‘½ä¸­ï¼›</li>
<li>ä¸ºäº†èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå¤ªå¤§çš„result setä¸ä¼šè¢«cache(query_cache_limit)ï¼›</li>
<li>MySQLç¼“å­˜åœ¨åˆ†åº“åˆ†è¡¨ç¯å¢ƒä¸‹æ˜¯ä¸èµ·ä½œç”¨çš„ï¼›</li>
<li>æ‰§è¡ŒSQLé‡Œæœ‰è§¦å‘å™¨ï¼Œè‡ªå®šä¹‰å‡½æ•°æ—¶ï¼ŒMySQLç¼“å­˜ä¹Ÿæ˜¯ä¸èµ·ä½œç”¨çš„ï¼›</li>
<li>åœ¨è¡¨çš„ç»“æ„æˆ–æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒåŸºäºè¯¥è¡¨ç›¸å…³cache.ç«‹å³å…¨éƒ¨å¤±æ•ˆã€‚</li>
</ol>]]></content:encoded>
            <category>MySQL</category>
        </item>
        <item>
            <title><![CDATA[æµé‡é˜²å«å…µ-Sentinel]]></title>
            <link>https://jachen99.github.io/blog/product-Sentinel-flow-control</link>
            <guid>https://jachen99.github.io/blog/product-Sentinel-flow-control</guid>
            <pubDate>Sat, 11 Feb 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[éšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚Sentinel æ˜¯é¢å‘åˆ†å¸ƒå¼ã€å¤šè¯­è¨€å¼‚æ„åŒ–æœåŠ¡æ¶æ„çš„æµé‡æ²»ç†ç»„ä»¶ï¼Œä¸»è¦ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡è·¯ç”±ã€æµé‡æ§åˆ¶ã€æµé‡æ•´å½¢ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè‡ªé€‚åº”è¿‡è½½ä¿æŠ¤ã€çƒ­ç‚¹æµé‡é˜²æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥å¸®åŠ©å¼€å‘è€…ä¿éšœå¾®æœåŠ¡çš„ç¨³å®šæ€§ã€‚]]></description>
            <content:encoded><![CDATA[<p><em>éšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚Sentinel æ˜¯é¢å‘åˆ†å¸ƒå¼ã€å¤šè¯­è¨€å¼‚æ„åŒ–æœåŠ¡æ¶æ„çš„æµé‡æ²»ç†ç»„ä»¶ï¼Œä¸»è¦ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡è·¯ç”±ã€æµé‡æ§åˆ¶ã€æµé‡æ•´å½¢ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè‡ªé€‚åº”è¿‡è½½ä¿æŠ¤ã€çƒ­ç‚¹æµé‡é˜²æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥å¸®åŠ©å¼€å‘è€…ä¿éšœå¾®æœåŠ¡çš„ç¨³å®šæ€§ã€‚</em></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://sentinelguard.io/zh-cn/index.html" target="_blank" rel="noopener noreferrer">https://sentinelguard.io/zh-cn/index.html</a></p>
<p><img decoding="async" loading="lazy" alt="image-20230205223154781" src="https://jachen99.github.io/assets/images/image-20230205223154781-7978af5a9eed16fe9b2861e489089f0f.png" width="1435" height="781" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1ä»€ä¹ˆæ˜¯sentinel">1ã€ä»€ä¹ˆæ˜¯Sentinel<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#1%E4%BB%80%E4%B9%88%E6%98%AFsentinel" class="hash-link" aria-label="1ã€ä»€ä¹ˆæ˜¯Sentinelçš„ç›´æ¥é“¾æ¥" title="1ã€ä»€ä¹ˆæ˜¯Sentinelçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li>é˜¿é‡Œå·´å·´å¼€æºçš„åˆ†å¸ƒå¼ç³»ç»Ÿæµæ§å·¥å…·</li>
<li>ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§</li>
<li>ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ï¼šæ¶ˆæ¯å‰Šå³°å¡«è°·ã€é›†ç¾¤æµé‡æ§åˆ¶ã€å®æ—¶ç†”æ–­ä¸‹æ¸¸ä¸å¯ç”¨åº”ç”¨ç­‰</li>
<li>å®Œå¤‡çš„å®æ—¶ç›‘æ§ï¼šSentinel åŒæ—¶æä¾›å®æ—¶çš„ç›‘æ§åŠŸèƒ½</li>
<li>æä¾›å¼€ç®±å³ç”¨çš„ä¸å…¶å®ƒå¼€æºæ¡†æ¶/åº“çš„æ•´åˆæ¨¡å—ï¼Œä¾‹å¦‚ä¸ Spring Cloudã€Dubboã€gRPC çš„æ•´åˆ</li>
</ul>
<p>åœ¨å¾®æœåŠ¡ä¸­æ‰®æ¼”è€…æ²»ç†è€…çš„ä½œç”¨</p>
<p><img decoding="async" loading="lazy" alt="image-20230205223327662" src="https://jachen99.github.io/assets/images/image-20230205223327662-26c215f68dcd30112146078c58659825.png" width="557" height="244" class="img_ev3q"></p>
<ul>
<li>æ ¸å¿ƒæ¦‚å¿µï¼š<!-- -->
<ul>
<li>èµ„æºï¼šæ˜¯ Sentinel ä¸­çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼Œå¯ä»¥æ˜¯javaç¨‹åºä¸­ä»»ä½•å†…å®¹ï¼Œå¯ä»¥æ˜¯æœåŠ¡æˆ–è€…æ–¹æ³•ç”šè‡³ä»£ç ï¼Œæ€»ç»“èµ·æ¥å°±æ˜¯æˆ‘ä»¬è¦ä¿æŠ¤çš„ä¸œè¥¿</li>
<li>è§„åˆ™ï¼šå®šä¹‰æ€æ ·çš„æ–¹å¼ä¿æŠ¤èµ„æºï¼Œä¸»è¦åŒ…æ‹¬æµæ§è§„åˆ™ã€ç†”æ–­é™çº§è§„åˆ™ç­‰</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="æ ¸å¿ƒæ¦‚å¿µ" src="https://jachen99.github.io/assets/images/%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5-60cc01b2ecff484c0628899f529bdc72.png" width="1470" height="686" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2æ•´åˆå¾®æœåŠ¡é¡¹ç›®å®æ“">2ã€æ•´åˆå¾®æœåŠ¡é¡¹ç›®å®æ“<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#2%E6%95%B4%E5%90%88%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%93%8D" class="hash-link" aria-label="2ã€æ•´åˆå¾®æœåŠ¡é¡¹ç›®å®æ“çš„ç›´æ¥é“¾æ¥" title="2ã€æ•´åˆå¾®æœåŠ¡é¡¹ç›®å®æ“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21å®‰è£…">2.1ã€å®‰è£…<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#21%E5%AE%89%E8%A3%85" class="hash-link" aria-label="2.1ã€å®‰è£…çš„ç›´æ¥é“¾æ¥" title="2.1ã€å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>
<p>Sentinel åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†</p>
<ul>
<li>æ ¸å¿ƒåº“ï¼ˆJava å®¢æˆ·ç«¯ï¼‰ä¸ä¾èµ–ä»»ä½•æ¡†æ¶/åº“ï¼Œèƒ½å¤Ÿè¿è¡Œäºæ‰€æœ‰ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒæ—¶å¯¹ Dubboã€Spring Cloud ç­‰æ¡†æ¶ä¹Ÿæœ‰è¾ƒå¥½çš„æ”¯æŒã€‚</li>
<li>æ§åˆ¶å°ï¼ˆDashboardï¼‰åŸºäº Spring Boot å¼€å‘ï¼Œæ‰“åŒ…åå¯ä»¥ç›´æ¥è¿è¡Œï¼Œä¸éœ€è¦é¢å¤–çš„ Tomcat ç­‰åº”ç”¨å®¹å™¨ã€‚</li>
</ul>
</li>
<li>
<p>å¾®æœåŠ¡å¼•å…¥Sentinelä¾èµ–</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  		</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-sentinel</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Sentinelæ§åˆ¶å°æ­å»º</p>
</li>
<li>
<p>æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/Sentinel/wiki/%E6%8E%A7%E5%88%B6%E5%8F%B0" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/wiki/æ§åˆ¶å°</a></p>
</li>
<li>
<p>æ§åˆ¶å°åŒ…å«å¦‚ä¸‹åŠŸèƒ½:</p>
<ul>
<li>
<p>æŸ¥çœ‹æœºå™¨åˆ—è¡¨ä»¥åŠå¥åº·æƒ…å†µï¼šæ”¶é›† Sentinel å®¢æˆ·ç«¯å‘é€çš„å¿ƒè·³åŒ…ï¼Œç”¨äºåˆ¤æ–­æœºå™¨æ˜¯å¦åœ¨çº¿ã€‚</p>
</li>
<li>
<p>ç›‘æ§ (å•æœºå’Œé›†ç¾¤èšåˆ)é€šè¿‡ Sentinel å®¢æˆ·ç«¯æš´éœ²çš„ç›‘æ§ APIï¼Œå®šæœŸæ‹‰å–å¹¶ä¸”èšåˆåº”ç”¨ç›‘æ§ä¿¡æ¯ï¼Œæœ€ç»ˆå¯ä»¥å®ç°<strong>ç§’çº§</strong>çš„å®æ—¶ç›‘æ§ã€‚</p>
</li>
<li>
<p>è§„åˆ™ç®¡ç†å’Œæ¨é€ï¼šç»Ÿä¸€ç®¡ç†æ¨é€è§„åˆ™ã€‚</p>
</li>
<li>
<p>é‰´æƒï¼šç”Ÿäº§ç¯å¢ƒä¸­é‰´æƒéå¸¸é‡è¦ã€‚è¿™é‡Œæ¯ä¸ªå¼€å‘è€…éœ€è¦æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè¿›è¡Œå®šåˆ¶ã€‚</p>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šSentinel æ§åˆ¶å°ç›®å‰ä»…æ”¯æŒå•æœºéƒ¨ç½²</p>
</blockquote>
</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¯åŠ¨ Sentinel æ§åˆ¶å°éœ€è¦ JDK ç‰ˆæœ¬ä¸º 1.8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//-Dserver.port=8080 ç”¨äºæŒ‡å®š Sentinel æ§åˆ¶å°ç«¯å£ä¸º 8080 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//é»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç»™sentinel-dashboard-1.8.2.jarå¢åŠ æƒé™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chomd 777 sentinel-dashboard-1.8.2.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">java -Dserver.port=8080 -Dcsp.sentinel.dashboard.server=localhost:8080 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard-1.8.2.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nohub java -Dserver.port=8080 -Dcsp.sentinel.dashboard.server=localhost:8080 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard-1.8.2.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç®€åŒ– é»˜è®¤ç«¯å£8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">java -jar sentinel-dashboard-1.8.2.jar </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç•Œé¢æ•ˆæœ</p>
<p><img decoding="async" loading="lazy" alt="image-20230205231438988" src="https://jachen99.github.io/assets/images/image-20230205231438988-4f7a9805496b274974b237b9d6ab11e6.png" width="1895" height="864" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22é™æµ">2.2ã€é™æµ<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#22%E9%99%90%E6%B5%81" class="hash-link" aria-label="2.2ã€é™æµçš„ç›´æ¥é“¾æ¥" title="2.2ã€é™æµçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç®€å•å®æ“ï¼š</p>
<ul>
<li>
<p>å¤šä¸ªå¾®æœåŠ¡æ¥å…¥Sentinelé…ç½®</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">spring</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">cloud</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">sentinel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">transport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">dashboard</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 127.0.0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">8080</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">9999</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#dashboard: 8080 æ§åˆ¶å°ç«¯å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#port: 9999 æœ¬åœ°å¯çš„ç«¯å£ï¼Œéšæœºé€‰ä¸ªä¸èƒ½è¢«å ç”¨çš„ï¼Œä¸dashboardè¿›è¡Œæ•°æ®äº¤äº’ï¼Œä¼šåœ¨åº”ç”¨å¯¹åº”çš„æœºå™¨ä¸Šå¯åŠ¨ä¸€ä¸ª Http Serverï¼Œè¯¥ Server ä¼šä¸ Sentinel æ§åˆ¶å°åšäº¤äº’, è‹¥è¢«å ç”¨,åˆ™å¼€å§‹+1ä¸€æ¬¡æ‰«æ é»˜è®¤ä¸º 8719</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å¾®æœåŠ¡æ³¨å†Œä¸Šå»åï¼Œç”±äºSentinelæ˜¯<strong>æ‡’åŠ è½½</strong>æ¨¡å¼ï¼Œæ‰€ä»¥éœ€è¦è®¿é—®å¾®æœåŠ¡åæ‰ä¼šåœ¨æ§åˆ¶å°å‡ºç°</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230205233156696" src="https://jachen99.github.io/assets/images/image-20230205233156696-890eea7fa0237a13a2740f08d4e04cd8.png" width="1881" height="514" class="img_ev3q"></p>
<ul>
<li>é™æµé…ç½®å®æ“<!-- -->
<ul>
<li>æ§åˆ¶å°é…ç½®</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230205233330855" src="https://jachen99.github.io/assets/images/image-20230205233330855-2e03eef42a75ffd561d4583ebae41701.png" width="1590" height="513" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23æµé‡æ§åˆ¶flow-control">2.3ã€æµé‡æ§åˆ¶ï¼ˆflow controlï¼‰<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#23%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6flow-control" class="hash-link" aria-label="2.3ã€æµé‡æ§åˆ¶ï¼ˆflow controlï¼‰çš„ç›´æ¥é“¾æ¥" title="2.3ã€æµé‡æ§åˆ¶ï¼ˆflow controlï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>
<p>æµæ§æ–‡æ¡£</p>
<ul>
<li><a href="https://github.com/alibaba/Sentinel/wiki/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6#%E5%9F%BA%E4%BA%8E%E8%B0%83%E7%94%A8%E5%85%B3%E7%B3%BB%E7%9A%84%E9%99%90%E6%B5%81" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/wiki/æµé‡æ§åˆ¶#åŸºäºè°ƒç”¨å…³ç³»çš„é™æµ</a></li>
</ul>
</li>
<li>
<p>åŸç†æ˜¯ç›‘æ§åº”ç”¨æµé‡çš„ QPS æˆ–å¹¶å‘çº¿ç¨‹æ•°ç­‰æŒ‡æ ‡ï¼Œå½“è¾¾åˆ°æŒ‡å®šçš„é˜ˆå€¼æ—¶å¯¹æµé‡è¿›è¡Œæ§åˆ¶ï¼Œä»¥é¿å…è¢«ç¬æ—¶çš„æµé‡é«˜å³°å†²å®ï¼Œä»è€Œä¿éšœåº”ç”¨çš„é«˜å¯ç”¨æ€§ã€‚</p>
</li>
<li>
<p>ä¸¤ç§è§„åˆ™</p>
<ul>
<li>åŸºäºç»Ÿè®¡å¹¶å‘çº¿ç¨‹æ•°çš„æµé‡æ§åˆ¶</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">å¹¶å‘æ•°æ§åˆ¶ç”¨äºä¿æŠ¤ä¸šåŠ¡çº¿ç¨‹æ± ä¸è¢«æ…¢è°ƒç”¨è€—å°½</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sentinel å¹¶å‘æ§åˆ¶ä¸è´Ÿè´£åˆ›å»ºå’Œç®¡ç†çº¿ç¨‹æ± ï¼Œè€Œæ˜¯ç®€å•ç»Ÿè®¡å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡çš„çº¿ç¨‹æ•°ç›®ï¼ˆæ­£åœ¨æ‰§è¡Œçš„è°ƒç”¨æ•°ç›®ï¼‰</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å¦‚æœè¶…å‡ºé˜ˆå€¼ï¼Œæ–°çš„è¯·æ±‚ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ•ˆæœç±»ä¼¼äºä¿¡å·é‡éš”ç¦»ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æµæ§è§„åˆ™ä¼šä¸‹å‘åˆ°å¾®æœåŠ¡ï¼Œå¾®æœåŠ¡å¦‚æœé‡å¯ï¼Œåˆ™æµæ§è§„åˆ™ä¼šæ¶ˆå¤±å¯ä»¥æŒä¹…åŒ–é…ç½®</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>åŸºäºç»Ÿè®¡QPSçš„æµé‡æ§åˆ¶</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">å½“ QPS è¶…è¿‡æŸä¸ªé˜ˆå€¼çš„æ—¶å€™ï¼Œåˆ™é‡‡å–æªæ–½è¿›è¡Œæµé‡æ§åˆ¶</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>æ§åˆ¶é¢æ¿</p>
<ul>
<li>èµ„æºåï¼šé»˜è®¤æ˜¯è¯·æ±‚è·¯å¾„ï¼Œå¯è‡ªå®šä¹‰</li>
<li>é’ˆå¯¹æ¥æºï¼šå¯¹å“ªä¸ªå¾®æœåŠ¡è¿›è¡Œé™æµï¼Œé»˜è®¤æ˜¯ä¸åŒºåˆ†æ¥æºï¼Œå…¨éƒ¨é™æµï¼Œè¿™ä¸ªæ˜¯é’ˆå¯¹ åŒºåˆ†ä¸Šæ¸¸æœåŠ¡è¿›è¡Œé™æµ, æ¯”å¦‚ è§†é¢‘æœåŠ¡ è¢« è®¢å•æœåŠ¡ã€ç”¨æˆ·æœåŠ¡è°ƒç”¨ï¼Œå°±å¯ä»¥é’ˆå¯¹æ¥æºè¿›è¡Œé™æµ</li>
</ul>
</li>
<li>
<p>æµæ§æ•ˆæœ</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230205234311415" src="https://jachen99.github.io/assets/images/image-20230205234311415-05f12c51d6dc1d17eff2a3740cfb2544.png" width="616" height="459" class="img_ev3q"></p>
<ul>
<li>
<p>æµé‡æ§åˆ¶çš„æ•ˆæœåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>
<p>ç›´æ¥æ‹’ç»ï¼šé»˜è®¤çš„æµé‡æ§åˆ¶æ–¹å¼ï¼Œå½“QPSè¶…è¿‡ä»»æ„è§„åˆ™çš„é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚å°±ä¼šè¢«ç«‹å³æ‹’ç»</p>
</li>
<li>
<p>Warm Upï¼šå†·å¯åŠ¨/é¢„çƒ­ï¼Œå¦‚æœç³»ç»Ÿåœ¨æ­¤ä¹‹å‰é•¿æœŸå¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¸Œæœ›å¤„ç†è¯·æ±‚çš„æ•°é‡æ˜¯ç¼“æ­¥çš„å¢å¤šï¼Œç»è¿‡é¢„æœŸçš„æ—¶é—´ä»¥åï¼Œåˆ°è¾¾ç³»ç»Ÿå¤„ç†è¯·æ±‚ä¸ªæ•°çš„æœ€å¤§å€¼</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20200908212417778" src="https://jachen99.github.io/assets/images/image-20200908212417778-941510ceb76a9e94e4bea1998900632e.png" width="630" height="295" class="img_ev3q"></p>
<ul>
<li>
<p>åŒ€é€Ÿæ’é˜Ÿï¼šä¸¥æ ¼æ§åˆ¶è¯·æ±‚é€šè¿‡çš„é—´éš”æ—¶é—´ï¼Œä¹Ÿå³æ˜¯è®©è¯·æ±‚ä»¥å‡åŒ€çš„é€Ÿåº¦é€šè¿‡ï¼Œå¯¹åº”çš„æ˜¯æ¼æ¡¶ç®—æ³•ï¼Œä¸»è¦ç”¨äºå¤„ç†é—´éš”æ€§çªå‘çš„æµé‡ï¼Œå¦‚æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼Œåœ¨æŸä¸€ç§’æœ‰å¤§é‡çš„è¯·æ±‚åˆ°æ¥ï¼Œè€Œæ¥ä¸‹æ¥çš„å‡ ç§’åˆ™å¤„äºç©ºé—²çŠ¶æ€ï¼Œæˆ‘ä»¬å¸Œæœ›ç³»ç»Ÿèƒ½å¤Ÿåœ¨æ¥ä¸‹æ¥çš„ç©ºé—²æœŸé—´é€æ¸å¤„ç†è¿™äº›è¯·æ±‚ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€ç§’ç›´æ¥æ‹’ç»å¤šä½™çš„è¯·æ±‚</p>
<p><img decoding="async" loading="lazy" alt="image" src="https://jachen99.github.io/assets/images/68292442-d4af3c00-00c6-11ea-8251-d0977366d9b4-0caca0974cee592b374dcb678a56a586.png" width="792" height="288" class="img_ev3q"></p>
<ul>
<li>æ³¨æ„ï¼š<!-- -->
<ul>
<li>åŒ€é€Ÿæ’é˜Ÿç­‰å¾…ç­–ç•¥æ˜¯ Leaky Bucket ç®—æ³•ç»“åˆè™šæ‹Ÿé˜Ÿåˆ—ç­‰å¾…æœºåˆ¶å®ç°çš„ã€‚</li>
<li>åŒ€é€Ÿæ’é˜Ÿæ¨¡å¼æš‚æ—¶ä¸æ”¯æŒ QPS &gt; 1000 çš„åœºæ™¯</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24ç†”æ–­é™çº§">2.4ã€ç†”æ–­é™çº§<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#24%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7" class="hash-link" aria-label="2.4ã€ç†”æ–­é™çº§çš„ç›´æ¥é“¾æ¥" title="2.4ã€ç†”æ–­é™çº§çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>
<p>æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/Sentinel/wiki/%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/wiki/ç†”æ–­é™çº§</a></p>
</li>
<li>
<p>ç†”æ–­é™çº§ï¼ˆè™½ç„¶æ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼ŒåŸºæœ¬éƒ½æ˜¯äº’ç›¸é…åˆï¼‰</p>
<ul>
<li>
<p>å¯¹è°ƒç”¨é“¾è·¯ä¸­ä¸ç¨³å®šçš„èµ„æºè¿›è¡Œç†”æ–­é™çº§ä¹Ÿæ˜¯ä¿éšœé«˜å¯ç”¨çš„é‡è¦æªæ–½ä¹‹ä¸€</p>
</li>
<li>
<p>å¯¹ä¸ç¨³å®šçš„<strong>å¼±ä¾èµ–æœåŠ¡è°ƒç”¨</strong>è¿›è¡Œç†”æ–­é™çº§ï¼Œæš‚æ—¶åˆ‡æ–­ä¸ç¨³å®šè°ƒç”¨ï¼Œé¿å…å±€éƒ¨ä¸ç¨³å®šå› ç´ å¯¼è‡´æ•´ä½“çš„é›ªå´©</p>
</li>
<li>
<p>ç†”æ–­é™çº§ä½œä¸ºä¿æŠ¤è‡ªèº«çš„æ‰‹æ®µï¼Œé€šå¸¸åœ¨å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨ç«¯ï¼‰è¿›è¡Œé…ç½®</p>
</li>
</ul>
</li>
<li>
<p>ä»€ä¹ˆæ˜¯Sentinelé™çº§è§„åˆ™</p>
<ul>
<li>
<p>æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/Sentinel/wiki/%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/wiki/ç†”æ–­é™çº§</a></p>
</li>
<li>
<p>å°±æ˜¯é…ç½®ä¸€å®šè§„åˆ™ï¼Œç„¶åæ»¡è¶³ä¹‹åå°±å¯¹æœåŠ¡è¿›è¡Œç†”æ–­é™çº§</p>
</li>
</ul>
</li>
<li>
<p>Sentinel ç†”æ–­ç­–ç•¥</p>
<ul>
<li>
<p>æ…¢è°ƒç”¨æ¯”ä¾‹(å“åº”æ—¶é—´): é€‰æ‹©ä»¥æ…¢è°ƒç”¨æ¯”ä¾‹ä½œä¸ºé˜ˆå€¼ï¼Œéœ€è¦è®¾ç½®å…è®¸çš„æ…¢è°ƒç”¨ RTï¼ˆå³æœ€å¤§çš„å“åº”æ—¶é—´ï¼‰ï¼Œè¯·æ±‚çš„å“åº”æ—¶é—´å¤§äºè¯¥å€¼åˆ™ç»Ÿè®¡ä¸ºæ…¢è°ƒç”¨</p>
<ul>
<li>æ¯”ä¾‹é˜ˆå€¼ï¼šä¿®æ”¹åä¸ç”Ÿæ•ˆ-ç›®å‰å·²ç»åé¦ˆç»™å®˜æ–¹é‚£è¾¹çš„bug</li>
<li>ç†”æ–­æ—¶é•¿ï¼šè¶…è¿‡æ—¶é—´åä¼šå°è¯•æ¢å¤</li>
<li>æœ€å°è¯·æ±‚æ•°ï¼šç†”æ–­è§¦å‘çš„æœ€å°è¯·æ±‚æ•°ï¼Œè¯·æ±‚æ•°å°äºè¯¥å€¼æ—¶å³ä½¿å¼‚å¸¸æ¯”ç‡è¶…å‡ºé˜ˆå€¼ä¹Ÿä¸ä¼šç†”æ–­</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20200909121342893" src="https://jachen99.github.io/assets/images/image-20200909121342893-d3613bc44174c9dc66daf9bc4f960796.png" width="675" height="365" class="img_ev3q"></p>
</li>
<li>
<p>å¼‚å¸¸æ¯”ä¾‹ï¼šå½“å•ä½ç»Ÿè®¡æ—¶é•¿å†…è¯·æ±‚æ•°ç›®å¤§äºè®¾ç½®çš„æœ€å°è¯·æ±‚æ•°ç›®ï¼Œå¹¶ä¸”å¼‚å¸¸çš„æ¯”ä¾‹å¤§äºé˜ˆå€¼ï¼Œåˆ™æ¥ä¸‹æ¥çš„ç†”æ–­æ—¶é•¿å†…è¯·æ±‚ä¼šè‡ªåŠ¨è¢«ç†”æ–­</p>
<ul>
<li>æ¯”ä¾‹é˜ˆå€¼</li>
<li>ç†”æ–­æ—¶é•¿ï¼šè¶…è¿‡æ—¶é—´åä¼šå°è¯•æ¢å¤</li>
<li>æœ€å°è¯·æ±‚æ•°ï¼šç†”æ–­è§¦å‘çš„æœ€å°è¯·æ±‚æ•°ï¼Œè¯·æ±‚æ•°å°äºè¯¥å€¼æ—¶ï¼Œå³ä½¿å¼‚å¸¸æ¯”ç‡è¶…å‡ºé˜ˆå€¼ä¹Ÿä¸ä¼šç†”æ–­</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20200909121357918" src="https://jachen99.github.io/assets/images/image-20200909121357918-0e8efcfbea59cd2f5519ba0dc4fdb34a.png" width="671" height="365" class="img_ev3q"></p>
</li>
<li>
<p>å¼‚å¸¸æ•°ï¼šå½“å•ä½ç»Ÿè®¡æ—¶é•¿å†…çš„å¼‚å¸¸æ•°ç›®è¶…è¿‡é˜ˆå€¼ä¹‹åä¼šè‡ªåŠ¨è¿›è¡Œç†”æ–­</p>
<ul>
<li>å¼‚å¸¸æ•°:</li>
<li>ç†”æ–­æ—¶é•¿ï¼šè¶…è¿‡æ—¶é—´åä¼šå°è¯•æ¢å¤</li>
<li>æœ€å°è¯·æ±‚æ•°ï¼šç†”æ–­è§¦å‘çš„æœ€å°è¯·æ±‚æ•°ï¼Œè¯·æ±‚æ•°å°äºè¯¥å€¼æ—¶å³ä½¿å¼‚å¸¸æ¯”ç‡è¶…å‡ºé˜ˆå€¼ä¹Ÿä¸ä¼šç†”æ–­</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20200909121415806" src="https://jachen99.github.io/assets/images/image-20200909121415806-e8845c3d71b6e297664653264d6ef280.png" width="680" height="368" class="img_ev3q"></p>
</li>
</ul>
</li>
</ul>
<p>æœåŠ¡ç†”æ–­ä¸€èˆ¬æœ‰ä¸‰ç§çŠ¶æ€ï¼ˆå¦‚å›¾ï¼‰</p>
<p><img decoding="async" loading="lazy" alt="image-20230206000459097" src="https://jachen99.github.io/assets/images/image-20230206000459097-7884418d52bac808cf36d137d4ac9bdf.png" width="562" height="458" class="img_ev3q"></p>
<ul>
<li>
<p>ç†”æ–­å…³é—­ï¼ˆClosedï¼‰</p>
<ul>
<li>æœåŠ¡æ²¡æœ‰æ•…éšœæ—¶ï¼Œç†”æ–­å™¨æ‰€å¤„çš„çŠ¶æ€ï¼Œå¯¹è°ƒç”¨æ–¹çš„è°ƒç”¨ä¸åšä»»ä½•é™åˆ¶</li>
</ul>
</li>
<li>
<p>ç†”æ–­å¼€å¯ï¼ˆOpenï¼‰</p>
<ul>
<li>åç»­å¯¹è¯¥æœåŠ¡æ¥å£çš„è°ƒç”¨ä¸å†ç»è¿‡ç½‘ç»œï¼Œç›´æ¥æ‰§è¡Œæœ¬åœ°çš„fallbackæ–¹æ³•</li>
</ul>
</li>
<li>
<p>åŠç†”æ–­ï¼ˆHalf-Openï¼‰</p>
<ul>
<li>æ‰€è°“åŠç†”æ–­å°±æ˜¯å°è¯•æ¢å¤æœåŠ¡è°ƒç”¨ï¼Œå…è®¸æœ‰é™çš„æµé‡è°ƒç”¨è¯¥æœåŠ¡ï¼Œå¹¶ç›‘æ§è°ƒç”¨æˆåŠŸç‡</li>
</ul>
</li>
<li>
<p>ç†”æ–­æ¢å¤ï¼š</p>
<ul>
<li>
<p>ç»è¿‡ç†”æ–­æ—¶é•¿åç†”æ–­å™¨ä¼šè¿›å…¥æ¢æµ‹æ¢å¤çŠ¶æ€ï¼ˆHALF-OPEN çŠ¶æ€ï¼‰å°è¯•æ¢å¤æœåŠ¡è°ƒç”¨ï¼Œå…è®¸æœ‰é™çš„æµé‡è°ƒç”¨è¯¥æœåŠ¡ï¼Œå¹¶ç›‘æ§è°ƒç”¨æˆåŠŸç‡ã€‚</p>
</li>
<li>
<p>å¦‚æœæˆåŠŸç‡è¾¾åˆ°é¢„æœŸï¼Œåˆ™è¯´æ˜æœåŠ¡å·²æ¢å¤ï¼Œè¿›å…¥ç†”æ–­å…³é—­çŠ¶æ€ï¼›å¦‚æœæˆåŠŸç‡ä»æ—§å¾ˆä½ï¼Œåˆ™é‡æ–°è¿›å…¥ç†”æ–­çŠ¶æ€</p>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25ç†”æ–­æ¡†æ¶æ¯”è¾ƒ">2.5ã€ç†”æ–­æ¡†æ¶æ¯”è¾ƒ<a href="https://jachen99.github.io/blog/product-Sentinel-flow-control#25%E7%86%94%E6%96%AD%E6%A1%86%E6%9E%B6%E6%AF%94%E8%BE%83" class="hash-link" aria-label="2.5ã€ç†”æ–­æ¡†æ¶æ¯”è¾ƒçš„ç›´æ¥é“¾æ¥" title="2.5ã€ç†”æ–­æ¡†æ¶æ¯”è¾ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<table><thead><tr><th style="text-align:left"></th><th style="text-align:left">Sentinel</th><th style="text-align:left">Hystrix</th><th style="text-align:left">resilience4j</th></tr></thead><tbody><tr><td style="text-align:left">éš”ç¦»ç­–ç•¥</td><td style="text-align:left">ä¿¡å·é‡éš”ç¦»ï¼ˆå¹¶å‘çº¿ç¨‹æ•°é™æµï¼‰</td><td style="text-align:left">çº¿ç¨‹æ± éš”ç¦»/ä¿¡å·é‡éš”ç¦»</td><td style="text-align:left">ä¿¡å·é‡éš”ç¦»</td></tr><tr><td style="text-align:left">ç†”æ–­é™çº§ç­–ç•¥</td><td style="text-align:left">åŸºäºå“åº”æ—¶é—´ã€å¼‚å¸¸æ¯”ç‡ã€å¼‚å¸¸æ•°</td><td style="text-align:left">åŸºäºå¼‚å¸¸æ¯”ç‡</td><td style="text-align:left">åŸºäºå¼‚å¸¸æ¯”ç‡ã€å“åº”æ—¶é—´</td></tr><tr><td style="text-align:left">å®æ—¶ç»Ÿè®¡å®ç°</td><td style="text-align:left">æ»‘åŠ¨çª—å£(LeapArray)</td><td style="text-align:left">æ»‘åŠ¨çª—å£(RxJava)</td><td style="text-align:left">Ring Bit Buffer</td></tr><tr><td style="text-align:left">åŠ¨æ€è§„åˆ™é…ç½®</td><td style="text-align:left">æ”¯æŒå¤šç§æ•°æ®æº</td><td style="text-align:left">æ”¯æŒå¤šç§æ•°æ®æº</td><td style="text-align:left">æœ‰é™æ”¯æŒ</td></tr><tr><td style="text-align:left">æ‰©å±•æ€§</td><td style="text-align:left">å¤šä¸ªæ‰©å±•ç‚¹</td><td style="text-align:left">æ’ä»¶çš„å½¢å¼</td><td style="text-align:left">æ¥å£çš„å½¢å¼</td></tr><tr><td style="text-align:left">åŸºäºæ³¨è§£æ”¯æŒ</td><td style="text-align:left">æ”¯æŒ</td><td style="text-align:left">æ”¯æŒ</td><td style="text-align:left">æ”¯æŒ</td></tr><tr><td style="text-align:left">é™æµ</td><td style="text-align:left">åŸºäºQPSï¼Œæ”¯æŒåŸºäºè°ƒç”¨å…³ç³»çš„é™æµ</td><td style="text-align:left">æœ‰é™çš„æ”¯æŒ</td><td style="text-align:left">Rate Limiter</td></tr><tr><td style="text-align:left">æµé‡æ•´å½¢</td><td style="text-align:left">æ”¯æŒé¢„çƒ­æ¨¡å¼ã€åŒ€é€Ÿå™¨æ¨¡å¼ã€é¢„çƒ­æ’é˜Ÿæ¨¡å¼</td><td style="text-align:left">ä¸æ”¯æŒ</td><td style="text-align:left">ç®€å•çš„Rate Limiteræ¨¡å¼</td></tr><tr><td style="text-align:left">ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤</td><td style="text-align:left">æ”¯æŒ</td><td style="text-align:left">ä¸æ”¯æŒ</td><td style="text-align:left">ä¸æ”¯æŒ</td></tr><tr><td style="text-align:left">æ§åˆ¶å°</td><td style="text-align:left">æä¾›å¼€ç®±å³ç”¨çš„æ§åˆ¶å°ï¼Œå¯é…ç½®è§„åˆ™ã€æŸ¥çœ‹ç§’çº§ç›‘æ§ã€æœºå™¨å‘ç°ç­‰</td><td style="text-align:left">ç®€å•çš„ç›‘æ§æŸ¥çœ‹</td><td style="text-align:left">ä¸æä¾›æ§åˆ¶å°ï¼Œå¯å¯¹æ¥å…¶ä»–ç›‘æ§ç³»ç»Ÿ</td></tr></tbody></table>]]></content:encoded>
            <category>Sentinel</category>
        </item>
        <item>
            <title><![CDATA[smart-doc+Tronaæ— ä¾µå…¥å¼APIæ–‡æ¡£ç®¡ç†å¹³å°]]></title>
            <link>https://jachen99.github.io/blog/product-torna-smart-doc</link>
            <guid>https://jachen99.github.io/blog/product-torna-smart-doc</guid>
            <pubDate>Sat, 04 Feb 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šsmart-doc (opens new window)+ Torna ç»„æˆè¡Œä¸šé¢†å…ˆçš„æ–‡æ¡£ç”Ÿæˆå’Œç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨smart-docæ— ä¾µå…¥å®ŒæˆJavaæºä»£ç åˆ†æå’Œæå–æ³¨é‡Šç”ŸæˆAPIæ–‡æ¡£ï¼Œè‡ªåŠ¨å°†æ–‡æ¡£æ¨é€åˆ°Tornaä¼ä¸šçº§æ¥å£æ–‡æ¡£ç®¡ç†å¹³å°ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<a href="https://gitee.com/smart-doc-team/smart-doc" target="_blank" rel="noopener noreferrer">smart-doc (opens new window)</a>+ Torna ç»„æˆè¡Œä¸šé¢†å…ˆçš„æ–‡æ¡£ç”Ÿæˆå’Œç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨smart-docæ— ä¾µå…¥å®ŒæˆJavaæºä»£ç åˆ†æå’Œæå–æ³¨é‡Šç”ŸæˆAPIæ–‡æ¡£ï¼Œè‡ªåŠ¨å°†æ–‡æ¡£æ¨é€åˆ°Tornaä¼ä¸šçº§æ¥å£æ–‡æ¡£ç®¡ç†å¹³å°ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ•ˆæœå›¾ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20230204155034231" src="https://jachen99.github.io/assets/images/image-20230204155034231-8927707ca601d58dbd82258b557d0cc2.png" width="701" height="380" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20230204155007085" src="https://jachen99.github.io/assets/images/image-20230204155007085-08c3ae48ba05fd6f2c9c1faee2dee988.png" width="1037" height="812" class="img_ev3q"></p>
<p>è¶…çº§ç®€æ´ ï¼Œè€Œä¸”å®ƒæ˜¯æ— ä¾µå…¥å¼çš„ï¼Œä¸éœ€è¦æ”¹åŠ¨ä»£ç ï¼Œåªéœ€è¦å¢åŠ é…ç½®æ–‡ä»¶å³å¯</p>
<p>å®˜æ–¹ä»“åº“åœ°å€ï¼š<a href="https://gitee.com/durcframework/torna" target="_blank" rel="noopener noreferrer">https://gitee.com/durcframework/torna</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸ºä»€ä¹ˆè¦ç”¨torna">ä¸ºä»€ä¹ˆè¦ç”¨Tornaï¼Ÿ<a href="https://jachen99.github.io/blog/product-torna-smart-doc#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8torna" class="hash-link" aria-label="ä¸ºä»€ä¹ˆè¦ç”¨Tornaï¼Ÿçš„ç›´æ¥é“¾æ¥" title="ä¸ºä»€ä¹ˆè¦ç”¨Tornaï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ¥å£æ–‡æ¡£è§£å†³æ–¹æ¡ˆï¼Œç›®æ ‡æ˜¯è®©æ¥å£æ–‡æ¡£ç®¡ç†å˜å¾—æ›´åŠ æ–¹ä¾¿ã€å¿«æ·ã€‚Tornaé‡‡ç”¨å›¢é˜Ÿåä½œçš„æ–¹å¼ç®¡ç†å’Œç»´æŠ¤æ¥å£æ–‡æ¡£ï¼Œå°†ä¸åŒå½¢å¼çš„æ–‡æ¡£çº³å…¥è¿›æ¥ç»Ÿä¸€ç»´æŠ¤ã€‚</p>
<p>Tornaå¼¥è¡¥äº†ä¼ ç»Ÿæ–‡æ¡£ç”Ÿæˆå·¥å…·ï¼ˆå¦‚swaggerï¼‰çš„ä¸å¦‚ä¹‹å¤„ï¼Œåœ¨ä¿æŒåŸæœ‰åŠŸèƒ½çš„å‰æä¸‹ä¸°å¯Œå¹¶å¢å¼ºäº†ä¸€äº›å®ç”¨çš„åŠŸèƒ½ã€‚</p>
<ul>
<li>ä¸æ»¡è¶³swaggeræ–‡æ¡£é¢„è§ˆé¡µé¢å’Œè°ƒè¯•é¡µé¢çš„å±•ç°æ–¹å¼</li>
<li>ä¸å–œæ¬¢swaggerè¿™ç§ä¾µå…¥å¼æ³¨è§£</li>
<li>å¸Œæœ›ä½¿ç”¨javadocæ³¨é‡Šç”Ÿæˆæ–‡æ¡£ï¼Œå¹¶è¿›è¡Œæ¥å£è°ƒè¯•</li>
<li>å¸Œæœ›æŠŠå…¬å¸æ‰€æœ‰é¡¹ç›®æ¥å£æ–‡æ¡£è¿›è¡Œç»Ÿä¸€ç®¡ç†</li>
<li>å¸Œæœ›æŠŠé¡¹ç›®ä¸­çš„è‹¥å¹²æ–‡æ¡£æä¾›ç»™ç¬¬ä¸‰æ–¹è°ƒç”¨è€…æŸ¥çœ‹</li>
<li>å¸Œæœ›å¯ä»¥ç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¸­çš„å­—å…¸æšä¸¾</li>
</ul>
<p>ç°åœ¨å·²ç»è·Ÿæ–°åˆ°1.20.0 å®ƒä¹Ÿå¯ä»¥æ•´åˆswaggerä½¿ç”¨ï¼Œä½†æ˜¯é‰´äºswaggerä¾µå…¥æ€§é«˜ï¼Œå®˜æ”¾æ¨èçš„æ˜¯smart-doc+Tornaè¿™ä¸€æŠ€æœ¯è·¯çº¿ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨ï¼Ÿ<a href="https://jachen99.github.io/blog/product-torna-smart-doc#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="å¦‚ä½•ä½¿ç”¨ï¼Ÿçš„ç›´æ¥é“¾æ¥" title="å¦‚ä½•ä½¿ç”¨ï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æˆ‘ä»¬ä»¥winä¸ºä¾‹è¿›è¡Œéƒ¨ç½²ã€‚å…¶ä»–éƒ¨ç½²ç¯å¢ƒå‚ç…§å®˜ç½‘å³å¯</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1ä¸‹è½½zipæœ¬åœ°è¿è¡Œ">1ã€ä¸‹è½½zipæœ¬åœ°è¿è¡Œ<a href="https://jachen99.github.io/blog/product-torna-smart-doc#1%E4%B8%8B%E8%BD%BDzip%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="1ã€ä¸‹è½½zipæœ¬åœ°è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="1ã€ä¸‹è½½zipæœ¬åœ°è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>1.1ã€ä¸‹è½½åœ°å€ï¼š<a href="https://gitee.com/durcframework/torna/releases" target="_blank" rel="noopener noreferrer">https://gitee.com/durcframework/torna/releases</a></p>
<p>éœ€è¦ä¸‹è½½ä¿©ä¸ªjaråŒ…</p>
<p><img decoding="async" loading="lazy" alt="image-20230204155607681" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAS8AAACOCAIAAADvixlwAAAQ+0lEQVR4nO3dfUwbaX4H8F/STbtRc9veSZbjkAIrZNUH0inQyyEh3V6mxdsYq5x7LVEFjkyV3h8krhzzz66gFUGqUdqT7Lhx476x5zksdA3XMrjH+pqJZDWVUNls7HR7ppy86GIaMI5Pp96+ZHuVNu4fMx6PjQ0GG/ys+X7EH3heH5C/nmde/HuOZbNZAgAGHK93AwBAhjQCsAJpBGAF0gjACqQRgBVIIwArkEYAViCNAKxAGgFYgTQCsAJpBGBF/dOYCk1ypkkhrZ624jVZvVEiyghOK+dbqVPTAA7VS/tcLy3ah/n4PlY02GY9RgpNDvoT6sneYas3v0BTbi+ZFs5I/ilukSyuoKNrn40F+GzI1tTmwo0LF4duPdrrKjfmt9TT4rcuDl1beJZ7+Wz++tCF2/GatRKASfs9Nh4qjcUTtNS7EQAHrR5pLNXLzfdUFX4n5y+apHcEJizag2wbQP3UI41aoy9slH9Pi/ZhnkY8vn6NaomM4HR628Yi9vY6NA+gTg7kmmpiZpKTL4ruIrW8FCd9b7emcLKmpU31Ki3aiy+6AjSgg7nDwV2dHdEL41bOKaZ2XHBrPUGGnu6Snc+1DWnd1PJSnBLJjdo3E4ApB9JT1Z/V6LomIv0rXtPUoGlp+8lezGcdXVRe8YMmXj3X4gpeatbT4uYWkY5W7voTZB7D7Q1oeAd697/dEQ66zQnvsNUeyqhndNqDkfCYhYjMY5Gwx2GQfglKP44u0p1tJXqSTBNFHwpElh6cQELjO/BncTrtwYjLGPc7i3qtMd+UYLDNlrtO03SmgxLJjYwwI5LBdgkHRjgCDuWaapctEj7vNU0N+prky6RpcXqRCvqoq1Oc3HeVbmM06YkSM3eEVbK4jLrDaCVAnR3aHY52RzjoUF6pb3KUvp+haTGQsIozRjhC6v/UeBnSTQ69YwBnjHBUMPNk3GJhT3WDH10kkm5s4OEbOBrqksaM4HR6VwunmVU91bRoHxfJPOamqdEZ8VKXUUeUCk0O+lvdYVvnoTcX4HDUJY1FT4FnBKdT9ZDqineYjxtss/Z2XdrWMby0nDZatPJzAqcPv7EAh4Wx88a0aDdNCWR0e4w6ItIax0fIe1NMUSa5RtTWhIur0MBqfGzU9U9E+ve/emp5KW6wzXrytzR0/RPudeugiScyuj24ogON7FgWI8YBsIGxnirAEYY0ArACaQRgBdIIwAqkEYAVSCMAK5BGAFYgjQCsQBoBWIE0ArACaQRgBdIIwAqkEYAVSCMAK5BGAFYgjQCsQBoBWIE0ArACaQRgBdIIwAqkEYAV1VZwzGazH3z40YtPXxRs9KVfOHXql48dO1blxgGOlGrT+N3vff9v3/qHoonHjx+/+s2hb3z9dQQSoHLVpnEr/ZN+82857X/40cfPl/49+tOf/k9YfNDxRf1b35kjIgQSoHI1O298/vyTDz/8+NXWs0TEvdb9J29ce+s7c/P/LLJXPXnFa+JjpWakQpOcycqZrJxpUkiXml44PLNqg9JaVm+0gv2nRXvh9gEkNUvjFz7/q7rTmsiDZSL6C8/f+f9+9tjx4++8+97Pf/5/JZeP+az2UKZWe69QKjTJmaaE0jNX7q4PRMLBSDgYcbV6h3OJjfKD/lZ3OBgJB91t/KBvpXCtjOCcSox4IuFgJGBLjFcQM63RF56wYBg82KZmadxIpX+U+PHINwd/7+u//bWvfuUrX/5S26u/VquN10QqNDkY6ZkN2DpKz293KEPWdfU5DOKDKBFRbEnsGOmThqnrHLB1LD4sOK6mH99fNV7p1xARaY1XzIn7y4f9EQMNo2aj4jTptL+uf/V78z+4YhuQpvzTwr+88+g/Sy2rjN/o5Px6R2DCoiWK8ty4KM9XxnKM8tzMGUcb710kiyvoIJ6bOePmlkb9iYLFCgaENJYb41EesSctlppZ3MLkqr6liYhWHizqewMaebL2XK+BfxC1deYGP08tL8XNA8ruOnuM8ZnHqX5lVJ/ikSotrqCja8VrmmsJTFi0GcHpTF72tMzIy1hcQQyrfpTVLI3J9Y1HsR8qUdyRxuIJtvis080en3RUifLc+BNHIGjRkvQOtodys1b55OVgxE5ERFGiVX6a80TCGkqL9uEpb0/Q0UWUfpzkPBGPRlp3OtQnr7tfqdCcYOiZrUFnMj9SZSo0Obg+sD1swvgdRyAY0RKlRfvwpBBAJ/boqllP9WcffCh8/773Dv/pp5/udd3YktgxcjX3LtRYLhvjkcfy9RKD7ZL6HWywjee7hZR4mpF+d8jx03Rz+vh6VX1FeRBl1ah1NZAWXf5Wt73EiHcWVy5+6OgeeTU7Nq79eP3Fixfr/735/Pknn/vcqb2smkmukb5HdTRrOtOxurlFVHkeYj7r6GLuhZlIDlVCmlBxDzAjOJ3etrFIeIeBIqUebHklhnxd8Q4v9QYmdh0j/XSzvoJGQsOqWRpPvPRS6O5fx//r/Z998NEe06hpaaP7TzPUpQqk4Uzlg4rHfNbpZk8krCG5Q0i0n3FdpbO4YKQgt5oWQyK5QSQdvtKP76+2XlH1JHVnWymykaJ2KYGxJbGjuW9b86YSIx5HBf3PrfUENe+pzdBQatZTPXHihNv37eV3/+MLn/+Vva7b2WOM++/k7g1khJs8cecqPjBmkmukPyslObMcSext31Gek24/Rt/2UmGvmEjqNgvj8t2O2BwfN5/vVK/V1ecg3iXdqkmL04v63m7p9FW+f5MKTY6u5XrXpQgzuXuYUX50MXd5Fo6kmh0bzRcv9P5mzy+eOFHhwzedAzYazl1T7bJFXDw3bPUSEVHHiGcvl2E0lstGbtwqEBHpLeYqOnur/KCJz7+Urtl22WZHJgdN1vyUor17xpImJ+cnotz1YUVadPkTRAllsx0jHl/hEdvCkctkjZO8+q69WWhg1Y407vF9+70f/ug3Okvcw0u8/+TkyZM3xv745Zd/qZpdNC65b4y7GiCp9tj4jf7XN1PP3nn3ve2zXnnl1B/8vhlRBKhQtWlsaW76luuNmjQF4IirtqcKALWC7/4DsAJpBGAF0gjACqQRgBVIIwArkEYAViCNAKxAGgFYgTQCsAK1xgFYgVrjAKyoS63x4kpq5ai/6ChVeZK/XpgW7cObV8LnH5imEnv7MiQAu2r2beOiWuNf7fnyn/35Xx07fux3f8e4LZD5SmoSudJpycJQ6sqONMUtEpHeERjQ0yZRuyMcjPmsnG/7l4DLlIT8TImpy+rtLiM4nfe50svHfNZR2uGfsNO6cGhqlsaiWuMnT74s1Rrve/1rVX3FscsWCduo6NhIK97c/E57MLJtJTne4aBcriYkKqVrGlUqdMfbNhYpE6eS/yUVqYLBHaEb9SPrqWZpVGqN/+u/vbP+dJOIEu8/qXqrRX1a6dgoE0yqOsWFR7+t9UQHd1WJX2e/seqWMG7lrp8cgWqO/+2vmRPTyxkLDo/1U5da4yUtuUx8vLhLmevTyieKShHxjOC8Q2+W/SA/3ayPR9Q1vxXqeCtlbJTi30QkFzif9Rh1UqUMzpbw83GDTepIq0pF5oqa57vE2+riSNKifZiPE1H+TLhkM4jUhScNNkebaiM77yX6UCnHrC5dSSR/TuV7FtJfd3lzUNpa7u+iEoXS4bDVpdZ4KautV8JXk04nZyrz7iQazR0MO0bGekkurFjy5ErXP+Fetw6a+MKCV7lyqZ7csALDfEuZYQIUQoTyPV7p7CvcTkSpkLglbWSc3OGgHMubYnfR2W9atA8v9QaCPi0RrQihnZqR62BP6HJb7hghqmAvqadPqO28Lve3y6UrpY+w7eeKq/zg0pjU/4/5rIO+JvkTcO9lbKG2mKg1TiQVUNVYPNL4UFYuNxSUrn9idkRP5rFIwNZBRmmsKF9/e4t03Chf9bDTHoyEPb0RZ374t/Tj+6tGd6mhb3ZguZx736fF6cX86rp+Y2fhmDnU1eegpeXCMapiczzly6i3W/o15ZuRWY4k8rvrsrnNuY3sthci6mgu+idkhJu83lXqs8Zgm83tvWCcH22Tnp4kMZRd/bBQa7xQly0S7ssPxSEXQZTPGEdNotxV6zGOLokta6LFFSx/cNNYPEGLcvDZ2IwXFE1WqipX1rDi1Ukq5RpflMo3yixKKeTcAgVl1EtsR2mGMhRPkV33UkLM57zPeXy7/mnaJj1t7rYQHBIWao1vp7oFojX6wkai7aeOZzoWea95LLLrG67rvIXmkmnqLNUT05/VEFU29EWJ1TUtbWTZqQRjqTLqZZtBBXXNKZNcI2quZC9ERPH1DFFuL1F+dM02a6/gekx6I0H0Wv51awuuqdYPE7XGKyaO5oYQjs3xcSJLj3QKN8kVDnIa86lGL44+FKQ3mfZcr0EcVZaM8qOLxte6SCrvnxuOZsU7XmZIucLVUyExRtTZk69EXlJhGfUVIZTZqRlt6tLjbysXk3fdi+5sK61tyCumRfv4E8eb5S/GrPJ35f55RrjJk9IHjj4U9jLgAtRc3WqNV6jwCqF0GTMjOK2jbWORwIZ9mI+FbbSekGKpON38RK4Onl+LiDQWj4ecTs60bfqbtvvDUlfQ6HYZhZmSbSlc3WCb7aeCSuRUcIlSVlhG3eIKElGZZlCnPej2WeXC5OYxt1mczm1kt72ct4zPLaeNFm1GuMnHieK5PUoLF/wdBlvLkpUbJ2kvyi3K1NMnHVwfLuHUERO1xnd6Fkch91T7kuqnRuTr/mVHUD06Cp+OKC9//6ZI4W0eqIdq05hc3/D9TTD97CfbZ73yyqk/sl0696UvVrN9qFhlT7eVTiOejGMCqhsfMWWPjVB/SCMAK/DdfwBWII0ArEAaAViBNAKwAmkEYAXSCMAKpBGAFUgjACtQ3RiAFahuDMAKVDcGYAWqG7OrhtWNa08unHXUv8hWW6hu3CDU1Y33GON9kb4A7Vv5LH7MMQvVjRtD9dWN90zX3dPhfxizt+PwWCuobkyNVd1Y2bKT80tLqvelFElY8ZrmWkZavX6xuBuv7Mhgc3NLo+sDcnHkbRWTSXuu18A/iNo6Kyy6B7vKVsd9+y337bey2ez7a8m/vMN//PFzZdY/Cj9440+/9ckn/7vrRjYXbly4GIhmn81fH7pw8cb8VtGsoaKfawvx+etDtx5ls9ls9PbQtYVn27cZvS0tqZ71bP760IXbcfnVo8CFi4FoNpvNxm+pd/oocOH6vU1lefn33DZzq28u3IsWbES9osrWvWv5jcfnF56Vb0Z2c+FGfguPAvn277aXzYUb+Q0W/U+27t2Sf382f12ZHr91cUi9yvbGZLfuXdu+zNa9a8oC5f/5sD+obrxLuz6z1Y1ztEaH/P/RdHP6+LpSrlLvGCju2RbsSGscH9EXzi+umHy6Wb1BqBaqGzdmdWM1Ve+ayLzDgqVaW7Cdyiomw36hunEjVjdWka6vRsIakq9L7/JXJlSt3VpXnSuWqZhc9pgMe4fqxtRo1Y0LZJJrctSlnnDJ1WM+6dRA083p4/635R2lxWnliFq6YnJmOZLIbRxqANWNqbGqGxMRdQ7YaDh3TfWykRu3CkREeou56DywmDS2lzwWmMHmHtGPrpN0uri9YrKOMslV6XMEagPVjRtEpdWN92LnpwgOYo9HHKobN4xaPxkX5bnxJ6XvoBKejDsQqKcKKgVPBZd5mAEODNIIwAp89x+AFUgjACuQRgBWII0ArEAaAViBNAKwAmkEYAXSCMAKpBGAFUgjACuQRgBWII0ArEAaAViBNAKwAmkEYAXSCMAKpBGAFUgjACuQRgBWII0ArEAaAVjx//xnoK2/S0dtAAAAAElFTkSuQmCC" width="303" height="142" class="img_ev3q"></p>
<p>æœ¬åœ°è§£å‹å³å¯ã€‚</p>
<p>1.2ã€åœ¨èµ„æºåŒ…ä¸­æ‰¾åˆ°mysql.sqlè„šæœ¬ï¼Œå¯¼å…¥mysql</p>
<p>1.3ã€åœ¨å¯åŠ¨åŒ…ä¸­æ‰¾åˆ°<code>application.properties</code>é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ•°æ®åº“è¿æ¥é…ç½®</p>
<p><img decoding="async" loading="lazy" alt="image-20230204155910470" src="https://jachen99.github.io/assets/images/image-20230204155910470-a4bcf860b7ac2bfc46e1115f540f2a37.png" width="643" height="319" class="img_ev3q"></p>
<p>1.4ã€åœ¨å¯åŠ¨ç›®å½•ç”¨cmdè¿è¡Œstartup.batæ–‡ä»¶</p>
<p><img decoding="async" loading="lazy" alt="image-20230204160003417" src="https://jachen99.github.io/assets/images/image-20230204160003417-8447e5aa58f6b7ed8568204e97038ded.png" width="885" height="249" class="img_ev3q"></p>
<p>1.5ã€æœ¬åœ°æµè§ˆå™¨è®¿é—®<a href="http://localhost:7700/" target="_blank" rel="noopener noreferrer">http://localhost:7700</a></p>
<p>1.6ã€ç™»å½•æ–‡æ¡£ç®¡ç†å¹³å°  åˆå§‹è´¦æˆ· ---&gt; ç”¨æˆ·åï¼š<code>admin</code>ï¼Œå¯†ç ï¼š<code>123456</code></p>
<p>1.7ã€åç»­å‡çº§ï¼Œåªéœ€è¦è¦†ç›–<code>torna.jaræ–‡ä»¶</code>å’Œ<code>distæ–‡ä»¶å¤¹</code>ï¼Œç„¶åé‡å¯å³å¯</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2tornaæ•´åˆsmart-docæ•™ç¨‹">2ã€Tornaæ•´åˆsmart-docæ•™ç¨‹<a href="https://jachen99.github.io/blog/product-torna-smart-doc#2torna%E6%95%B4%E5%90%88smart-doc%E6%95%99%E7%A8%8B" class="hash-link" aria-label="2ã€Tornaæ•´åˆsmart-docæ•™ç¨‹çš„ç›´æ¥é“¾æ¥" title="2ã€Tornaæ•´åˆsmart-docæ•™ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é€šè¿‡è¿™å¥—ç»„åˆæ‚¨å¯ä»¥å®ç°ï¼šåªéœ€è¦å†™å®ŒJavaæ³¨é‡Šå°±èƒ½æŠŠæ¥å£ä¿¡æ¯æ¨é€åˆ°Tornaå¹³å°ï¼Œä»è€Œå®ç°æ¥å£é¢„è§ˆã€æ¥å£è°ƒè¯•ã€‚</p>
<p>å®˜æ–¹åœ°å€ï¼š<a href="https://torna.cn/dev/smart-doc.html" target="_blank" rel="noopener noreferrer">https://torna.cn/dev/smart-doc.html</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="21åªéœ€è§„èŒƒç¼–å†™ä»£ç æ³¨é‡Šå³å¯">2.1ã€åªéœ€è§„èŒƒç¼–å†™ä»£ç æ³¨é‡Šå³å¯<a href="https://jachen99.github.io/blog/product-torna-smart-doc#21%E5%8F%AA%E9%9C%80%E8%A7%84%E8%8C%83%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81%E6%B3%A8%E9%87%8A%E5%8D%B3%E5%8F%AF" class="hash-link" aria-label="2.1ã€åªéœ€è§„èŒƒç¼–å†™ä»£ç æ³¨é‡Šå³å¯çš„ç›´æ¥é“¾æ¥" title="2.1ã€åªéœ€è§„èŒƒç¼–å†™ä»£ç æ³¨é‡Šå³å¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><img decoding="async" loading="lazy" alt="image-20230204160646490" src="https://jachen99.github.io/assets/images/image-20230204160646490-3440b5293c581b257b8b072b5b85226e.png" width="1016" height="562" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="22tornaæœåŠ¡é…ç½®">2.2ã€TornaæœåŠ¡é…ç½®<a href="https://jachen99.github.io/blog/product-torna-smart-doc#22torna%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="2.2ã€TornaæœåŠ¡é…ç½®çš„ç›´æ¥é“¾æ¥" title="2.2ã€TornaæœåŠ¡é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å…¨å›¾å½¢åŒ–æ“ä½œ å¯ä»¥æ ¹æ®éœ€æ±‚åˆ›å»ºç©ºé—´ç®¡ç†å‘˜å’Œä½¿ç”¨ç©ºé—´</p>
<p><img decoding="async" loading="lazy" alt="image-20230204160817710" src="https://jachen99.github.io/assets/images/image-20230204160817710-e0936e03cbcc23eec05398d5da6d7495.png" width="939" height="440" class="img_ev3q"></p>
<p>åˆ›å»ºè‡ªå·±çš„é¡¹ç›®æ–‡æ¡£å ï¼Œåˆ›å»ºå¥½åå¦‚å·¦ä¾§æ ·ä¾‹ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20230204160930669" src="https://jachen99.github.io/assets/images/image-20230204160930669-4b31f095ae98b1792a53fd8cd8b69739.png" width="1375" height="382" class="img_ev3q"></p>
<p>æŸ¥çœ‹tokenæ˜¯å¦ç”Ÿæˆï¼Œä¸€ä¼šè¦åœ¨é¡¹ç›®é‡Œé…ç½®</p>
<p><img decoding="async" loading="lazy" alt="image-20230204161207568" src="https://jachen99.github.io/assets/images/image-20230204161207568-368ca29953954cbf9f867713ce22fb45.png" width="691" height="273" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="23cloudæœåŠ¡é…ç½®">2.3ã€cloudæœåŠ¡é…ç½®<a href="https://jachen99.github.io/blog/product-torna-smart-doc#23cloud%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="2.3ã€cloudæœåŠ¡é…ç½®çš„ç›´æ¥é“¾æ¥" title="2.3ã€cloudæœåŠ¡é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æˆ‘çš„demoé¡¹ç›®ç»“æ„æ˜¯è¿™æ ·çš„</p>
<p><img decoding="async" loading="lazy" alt="image-20230204161338397" src="https://jachen99.github.io/assets/images/image-20230204161338397-9685e34d1b5a4d97b1f08b7968baa479.png" width="438" height="248" class="img_ev3q"></p>
<p>åœ¨è·Ÿç›®å½•çš„pomä¸­æ·»åŠ smart-docæ’ä»¶</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">		</span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- smart-docæ’ä»¶ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">plugin</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">com.github.shalousun</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">smart-doc-maven-plugin</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.4.9</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">configuration</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--æŒ‡å®šç”Ÿæˆæ–‡æ¡£çš„ä½¿ç”¨çš„é…ç½®æ–‡ä»¶--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">configFile</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">./src/main/resources/smart-doc.json</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">configFile</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--æŒ‡å®šé¡¹ç›®åç§°--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">projectName</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">è§†é¢‘é¡¹ç›®</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">projectName</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">configuration</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">executions</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">execution</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">phase</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">package</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">phase</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">execution</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">executions</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">plugin</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨webä¸­çš„resourcesä¸‹æ·»åŠ ä¸€ä¸ª<code>smart-doc.json</code>æ–‡ä»¶</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„è¦åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºresourcesåŒ…ï¼Œå¹¶æ ‡è®°ä¸ºèµ„æºåŒ…</p>
<p><img decoding="async" loading="lazy" alt="image-20230204162619302" src="https://jachen99.github.io/assets/images/image-20230204162619302-8705ade822a9b7b3905276b3e3578bfe.png" width="1258" height="970" class="img_ev3q"></p>
<p>æˆ‘ä»¬ä»¥video-serviceä¸ºä¾‹ å…¶ä»–æ¨¡å—ä¸€æ ·</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"outPath"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"target/doc"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"projectName"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"video-cloudé¡¹ç›®"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"packageFilters"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"space.jachen.controller.*"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"openUrl"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"http://localhost:7700/api"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"appToken"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"8de92ae464124cff815ce75e7732b9ca"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"debugEnvName"</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">"æœ¬åœ°ç¯å¢ƒ"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"debugEnvUrl"</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">"http://127.0.0.1:8080"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"tornaDebug"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">"replace"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å‚æ•°è¯´æ˜:</p>
<ul>
<li>outPathï¼šå›ºå®šå¡«è¿™ä¸ªä¸ç”¨å˜</li>
<li>projectNameï¼šé¡¹ç›®åç§°</li>
<li>packageFiltersï¼šControlleræ¥å£å¯¹åº”çš„packageç›®å½•ï¼Œå¤šä¸ªç”¨<code>;</code>éš”å¼€</li>
<li>openUrlï¼šTornaä¸­çš„OpenAPIæ¥å£</li>
<li>appTokenï¼šTornaä¸­çš„OpenAPI token</li>
<li>debugEnvNameï¼šTornaä¸­è°ƒè¯•ç¯å¢ƒåç§°</li>
<li>debugEnvUrlï¼šTornaä¸­è°ƒè¯•ç¯å¢ƒåœ°å€</li>
<li>tornaDebugï¼šæ˜¯å¦å¼€å¯è°ƒè¯•ï¼Œåˆæ¬¡ä½¿ç”¨å»ºè®®å¼€å§‹ï¼Œåé¢ç¨³å®šäº†å…³é—­</li>
<li>replaceï¼šæ˜¯å¦æ›¿æ¢æ–‡æ¡£ï¼Œå»ºè®®true</li>
</ul>
<p>overï¼Œå·²ç»é…ç½®å®Œæˆï¼Œæ¥ä¸‹æ¥æœ€åä¸€æ­¥ï¼Œæ¨é€åˆ°torna</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="24æ¨é€æ–‡æ¡£åˆ°torna">2.4ã€æ¨é€æ–‡æ¡£åˆ°Torna<a href="https://jachen99.github.io/blog/product-torna-smart-doc#24%E6%8E%A8%E9%80%81%E6%96%87%E6%A1%A3%E5%88%B0torna" class="hash-link" aria-label="2.4ã€æ¨é€æ–‡æ¡£åˆ°Tornaçš„ç›´æ¥é“¾æ¥" title="2.4ã€æ¨é€æ–‡æ¡£åˆ°Tornaçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•è¾“å…¥mavenå‘½ä»¤ï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn smart-doc:torna-rest -pl :jachen-cloud -am</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­<code>-pl :shop-web -am</code>è¡¨ç¤ºæ¨é€å“ªä¸ªå­æ¨¡å—</p>
<p>çœ‹åˆ°æœ€åçš„</p>
<p><img decoding="async" loading="lazy" alt="image-20230204162947190" src="https://jachen99.github.io/assets/images/image-20230204162947190-2fe984307f4f0005f2b9cd82a109c775.png" width="1082" height="173" class="img_ev3q"></p>
<p>è¡¨ç¤ºæ¨é€æˆåŠŸï¼Œå³å¯å‰å¾€Tornaæ¥å£åˆ—è¡¨æŸ¥çœ‹æ–‡æ¡£äº†</p>]]></content:encoded>
            <category>æ–‡æ¡£å·¥å…·</category>
            <category>Torna</category>
        </item>
        <item>
            <title><![CDATA[è´Ÿè½½å‡è¡¡ä¹‹Ribbonå®ç°]]></title>
            <link>https://jachen99.github.io/blog/product-ribbon</link>
            <guid>https://jachen99.github.io/blog/product-ribbon</guid>
            <pubDate>Tue, 31 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šRibbonæ˜¯ä¸€ä¸ªç”¨äºå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„å¼€æºé¡¹ç›®ï¼Œå®ƒåŸºäºNetflix Hystrixåº“ï¼Œç”¨äºæä¾›å®¢æˆ·ç«¯ä¾§è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚å®ƒå¯ä»¥åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å¸®åŠ©æ‚¨æ§åˆ¶å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨çš„è®¿é—®ï¼Œä»¥å®ç°è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨å’Œæ™ºèƒ½è·¯ç”±ã€‚Ribbonæä¾›äº†ä¸€ç»„APIï¼Œå¯ä»¥åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä»£ç ä¸­é›†æˆè´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>Ribbonæ˜¯ä¸€ä¸ªç”¨äºå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„å¼€æºé¡¹ç›®ï¼Œå®ƒåŸºäºNetflix Hystrixåº“ï¼Œç”¨äºæä¾›å®¢æˆ·ç«¯ä¾§è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚å®ƒå¯ä»¥åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å¸®åŠ©æ‚¨æ§åˆ¶å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨çš„è®¿é—®ï¼Œä»¥å®ç°è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨å’Œæ™ºèƒ½è·¯ç”±ã€‚Ribbonæä¾›äº†ä¸€ç»„APIï¼Œå¯ä»¥åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä»£ç ä¸­é›†æˆè´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚</em></p>
<p>è¿™ä¸ªæ˜¯å¼€æºåœ°å€ï¼š<a href="https://github.com/Netflix/ribbon" target="_blank" rel="noopener noreferrer">https://github.com/Netflix/ribbon</a></p>
<p>åœ¨æ¥å—è¿™ä¸ªå‰å®³çš„ç»„ä»¶å‰å…ˆ <strong>è®²è®²ä»€ä¹ˆè´Ÿè½½å‡è¡¡å’Œå¸¸è§çš„è§£å†³æ–¹æ¡ˆ</strong></p>
<ul>
<li>
<p>ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå½“è®¿é—®çš„æœåŠ¡å…·æœ‰å¤šä¸ªå®ä¾‹æ—¶ï¼Œéœ€è¦æ ¹æ®æŸç§â€œå‡è¡¡â€çš„ç­–ç•¥å†³å®šè¯·æ±‚å‘å¾€å“ªä¸ªèŠ‚ç‚¹ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„è´Ÿè½½å‡è¡¡ï¼Œ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">åŸç†æ˜¯å°†æ•°æ®æµé‡åˆ†æ‘Šåˆ°å¤šä¸ªæœåŠ¡å™¨æ‰§è¡Œï¼Œå‡è½»æ¯å°æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä»è€Œæé«˜äº†æ•°æ®çš„ååé‡</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>è½¯ç¡¬ä»¶è§’åº¦è´Ÿè½½å‡è¡¡çš„ç§ç±»</p>
<ul>
<li>é€šè¿‡ç¡¬ä»¶æ¥è¿›è¡Œè§£å†³ï¼Œå¸¸è§çš„ç¡¬ä»¶æœ‰NetScalerã€F5ã€Radwareå’ŒArrayç­‰å•†ç”¨çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œä½†æ¯”è¾ƒæ˜‚è´µçš„</li>
<li>é€šè¿‡è½¯ä»¶æ¥è¿›è¡Œè§£å†³ï¼Œå¸¸è§çš„è½¯ä»¶æœ‰LVSã€Nginxç­‰,å®ƒä»¬æ˜¯åŸºäºLinuxç³»ç»Ÿå¹¶ä¸”å¼€æºçš„è´Ÿè½½å‡è¡¡ç­–ç•¥</li>
</ul>
</li>
<li>
<p>ä»ç«¯çš„è§’åº¦è´Ÿè½½å‡è¡¡æœ‰ä¸¤ç§</p>
<ul>
<li>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡</li>
<li>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://file.xdclass.net/note/2020/alibaba-cloud/img/image-20200908114732828.png" alt="image-20200908114732828" class="img_ev3q"></p>
</li>
<li>
<p>å¸¸è§çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ˆçœ‹ç»„ä»¶çš„æ”¯æŒæƒ…å†µï¼‰</p>
<ul>
<li>èŠ‚ç‚¹è½®è¯¢<!-- -->
<ul>
<li>ç®€ä»‹ï¼šæ¯ä¸ªè¯·æ±‚æŒ‰é¡ºåºåˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨</li>
</ul>
</li>
<li>weight æƒé‡é…ç½®<!-- -->
<ul>
<li>ç®€ä»‹ï¼šweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œæ•°å­—è¶Šå¤§ï¼Œåˆ†é…å¾—åˆ°çš„æµé‡è¶Šé«˜</li>
</ul>
</li>
<li>å›ºå®šåˆ†å‘<!-- -->
<ul>
<li>ç®€ä»‹ï¼šæ ¹æ®è¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªç”¨æˆ·å°±å¯ä»¥å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨</li>
</ul>
</li>
<li>éšæœºé€‰æ‹©ã€æœ€çŸ­å“åº”æ—¶é—´ç­‰ç­‰</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alibabacloudé›†æˆribbonå®ç°è´Ÿè½½å‡è¡¡">AlibabaCloudé›†æˆRibbonå®ç°è´Ÿè½½å‡è¡¡<a href="https://jachen99.github.io/blog/product-ribbon#alibabacloud%E9%9B%86%E6%88%90ribbon%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1" class="hash-link" aria-label="AlibabaCloudé›†æˆRibbonå®ç°è´Ÿè½½å‡è¡¡çš„ç›´æ¥é“¾æ¥" title="AlibabaCloudé›†æˆRibbonå®ç°è´Ÿè½½å‡è¡¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒåœ¨å“ªä¸ªåŒ…ä¸‹ï¼Ÿè¿™ä¸ªæ˜¯Nacosæ•´åˆribbonçš„åŒ…</p>
<p><img decoding="async" loading="lazy" alt="image-20230202235459188" src="https://jachen99.github.io/assets/images/image-20230202235459188-7777810af36395c55c63179e4e22fd3c.png" width="781" height="192" class="img_ev3q"></p>
<ul>
<li>
<p>ä»€ä¹ˆæ˜¯Ribbon</p>
<p>Ribbonæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å·¥å…·ï¼Œé€šè¿‡Spring Cloudå°è£…ï¼Œå¯ä»¥è½»æ¾å’ŒAlibabaCloudæ•´åˆ</p>
</li>
<li>
<p>è®¢å•æœåŠ¡å¢åŠ @LoadBalanced æ³¨è§£</p>
</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Bean</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@LoadBalanced</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public RestTemplate restTemplate() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return new RestTemplate();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ¥ç€æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œ<a href="https://blog.jiguanchen.space/blog/product-nacos" target="_blank" rel="noopener noreferrer">https://blog.jiguanchen.space/blog/product-nacos</a></p>
<ul>
<li>è°ƒç”¨å®æˆ˜</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Video v = restTemplate.getForObject("http://jachen-video-service"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                + "/api/v1/video/getById/" + id, Video.class);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // æ³¨æ„:æ–¹ä¾¿çœ‹åˆ°è´Ÿè½½å‡è¡¡æ•ˆæœï¼Œåœ¨videoç±»å¢åŠ è¿™ä¸ªå­—æ®µï¼Œè®°å½•å½“å‰æœºå™¨ip+ç«¯å£</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®ƒçš„å®æ“éå¸¸ç®€å•ï¼Œé‚£å®ƒåº•å±‚çš„æºç æ˜¯æ€ä¹ˆèµ°çš„å‘¢ï¼Ÿæˆ‘ä»¬æ–­ç‚¹çœ‹ä¸€ä¸‹ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ribbonè´Ÿè½½å‡è¡¡æºç èµ°è¯»">Ribbonè´Ÿè½½å‡è¡¡æºç èµ°è¯»<a href="https://jachen99.github.io/blog/product-ribbon#ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%BA%90%E7%A0%81%E8%B5%B0%E8%AF%BB" class="hash-link" aria-label="Ribbonè´Ÿè½½å‡è¡¡æºç èµ°è¯»çš„ç›´æ¥é“¾æ¥" title="Ribbonè´Ÿè½½å‡è¡¡æºç èµ°è¯»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li>åˆ†ææ€è·¯<!-- -->
<ul>
<li>é€šè¿‡ç›´æ¥æ‰¾å…¥å£</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230203000427363" src="https://jachen99.github.io/assets/images/image-20230203000427363-521a21a79d522b95a055567b5fc0be68.png" width="770" height="397" class="img_ev3q"></p>
<ul>
<li>åˆ†æ@LoadBalanced<!-- -->
<ul>
<li>1ï¼‰é¦–å…ˆä»æ³¨å†Œä¸­å¿ƒè·å–providerçš„åˆ—è¡¨</li>
<li>2ï¼‰é€šè¿‡ä¸€å®šçš„ç­–ç•¥é€‰æ‹©å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹</li>
<li>3ï¼‰å†è¿”å›ç»™restTemplateè°ƒç”¨</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230203000859449" src="https://jachen99.github.io/assets/images/image-20230203000859449-ebe99daff7c5048036e882282edfa9c2.png" width="1486" height="614" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20230203001105830" src="https://jachen99.github.io/assets/images/image-20230203001105830-3ab46d4ae4323ec1b86459b2e221db84.png" width="1757" height="549" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20230203001158208" src="https://jachen99.github.io/assets/images/image-20230203001158208-facb9efd313ae0145932e092113f3645.png" width="1232" height="454" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20230203001503881" src="https://jachen99.github.io/assets/images/image-20230203001503881-8a45d2c5414ab195b5850da756092dfd.png" width="1105" height="493" class="img_ev3q"></p>
<p>æœ€åè¿”å›è°ƒç”¨çš„æœåŠ¡</p>
<p><img decoding="async" loading="lazy" alt="image-20230203001601629" src="https://jachen99.github.io/assets/images/image-20230203001601629-acc3837a10473f9854cf4cb1212fbbe0.png" width="1703" height="839" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ribbonæ”¯æŒçš„è´Ÿè½½å‡è¡¡ç­–ç•¥">Ribbonæ”¯æŒçš„è´Ÿè½½å‡è¡¡ç­–ç•¥<a href="https://jachen99.github.io/blog/product-ribbon#ribbon%E6%94%AF%E6%8C%81%E7%9A%84%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5" class="hash-link" aria-label="Ribbonæ”¯æŒçš„è´Ÿè½½å‡è¡¡ç­–ç•¥çš„ç›´æ¥é“¾æ¥" title="Ribbonæ”¯æŒçš„è´Ÿè½½å‡è¡¡ç­–ç•¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<table><thead><tr><th>ç­–ç•¥ç±»</th><th>å‘½å</th><th>æè¿°</th></tr></thead><tbody><tr><td>RandomRule</td><td>éšæœºç­–ç•¥</td><td>éšæœºé€‰æ‹©server</td></tr><tr><td>RoundRobinRule</td><td>è½®è¯¢ç­–ç•¥</td><td>æŒ‰ç…§é¡ºåºé€‰æ‹©serverï¼ˆé»˜è®¤ï¼‰</td></tr><tr><td>RetryRule</td><td>é‡è¯•ç­–ç•¥</td><td>å½“é€‰æ‹©serverä¸æˆåŠŸï¼ŒçŸ­æœŸå†…å°è¯•é€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„server</td></tr><tr><td></td><td></td><td></td></tr><tr><td>AvailabilityFilteringRule</td><td>å¯ç”¨è¿‡æ»¤ç­–ç•¥</td><td>è¿‡æ»¤æ‰ä¸€ç›´å¤±è´¥å¹¶è¢«æ ‡è®°ä¸ºcircuit trippedçš„serverï¼Œè¿‡æ»¤æ‰é‚£äº›é«˜å¹¶å‘é“¾æ¥çš„serverï¼ˆactive connectionsè¶…è¿‡é…ç½®çš„é˜ˆå€¼ï¼‰</td></tr><tr><td>WeightedResponseTimeRule</td><td>å“åº”æ—¶é—´åŠ æƒé‡ç­–ç•¥</td><td>æ ¹æ®serverçš„å“åº”æ—¶é—´åˆ†é…æƒé‡ï¼Œä»¥å“åº”æ—¶é—´ä½œä¸ºæƒé‡ï¼Œå“åº”æ—¶é—´è¶ŠçŸ­çš„æœåŠ¡å™¨è¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šå¤§ï¼Œç»¼åˆäº†å„ç§å› ç´ ï¼Œæ¯”å¦‚ï¼šç½‘ç»œï¼Œç£ç›˜ï¼Œioç­‰ï¼Œéƒ½ç›´æ¥å½±å“å“åº”æ—¶é—´</td></tr><tr><td>ZoneAvoidanceRule</td><td>åŒºåŸŸæƒé‡ç­–ç•¥</td><td>ç»¼åˆåˆ¤æ–­serveræ‰€åœ¨åŒºåŸŸçš„æ€§èƒ½ï¼Œå’Œserverçš„å¯ç”¨æ€§ï¼Œè½®è¯¢é€‰æ‹©server</td></tr></tbody></table>
<p>æ€ä¹ˆé…ç½®å‘¢ï¼Ÿ</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">è®¢å•æœåŠ¡å¢åŠ é…ç½®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">jachen-video-service:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ribbon:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç­–ç•¥é€‰æ‹©ï¼š 1ã€å¦‚æœæ¯ä¸ªæœºå™¨é…ç½®ä¸€æ ·ï¼Œåˆ™å»ºè®®ä¸ä¿®æ”¹ç­–ç•¥ (æ¨è) 2ã€å¦‚æœéƒ¨åˆ†æœºå™¨é…ç½®å¼ºï¼Œåˆ™å¯ä»¥æ”¹ä¸º WeightedResponseTimeRule</li>
</ul>
<p><strong>ä¸Šé¢å°±æ˜¯ribbonçš„åº•å±‚å®ç°ï¼Œå®ƒè¿˜æ˜¯ç¾ä¸­ä¸è¶³çš„ã€‚å­˜åœ¨çš„é—®é¢˜ï¼šä¸è§„èŒƒï¼Œé£æ ¼ä¸ç»Ÿä¸€ï¼Œç»´æŠ¤æ€§æ¯”è¾ƒå·®</strong></p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆå­˜åœ¨è¿™äº›é—®é¢˜å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸Šé¢çš„ä»£ç </p>
<p><img decoding="async" loading="lazy" alt="image-20230204225604362" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmIAAABxCAIAAAD56VitAAAgAElEQVR4nO2dX0gc2b7vf/tyXsocT7C6M7l3t9VCEysEL6mH7mGXFxKkg4zHp+N+UBpmcItgywnNRZAo+GDnQUhECIfGQwyId5gDog/b85TrQaaRDFx7k/ahBQkpQ0PbuofM2CVud6zX+1B/urpqrarq6jYxk9+HQLpXVa31q1+tWt/1+9Uq+3fRaBQQBEEQBCHx3z61AQiCIAhydUGZRBAEQRAqKJMIgiAIQgVlEkEQBEGooEwiCIIgCBWUSQRBEAShgjKJIAiCIFQuRSYjifm5hUwyTtkcn5qbHY9cRsMICfVyzC1k5lIDn9qWq0ZscJbeUfUdLrW7RhLzpuvCTAjiSicLwKZFcTHEaMUsvyKExEuzwQtDnSZ7XMqZCUFswGA2LQoThKY+BkOd4opD61fgQvhADAkrophmG6lD75BMaLHRqj4//sHPQfGpuX7Ymny6bZTw49Nj13PmEoQIwVEDyYV4uHavw5eppWzT2iyuPppZhUhifjTo8YjY4Oxw20/NtMET5F5k8c/Rlt9uFknMj0bV8U8pvHi0Lvk2tC4cnRmfGo1WtiY3/FfPhBaFa69y0pqlnOVXuA9LheOc/6prWrkfkF8dKF7LEeQ3hC+ZzEqH/fHbcdjW7/xINNJa2jEGL3VcRryxsTS5AeogzheXHz8vfmqDrh5NUDXNvZPPi+rnsalfPMltfv1xfr2hlh0YSPa3H75MmcxQ/noBty4UADhTAJSrIj8iG4SyTYmp5cqzQnPU+eOzdpBbO/jURjSb3HEhd9xgHYrWIRXlV/Xzl4QvmYSNt6V4b9cAZNVZcCzGM4c/qZ+Nub91aDPN5QHOz0jlNYFCTyrT26F+dBslLdGtPdhtFC0geNulmmSyJz41199OMLJaDue73z9ZzZujot6FTK+X8yI7ZyC5wJ/uBoQoc76bLfJxoVWtJzY4OwirO21jaiteoq7Y4Oyw0Kpaua8qdNXt/Zm5frP9YD4FUyEdfnx6rKu1+l03ieA0P84h95D41Ny9s+VVGFSbLmVnMhsAA71RKLzQpiDF1fUCP2ya5xmtG04zecbkHKvTtMo1zD1czQc4OhMiie5wKTtTG2WuHeRU1bErTUdISHIMAFyUCw+PFQA2LfJq9X2i2AcAoOwVCs8gtChwLQAAbFLkkgAA8mZOWgMQQ8J3IL1qEfoCAAAlKZeWq/UPdYp9AW3PWtg+Dt4V7EOjpZyZEIS7RrpSKZti2aqpUJFGDqqtivpJWe1h9LMw18PyK7ya71P2CoVnil4YOFm64GqdQ4NNizxUGzJ9NVoEqxPMRoLygXC+NSdlOtkaJziZRNq/Wm46KWZCEK6Xc28CYl/A8AMzIQi3Tmr20b8alZg8ZrffdMqmkzX7wZj6yOmcDF8Y/mQStvePevv5HoBtAOBjkdajnHa3q7HRQHKhu+YALbmkj5L3COWRxPzo7PjhY22+38vue53710a3kZsBMIW2zSLcn2nb/X4mk+9JZXq/GViXNoAfn+4PFF6k1iWA+NRc1ciBpFFeZWNpcqO+7DTFOQDtQjA785Kf64+3vUxtdWXEaAwkAGCEse7Ci9SSBD2pTG9qYDvjlM2LJB7AampGAnXoH0zEnqzmtzOpbXKeMDY4G2/b/X5Gk/zh5Pu8Y1Y2NpjoAnX/+NRcf6Dw4uk2AMVpdTvHqYe0do2OHW1Nprb58emx7kF+Yx1utkHlbfVy5H+Rh4WuAciWASDcb3daNYiMJOZH+Wq7PalhQc7OPN5QnTadKKuyF0nMV3u4Dt2ZUDu59ADD9bVIIzkZWH6F54aOpTWQ07kcKel6/DB3TEu6tnDC/XJh5EABll/h+SGCKFoRQ1xHpTxikx5beTWIFENC0pThH+oMvsnl0gDqqJ2uaColhoQkp2zmCjYbmLv8tc1cbg3YtMj3scc5VcZ4Zq+Qe6aozwhNxgf4JFicQ0N+U4G+AAuyDADAMDdAfqUO+8rxw9yx6s+aI1i+aiTLr3DGSQl3L6SRgqzqzWJIlSVmQuBvlAsj2mch2ankDpx0ZajT2L/GA6Z62LQopJXqHKKDF2+UCyMHylCn2NfOwoG8c6LcDbLisXq5meuM8k5WK5TTuRwAmxY5W/2G/eSTFUNCUgiVmpW3/5zxu4QnKx1C++04gJZxlRyHttjgvfbDl4Thr6erWl5c3TlsjcR4ABjojTKHP5nm/udaWxQ2tnaVcJe6DiIW46HwX46jDz8+rS5pMf55WdtSyqoD4vb+EbA3IwCRaAR21zUtzP5YayQTicbc63SE4hwAULQTPN/fqh18D19qQZVhpAPF1ae6kOfzktIa5Jz25mMR2F/XIiGzw+n7tyrF3TyA2luYtnYAF6fRYIQx/Uppq2mce4iiSbKUL54zbe0A7ddbz88OTTUenlRHpRqndfA9TpYM3O442tImH/n1n45a+VjVHlIPp8O1tSqnR553V8pL6mgrn5SA+b3vFS4VSYs5bPWsHeRGCKrJdAeZUsU+0NPKCawdGNXKbypwg1FbZfs4piQRJU3ZK6jl1f3VBK8WD8nlPYW9Yywkqcc5a0fli0BwCECvs+w4UWAmOJZkJHsnIG9q+qc8K8stQVYEAJa7y8ivNM1TnknVthzQjq1plr0F5R+0euTNstIRMC2b0S/iWkWGFkYEyB2XS0ywW/NrsKNSfuacF2W5u4xhf5WhQPVka+r8svEZTZryruX6JsU1xL5iIaznowAAQDk1PngfQQCKu8XzMb4HYJuPRaDo8hxLev5ksm5bD/f1c8w+VRNlPUGmtWN4Ljpc3Uf7f2Ppxc3pMXWT7yUnDs7xRuv1MIDTk05LUrTkWFv79dbW9tGFTLXEeX/p/Sl0RaIxkPIQ58NwpCp6mOo0B4gJWHoPOS/mdflff5wHAODPzmu9EQ4y5ydl64FHZ+dw3ckQ/mYbtOtpYbWtM71cKdbTY4G/2QZQ3wVtPsx1BsB1PIXykl0NaeXkSoxkKQDAxYXaOHMDlHeen3J1tDAtAWHFNJdz7oCgpZH1Ro28pSK/U7g7LIDMdAfhneTrORvD3AC2Q8t1A4ApGat8IBtWTeqCOZ+5dlD4vSCo6fFq2pm51sIYOXMAAKhUa6rOTmRpRPsov6nw91kGjpWhAFuquDzJFxkGlBObnczvW6AjIK5US5Q954q+DHzLpJ535W+aMq5+oKzqZNraAbRrzbW12neoRcoXz4dvx+HwZgSkdZdVMNZnZtaHTN6hPqLTlTiSmB9dmAK/D0obWvJaGz/ZGEiO6UlR8LYOtuYRnSvl03MIRzVFNC9U8fRc0516eoj0/hQiX/HG/rGvWDjdzwPURvy2oJMEad4jvT+FOt8Z8XFI83FfizEUYC9Oyva0G62cABNa5FlDAIY6xfta48qv9Vnr+tzRCmU9jrJzoiQDLCjMLTj5wf9qFOJzXADmWgdATv/cYpSrSV0CerKaCS0KYtpQSk/PNausVeQ+jhWPlTsB+Y3bKqScoiQpmyxPrBFo6L3JrHQI7WLCNeMKAPlfZNBydPz4tL62Rc31hfunbGmujbclCN/TXlaLJLrDtuyivYm8pLTdHIjxlZzrECw9fzKZmjH/86WR2/tHrdHBQd5pn+L7Ss136f0peEkzAt05XhhI9refS3lXSTt9rwZb44NRc27FdL0MstJha9dggpJJjk9Zc9fxBwLsL+seNsTeyWl1OKfeHrLxtsQICWP/QQHs+8cG77k5TcoXz9t7CSn6mvprITkTAKB8eq4lohtCUX4FU/qxWv7hwjFjNtTJdygnO4q5RFwR+ZoMofq+h12ZaOV0K8/05TZGeAcgv6kwd3mvryGuVeQWjm/K+5Q5+eSihRlig7+WXXVI+esFaAlPJrRoxMSK/E5h+zptfpdPSsDe114kZSY49sIlqWtuyjRvkE9KDPcd6UVVKvJJibnWwQZveGmRXL+yc6J08LxrlvhLw380qeVdO2ozrqYVnuGxjKCny7Yz2dsL8bmFOMDR1ot9MaHtXlx9tAzzo0YWS49XtjMpSGX0FN/R1qR7EFNc3TldiAul7EwDp1Qf2aczMDU3lhG07/aVnKAmDE3TiI2ll/yclkp1WcxJc44DYcKKSvOizfjcQlwPnTe2drtHtf2PCruKYIomTdfLqGpjaRKSC9V8qUukm/2xcG/YnKTV9qc5rU7n1NtDavav9STJaTTy648BZodVz5gPqbWnxjkkZwJAPi8Njt4bj2QbfAVITkvyCq8mykyrGZXjH8rBpKCWm+KeAL+iCpWHYEVkgy0VwphLKyejHL+qcH2qJUp5r8Le0resHeSgUzRSiy5xjCyNSPyKYKQEKcGcR5MuxD5O3jSdv3k5a58o9un1rx1Id0TVafJmoXxfXx/wrFCYEIQVXeT1SFdO56S0qCeHK5JtbY4F0zJXtRI9iVpTj6cgT94sc0ke9sxrks3pbkFcqfYQS/3ayeaOCwBC0kgm1xnR/lb5XTQa/dQ2IE3hE/1NABrqixmGGjX/LZ2PRCQxPxrc8ZdvcGMguRCHpv4pCWfEkJBsKY84Lrw0waZF7sz6FoFDue+GEORKg3/TFbkUIjcD5q89Xe1uz0qvJgO9UdJin+awsfTyyG9e/SMgp3NELaSVG7B9HHNx8YW9go78dmkk6YogVIqr64VZU9K1vuU/nxrzIq9SdqYJC44oZJ8u35wfdXvD9fPAvJLTPdmIIJ8NmHRFEARBECqYdEUQBEEQKiiTCIIgCEIFZRJBEARBqKBMIgiCIAgVlEkEQRAEoYIyiSAIgiBUUCYRBEEQhArKJIIgCIJQQZlEEARBECookwiCIAhCBWUSQRAEQaigTCIIgiAIFZTJLwCWXxGFCQbEkGD9eXqdoU5xsa6fSrfAhBZFccX+Y+7Vrc34SXSWXxE8/dj9UKeonjJta0Mnq8FMCGKacsZXCJrTasrZtCguhhj1Ol7KSfHj0wuZudQAZXNscDaTjDe/2Uhifm6BXnN8am52PNL8Zgl8/XVm8dvlxW+XFx8MXkb9kcT8dCJ2GTUj+ENaCAATuh+QXx1c1i8fDbVzUC54+aF59RfkKT/UzkxwbKksXZXfUme5u1Be8v3Dw0xoUbj2KieZ3aKevv7N+KF5KrX71/Vb81fMmb6x/9w3Pz49dj139X4A/PXr1OvX8PXXmT/906XUX1zdOV0YTr7PX5UfZv8NgTL5BaB8uAD4qwI5RUkqH0q27SIbhLLkRcboTRw/zB1TtrF3PGkwMyEIt07KJeAo29lbUP7BmyytHeTWDjzt6ZuhwOXIjC51YkhI8iHRUfZyx4XcMYghIRk88SyQAGB3pnKmACgKKMqv6uemIz1/MnkJ1Walw/747Ths69oQiUZaSzuGRhZXH82sXkK7V5GNpRc3p8emerJXborwuYMy+bkSScyP8kVPv3WsHD9UR1BZGiHIDNvHwbuCeWhk0yLfoX6sSCMHsl4YfFP4cF/96V1T4DLUKfYFAAAuyoWHth/jFUNcR6Wc1r6pWmjsVv0qhvjr5dxDmU1TVHKonYOTgq4EbFrkoRp0mr5WfxxY3qyJ1ZgJQbirh14XF6Ty6snWOsEepWnxd01J9UeJa1qv1qP7p1rSJ4p9AMTAMSeffMdd6wDI0Z1G9hQAWAJN5YNla60zAUB5pn2T0zmPAXJscHY4In3/xMNvVvekMr0dAADnu5b9B5IL8bD+5dBbw7VsvC3Fe7sGIKv+rnUsxjOHP23UVq4UXjxal6rHRBLzo1HdOednpPIjc4Rq2G+visyt2UVROy3l7YvJ139x3Htw+ttvtF7/8389/HGdUP73vf/zn//22qUcQHqeK2XERGy79qJEEvOjUfBkOUICZfJLR5WxEdOQO9QZfJPLpQHUAT1dqapRnwCbudwaMBOC8F1Izh0roIduQ53ifUL1bB8HewVj5FV2TpS7QVY8VlWHuc4o72QF1MDIwUprWlh+U4G+AAuyDADAMDdAfqU2osa1TGhRuGauYKhTuHshjRRkgBpTTeXMhCAshlT5YSYE/ka5MKJ9FpKdSq6qoPY0MjPBc6Duz/IrPLNXUDXSXA+bFoW0kkvLcjqXIyZdzYhssKVSXrM7jWFv6U6jwvJJTtnMFdYAgOVXLDOPS86x29nOpLYBelKZ2kekscHZeNvu9zOreVV02/xVvn/U28/3AGwDAB+LtB7ltMhyY2lyA2AgudBdc0B8ajRa0VQwPjV3j1AeScyPzo4fPn5eBIgk5nvZ/eVJ7fPo2NQvzhndW7OLYnD//47+e8WT/X98cEf6j9EnAKr+Td9af/JOLf8m+PbFQ5vE0sqr3rgXi0DeffaMeAaX8HzhMN1BplSpCSDWDoyxW35TgRuM+WmZZAzcLS0eVsGwwQ7lZMc0IOeOyyUm2M3oWytl58dvKiIbbKmcmBVl7ah8EQgO6VuhXHZKGjOh+wF588AeJ7F3quXKs7LcEmRFAGC5u4z8SgvXlGdStS39qFqhMkuXfFIC5jqjl0P5B60eebOsdATclscwXFIUV0QxySmGwWanqfLp6DRmgmNLkrMAnzSUY28K8QcC7K97CEZdyEqH0H47DqBlXCXHlGNs8F774UuCzvV0VcuLqzuHrZEYDwADvVHm8CctZ1NcXS+ca21R+MO//s+w8vY/PGokAPz5x8d/1j6uSz9DsO0PxiYmJH5NOoRWDgBwdHbeej1cW1ZcfTQziaGkfzCa/Nzgx6fHulq1L12jCxkg5LI8Q1yHwvIrfHU0N+Una2lhRADH52HEdSLymwp/n2XgWBkKsKWKl3vXEpICAIAiv1O4OyyAzHQH4Z3kKzZimBvAdmiZT7XaD8YH+0NcFXv8DYryKzC3WAaOFWCDHSBvqsYy11oYNilySWNP19HTSPCy/Ioo/F5LxhpOg+4g7Em+Fw4B2Zn1UJOxjA7PRYe9piIvCyPvWjZlXOsl9hUL4f7MXL9RopwaH46819PxT/8IJ6fOWdZaTBlaAFD+pn34848v/vu/jP3p2+U/AZRzo2qI6VCuIb0/hchXPACKYvNAmfzc0JdC1PFsks5QgL04KVueui3yrLHWlJJKBQCAC8VlzQjD3mL0XKiJtYrcx7HisXInIL/xstCGDXYoJ0tWHVR2TpRkgAWFuQUnP/jPIFoeYeow6nNB7bPpoSPTHWRKZctZKWcKdHCCmt4sSblqhXWsPrXYVd5ThOsMgAJgOE2Gxk6W5sw60BfF1PFs8rLR8q78TVPG1Q+HL1OkZaJMW7uhOlxbq30HM6W//R3qWMoa+N8LYthQuz8+WP5f1W1/+ff//Iu2zz8vT4OhiLRyAADgb7ZB5S1qZFPBpOsXjPqMirASRF/ryPLq2hz7gd9x1lStnaF2jpwLlU9KzLUONnjDOVOqNzbBsaUyQWly8slFCzPEBn8lba1BUX4F9g4LACCGhOpJKfI7he2zv+4pn5SAva+9W8lMcOyFYSrL3YXypjX+5u5CeSmXG8nlRnKmt1nkkxLDfUd8R9NkEhmWu8vIb6pVlfeA+473cLKg/PUCtOwuE1rkzW1QnfkJODo71xKb0JMaFizyE5+ac3rPspasdAjtYsI14woA+V9kCHcNAADw49P97UZ5XlLC/VM91v033pYgfE97tzKS6A6f728ZUqq+DFrz5uVfXh9fcOLsHz3ZrXLxNzVuvTX74H+Qtld+PiEeRyxvv956fmZZDOXy8ijiBkaTXy6mRSImlONXFa5PEFcAQCnvVdhb1W3MXbUcoFS7ylRbBhgQVrjqes47AeXdETFskTfLXJKHPfPyWnOmlxdXjCYoIalm6oXYx8mbplHfvMKzTxT7tGBRTkvyCi+uAEBFWipz3+lVPCsUJgRhRV9bohsvp3NSWtSiQ6hII/pkghB/A4Bc3uMEc3JV909tPTV+M5lkXunKcHo9yl7BvEpI2TlR7nLKG5MrTCfLJUUuqUeuawfSHZFfCQCAvFko3+f1AxyceYmYlrN2DM9Fh7VnBNLz9d350bGMAHC++/0WDN82H5SVDvvbw+zNCICHfMnG21K8t6M24xqfmtNVMDyWEfTM8HYme3shPrcQBzjaerEvJrTdi6uPlmF+dCHTq34/31dTNduZFKQy6tMNgKOtSZf8zevXKYDMn75dfgAA1ZWuf/jXfxnr+kd1l28Wv/1GW9Ra+bf/9/Pyg39eXgSAv+/t/xzWFde0nFWt5J1zuUZPV/u59KPFwuL7CkB7uLoeGKmP30Wj0U9tA/JJYNMid+b2Arvv/cWQkGwpjxBWzdTHUKd4/8Ll5YePB215KsuvcB+qyVWWX+GBnMttgMZderWc6UJscHZYkLMzGRzZPUP70wr8+PRY1yk5pYy4g9HkF4v3N+T84PKCh2fWDnKffk2mgfEGai0iwwBU300cCrCglGkrgHzChL5rbOkNXDVn0tFWCZVQI+tiIDnWdfoyVauRscHZYaGV9tgV8QRGk4hH6o0+vyhq/naB/2U75Lq1P1xA+Rt+CAIAEEnMD8L6VVhR9dsDZRJBEARBqOBKVwRBEAShgjKJIAiCIFRQJhEEQRCECsokgiAIglBBmUQQBEEQKiiTCIIgCEIFZRJBEARBqKBMIgiCIAgVlEkEQRAEoYIyiSAIgiBUUCYRBEEQhArKJIIgCIJQQZlEEARBECookwiCIAhCBWUSQRAEQaigTCIIgiAIFZRJBEEQBKGCMokgCIIgVFAmEQRBEIQKyiSCIAiCUEGZRBAEQRAqKJMIgiAIQgVlEkEQBEGooEwiCIIgCBWUSQRBEAShgjKJIAiCIFRQJhEEQRCECsokgiAIglBBmUQQBEEQKiiTCIIgCEIFZRJBEARBqKBMIgiCIAgVlEkEQRAEoYIyiSAIgiBUUCYRBEEQhArKJIIgCIJQaaZMzi1kmrhbc9v13ejcQsb459se38fSDvS4m3mTqw3ezTb7xPLPuQkvNL17NB1nCx0c3kjH8HFU0+/HZl2aj3CJPV4j13LvPrTcBU2/L4iNeixEGuQffB85t5CZmUyZS2YmU/ZC8ND57IfUBa1dVzMsBhB38HI6xN2acpRxrD8XWQ40bFA9ZrHBoxstR5kP+Q3fojTPOHjM4s9mXUR7zQ3iXJv5mtpvE382mFt0vi+ce5SlbzsYY9lKPGVXlzqPWnabL/u+sLix3tNBvONfJoldjXhhmn4hPU6jHGwjNu3RvHoHPocRlvhV/eB6VzvXRhujjQ9E+SS2ftl4nMK7mhRJzI9GmcOXqaUsaXN8au7e2fLj50VfRtY7sBJjSn++9SeK6iEep63EQvP8ibipKaO/s3nOymepx8tUxn45iHU6TH1ox9bDQHIhHj7f990b68LVVFRTV/zLJJi6ppdxrVmTa/AgeBaIU1fiLUGTLqCLqMOEzsE82gzDVZu9VEUUWt+VE3dzHm7qot6r+ZEhnqn9g8Osyz5M0/qhc7zio3PSxKOR1EtT8H6VvVviZSrjo12PkxuPs72mYOk/rrZ5n20gRBqSSdAvgIP4OdzbjWdvfGDXNvtWcOt85q0ep7HO5Q6qY/GS+e71GGVajgKKty0VOs9pHDTAN5ZW6pXM4uqjmdVG2idjN4nmeaKIEh1FjPLtmyw2eJyE2YWhwcmHa4x1qbjG67TPtD7vEDeDLd3i0XUOATfp8I2lyQ3XOutqDigJDKQp+JRJ7zfeJw8OPHYa76k/e0BAgxZng23ood1UrkGn881MlHOL/fYKr2BIBwAAscHZ4Yj0/ZPVvO3rQHIhHgYAUAovHq1L1WPUTKz25fyMVH60Nfl0Wy/vSWV6O9SP1qpc5cfsSVpAf9kQhdliKnGCaLGTZrm9R0Gdp+ZddF1vMaP1equy50Wa2+cd7qZqxytlZzKGWMYGZwdhdadtTO3GNX3S1vMJbV3JG/a3g0+ZrHcwdejxxOkwsdx75ZaRwnmyaTfD+dQcQgHn/R0sJ1pVl0ke43hLio8WOLqGqg7hrz88VJLPS4MCH4tAvggAwLW1KsVddeBQp+cDyYXumiPiU6PRijbixKfm7hHKI4n50dnxw8fPiwCRxHwvu788qX0eHZv6RR+tiK74CC4iRpnEuZHzXWOXNI+xqb0eh69esNwy9Y4MH1MPPCoo8RTsV1+tRM15RBLzo0HLEYww1l14kVqSoCeV6U0NbGeoEafrza6C2tksGlrC0/j+TRlhHXqMazKEFkQ6Z2a8b7JXTty5rgyPgw3Eyb75KzHApQVGNJu967dHiGEu2ESiuLpzuNAd46EoAcT5cGlnSSLWpxIbvNd++DK1bdvQ01UtN9U50BtlDl9qqyqKq+sFfvh2HHr7neJCmlI2a4Sy91LfLbqO9a56T+s8zu264s+wRjpeXcOOa0hAux3qtfDwpZa92N4/6r13MwJAW+DjnMnw3iLikUafTTqEa17mO0Q+4ZWmTclpkYH3DJKXpmk3pMfe77ybc67YY3rAdeJs1OZia+3hRBEi2bPxthQXozGQ8j1d7Yf7T723YiL2FQvh/sxcv1GinBofjqx7u14OL9EkcWffg1q9uRxXvMuApemmTHOdsbfoJXfiWqfrgbTkOQ37nnUdbqX1ehgAzI8MosNz0WHLswD7dN85SED80ahMqniZQF1GNOljsHDI9hg3hsckatPnbmYl83FeriNdvZlbL1Gmx/RsU2Jx0CbasQhwtzuO3jbQdyjvjTBt7QDaGMS1tQI0NjNoZCh3wNXnrod7KWyk8ubeF+aT9RdM+/B8XSki2v5mDavPJ+dnh9VVaU7PJs1tWW7JOppDHGlIJuu6Ub1ftsu401QchnVLupJokmvlzjs4j25EJTPvb9lkmUi6xpHmzw5ZLH+Ra9PjGypZ6bCfD8evt+3+aM+m1pL/RR4WugYguwH8+HR/u76EJ5+XBkf7p3qyT2tr2HhbivfeG49k1WeT3eHz/eUsFLOEfuIauNuTpc3CVTBc8ZGuMGdNvMyNPOLRP03vbM29Lva5tV2l6rF2INnffr77o96+9hQAAAJkSURBVPMrlUYfqM9WxBfNiSadsdxUtOHeX7X1HuVlNlqvogO9v9pDT3Mqhpi8MtdpH4+IuR1nI72Ev8TB18uUwtyKQ7mzhfWwsbU7P9oPhRemmXV8aq6/Xf0YHssIemJqO5O9vRCfW4gDHG292BcT2u7F1UfLMD+6kOlVv+svem9nUpDKjGrWHm1NWt/+dpYo10tjuco+8isfeXZipDcsTTjP9uoSP1po69xpGzxx+83ucY7rUGi/l0l3d2xwdlhoVT/H5xbi5vWuxoOA812XwNGH8V5qQ2g084/VecRyAzhn9preuvnmdNU281HEzx5NBdLoaS4nDgp2ZfXYIs0M2uDiXGgRTgcbiI5tJOVAdDXh/cjs0xniX96pfUFt+3F1A+0ly+0MYckPUC6ipdBfEsKCfWw1Xzjn6V3Tce4w3vsSrXLnHbx3ts9HBvLrj/PrlG3UPyAF+fXHNapZ72jgnPnwUsMXThOiSeehjTjWN96iw0zcIWCCWlmi9TZnO733OS9i7HAuxEHZGVqLds1zEHvixIU2TBNPinYWrlzqoO8Ph4voOnWg9StaeoA4l/Jy+zQyefKxv8UkL+kKC+a5Bc0Ge8znUIkXs50LHVxBi6edD788BXIeUpzvbo9VIWZ+F41GP7UNCIIgXzKxwdnhtp9o0STyiUGZRBAEQRAq+LPMCIIgCEIFZRJBEARBqKBMIgiCIAgVlEkEQRAEoYIyiSAIgiBUUCYRBEEQhArKJIIgCIJQQZlEEARBECookwiCIAhCBWUSQRAEQaigTCIIgiAIFZRJBEEQBKGCMokgCIIgVP4/ocg0ETK0uoEAAAAASUVORK5CYII=" width="610" height="113" class="img_ev3q"></p>
<p><em>æ¯æ¬¡æˆ‘ä»¬éƒ½è¦å»åœ¨ä»£ç é‡Œè¿™æ ·æ‹¼è·¯å¾„ï¼Œå¦‚æœæˆ‘çš„æ–¹æ³•ç‰¹åˆ«å¤šå‘¢ï¼Ÿå¾ˆæ˜¾ç„¶è¿™ç§æ–¹æ³•æ˜¯ä¸å¯å–çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±å¼•å‡ºäº†Feignç»„ä»¶</em></p>
<p>ä»€ä¹ˆæ˜¯Feign</p>
<div class="language-tex codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tex codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SpringCloudæä¾›çš„ä¼ªhttpå®¢æˆ·ç«¯(æœ¬è´¨è¿˜æ˜¯ç”¨http)ï¼Œå°è£…äº†Httpè°ƒç”¨æµç¨‹ï¼Œæ›´é€‚åˆé¢å‘æ¥å£åŒ–</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">è®©ç”¨Javaæ¥å£æ³¨è§£çš„æ–¹å¼è°ƒç”¨Httpè¯·æ±‚.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ä¸ç”¨åƒRibbonä¸­é€šè¿‡å°è£…HTTPè¯·æ±‚æŠ¥æ–‡çš„æ–¹å¼è°ƒç”¨ Feigné»˜è®¤é›†æˆäº†Ribbon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://spring.io/projects/spring-cloud-openfeign" target="_blank" rel="noopener noreferrer">https://spring.io/projects/spring-cloud-openfeign</a></p>
<ul>
<li>Nacosæ”¯æŒFeign,å¯ä»¥ç›´æ¥é›†æˆå®ç°è´Ÿè½½å‡è¡¡çš„æ•ˆæœ å¯ä»¥ä½¿ç”¨springbootç­‰æ³¨è§£</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ”¹é€ å¾®æœåŠ¡-é›†æˆopen-feign">æ”¹é€ å¾®æœåŠ¡ é›†æˆOpen-Feign<a href="https://jachen99.github.io/blog/product-ribbon#%E6%94%B9%E9%80%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%9B%86%E6%88%90open-feign" class="hash-link" aria-label="æ”¹é€ å¾®æœåŠ¡ é›†æˆOpen-Feignçš„ç›´æ¥é“¾æ¥" title="æ”¹é€ å¾®æœåŠ¡ é›†æˆOpen-Feignçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li>
<p>Feignè®©æ–¹æ³•è°ƒç”¨æ›´åŠ è§£è€¦</p>
</li>
<li>
<p>ä½¿ç”¨feignæ­¥éª¤è®²è§£</p>
<ul>
<li>
<p>åŠ å…¥ä¾èµ–(orderå®¢æˆ·ç«¯)</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">spring-cloud-starter-openfeign</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>é…ç½®æ³¨è§£(orderå®¢æˆ·ç«¯)</p>
</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¯åŠ¨ç±»å¢åŠ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@EnableFeignClients</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>å¢åŠ ä¸€ä¸ªè¿œç¨‹è°ƒç”¨æ¥å£(å¯ä»¥åœ¨orderæ¨¡å—é‡Œé¢ä¹Ÿå¯ä»¥å•ç‹¬æ‹¿å‡ºå»è‡ªå·±ä¸€ä¸ªæ¨¡å—)</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//è®¢å•æœåŠ¡å¢åŠ æ¥å£ï¼ŒæœåŠ¡åç§°è®°å¾—å’Œnacosä¿æŒä¸€æ ·</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@FeignClient(name="jachen-video-service") </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ç¼–å†™ä»£ç </li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@GetMapping(value = "/api/v1/video/find_by_id")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Video findById(@PathVariable int videoId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// ä¸€å®šæ³¨æ„ä¸Šé¢é”™è¯¯çš„ ä¸€å®šè¦æ³¨æ„è·¯å¾„ä¸€å®šå®Œæ•´ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// @RequestParamé‡Œé¢éƒ½è¦æŒ‡å®š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// å¦‚æœå‚æ•°è¦ç”¨restfulé£æ ¼æ¥æ”¶ ç”¨@PathVariable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// è·¯å¾„çš„å‚æ•°å¦‚æœå’Œæ–¹æ³•é‡Œå‚æ•°ä¸ä¸€æ · ä¸€å®šè¦åŠ ("id")å‚æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@GetMapping("/api/v1/video/getById/{id}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Video getById(@RequestParam("id") Integer id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>æ³¨å…¥videoserviceï¼ˆåœ¨orderå®¢æˆ·ç«¯controllerå±‚åŠ å…¥ï¼‰å°±åƒåœ¨æœ¬åœ°ä½¿ç”¨ä¸€æ ·ç®€å•</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private VideoService videoService;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Video v = videoService.getById(id);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ribbonå’Œfeignä¸¤ä¸ªçš„åŒºåˆ«å’Œé€‰æ‹©</p>
<div class="language-tex codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tex codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">é€‰æ‹©feign</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">é»˜è®¤é›†æˆäº†ribbon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å†™èµ·æ¥æ›´åŠ æ€è·¯æ¸…æ™°å’Œæ–¹ä¾¿</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">é‡‡ç”¨æ³¨è§£æ–¹å¼è¿›è¡Œé…ç½®ï¼Œé…ç½®ç†”æ–­ç­‰æ–¹å¼æ–¹ä¾¿</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>]]></content:encoded>
            <category>è´Ÿè½½å‡è¡¡</category>
            <category>Ribbon</category>
        </item>
        <item>
            <title><![CDATA[æœåŠ¡æ²»ç†ä¹‹Nacos]]></title>
            <link>https://jachen99.github.io/blog/product-nacos-service-management</link>
            <guid>https://jachen99.github.io/blog/product-nacos-service-management</guid>
            <pubDate>Mon, 30 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šNacoså®˜ç½‘è¿™æ ·ä»‹ç»è‡ªå·±ï¼šä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚é‚£ä¹ˆå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿå®ƒçš„å‡ºç°å¸®åŠ©æˆ‘ä»¬è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿè¿™æ˜¯æœ¬æ–‡æ¢ç©¶çš„é‡ç‚¹ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>Nacoså®˜ç½‘è¿™æ ·ä»‹ç»è‡ªå·±ï¼šä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚é‚£ä¹ˆå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿå®ƒçš„å‡ºç°å¸®åŠ©æˆ‘ä»¬è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿè¿™æ˜¯æœ¬æ–‡æ¢ç©¶çš„é‡ç‚¹ã€‚</em></p>
<p>Nacoså®˜æ–¹æ–‡æ¡£ï¼š<a href="https://nacos.io/zh-cn/docs/what-is-nacos.html%E3%80%82" target="_blank" rel="noopener noreferrer">https://nacos.io/zh-cn/docs/what-is-nacos.htmlã€‚</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacosåˆ°åº•æ˜¯ä»€ä¹ˆ">Nacosåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ<a href="https://jachen99.github.io/blog/product-nacos-service-management#nacos%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88" class="hash-link" aria-label="Nacosåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿçš„ç›´æ¥é“¾æ¥" title="Nacosåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Nacoså°±æ˜¯æ³¨å†Œä¸­å¿ƒ+é…ç½®ä¸­å¿ƒçš„ç»„åˆï¼ˆNacos = Eureka+Config+Busï¼‰</p>
<p>Nacos çš„å…³é”®ç‰¹æ€§åŒ…æ‹¬:</p>
<ul>
<li>
<p><strong>æœåŠ¡å‘ç°å’ŒæœåŠ¡å¥åº·ç›‘æµ‹</strong></p>
<p>Nacos æ”¯æŒåŸºäº DNS å’ŒåŸºäº RPC çš„æœåŠ¡å‘ç°ã€‚æœåŠ¡æä¾›è€…ä½¿ç”¨ <a href="https://nacos.io/zh-cn/docs/sdk.html" target="_blank" rel="noopener noreferrer">åŸç”ŸSDK</a>ã€<a href="https://nacos.io/zh-cn/docs/open-api.html" target="_blank" rel="noopener noreferrer">OpenAPI</a>ã€æˆ–ä¸€ä¸ª<a href="https://nacos.io/zh-cn/docs/other-language.html" target="_blank" rel="noopener noreferrer">ç‹¬ç«‹çš„Agent TODO</a>æ³¨å†Œ Service åï¼ŒæœåŠ¡æ¶ˆè´¹è€…å¯ä»¥ä½¿ç”¨<a href="https://nacos.io/zh-cn/docs/xx" target="_blank" rel="noopener noreferrer">DNS TODO</a> æˆ–<a href="https://nacos.io/zh-cn/docs/open-api.html" target="_blank" rel="noopener noreferrer">HTTP&amp;API</a>æŸ¥æ‰¾å’Œå‘ç°æœåŠ¡ã€‚</p>
<p>Nacos æä¾›å¯¹æœåŠ¡çš„å®æ—¶çš„å¥åº·æ£€æŸ¥ï¼Œé˜»æ­¢å‘ä¸å¥åº·çš„ä¸»æœºæˆ–æœåŠ¡å®ä¾‹å‘é€è¯·æ±‚ã€‚Nacos æ”¯æŒä¼ è¾“å±‚ (PING æˆ– TCP)å’Œåº”ç”¨å±‚ (å¦‚ HTTPã€MySQLã€ç”¨æˆ·è‡ªå®šä¹‰ï¼‰çš„å¥åº·æ£€æŸ¥ã€‚ å¯¹äºå¤æ‚çš„äº‘ç¯å¢ƒå’Œç½‘ç»œæ‹“æ‰‘ç¯å¢ƒä¸­ï¼ˆå¦‚ VPCã€è¾¹ç¼˜ç½‘ç»œç­‰ï¼‰æœåŠ¡çš„å¥åº·æ£€æŸ¥ï¼ŒNacos æä¾›äº† agent ä¸ŠæŠ¥æ¨¡å¼å’ŒæœåŠ¡ç«¯ä¸»åŠ¨æ£€æµ‹2ç§å¥åº·æ£€æŸ¥æ¨¡å¼ã€‚Nacos è¿˜æä¾›äº†ç»Ÿä¸€çš„å¥åº·æ£€æŸ¥ä»ªè¡¨ç›˜ï¼Œå¸®åŠ©æ‚¨æ ¹æ®å¥åº·çŠ¶æ€ç®¡ç†æœåŠ¡çš„å¯ç”¨æ€§åŠæµé‡ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€é…ç½®æœåŠ¡</strong></p>
<p>åŠ¨æ€é…ç½®æœåŠ¡å¯ä»¥è®©æ‚¨ä»¥ä¸­å¿ƒåŒ–ã€å¤–éƒ¨åŒ–å’ŒåŠ¨æ€åŒ–çš„æ–¹å¼ç®¡ç†æ‰€æœ‰ç¯å¢ƒçš„åº”ç”¨é…ç½®å’ŒæœåŠ¡é…ç½®ã€‚</p>
<p>åŠ¨æ€é…ç½®æ¶ˆé™¤äº†é…ç½®å˜æ›´æ—¶é‡æ–°éƒ¨ç½²åº”ç”¨å’ŒæœåŠ¡çš„éœ€è¦ï¼Œè®©é…ç½®ç®¡ç†å˜å¾—æ›´åŠ é«˜æ•ˆå’Œæ•æ·ã€‚</p>
<p>é…ç½®ä¸­å¿ƒåŒ–ç®¡ç†è®©å®ç°æ— çŠ¶æ€æœåŠ¡å˜å¾—æ›´ç®€å•ï¼Œè®©æœåŠ¡æŒ‰éœ€å¼¹æ€§æ‰©å±•å˜å¾—æ›´å®¹æ˜“ã€‚</p>
<p>Nacos æä¾›äº†ä¸€ä¸ªç®€æ´æ˜“ç”¨çš„UI (<a href="http://console.nacos.io/nacos/index.html" target="_blank" rel="noopener noreferrer">æ§åˆ¶å°æ ·ä¾‹ Demo</a>) å¸®åŠ©æ‚¨ç®¡ç†æ‰€æœ‰çš„æœåŠ¡å’Œåº”ç”¨çš„é…ç½®ã€‚Nacos è¿˜æä¾›åŒ…æ‹¬é…ç½®ç‰ˆæœ¬è·Ÿè¸ªã€é‡‘ä¸é›€å‘å¸ƒã€ä¸€é”®å›æ»šé…ç½®ä»¥åŠå®¢æˆ·ç«¯é…ç½®æ›´æ–°çŠ¶æ€è·Ÿè¸ªåœ¨å†…çš„ä¸€ç³»åˆ—å¼€ç®±å³ç”¨çš„é…ç½®ç®¡ç†ç‰¹æ€§ï¼Œå¸®åŠ©æ‚¨æ›´å®‰å…¨åœ°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç®¡ç†é…ç½®å˜æ›´å’Œé™ä½é…ç½®å˜æ›´å¸¦æ¥çš„é£é™©ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€ DNS æœåŠ¡</strong></p>
<p>åŠ¨æ€ DNS æœåŠ¡æ”¯æŒæƒé‡è·¯ç”±ï¼Œè®©æ‚¨æ›´å®¹æ˜“åœ°å®ç°ä¸­é—´å±‚è´Ÿè½½å‡è¡¡ã€æ›´çµæ´»çš„è·¯ç”±ç­–ç•¥ã€æµé‡æ§åˆ¶ä»¥åŠæ•°æ®ä¸­å¿ƒå†…ç½‘çš„ç®€å•DNSè§£ææœåŠ¡ã€‚åŠ¨æ€DNSæœåŠ¡è¿˜èƒ½è®©æ‚¨æ›´å®¹æ˜“åœ°å®ç°ä»¥ DNS åè®®ä¸ºåŸºç¡€çš„æœåŠ¡å‘ç°ï¼Œä»¥å¸®åŠ©æ‚¨æ¶ˆé™¤è€¦åˆåˆ°å‚å•†ç§æœ‰æœåŠ¡å‘ç° API ä¸Šçš„é£é™©ã€‚</p>
<p>Nacos æä¾›äº†ä¸€äº›ç®€å•çš„ <a href="https://nacos.io/zh-cn/docs/xx" target="_blank" rel="noopener noreferrer">DNS APIs TODO</a> å¸®åŠ©æ‚¨ç®¡ç†æœåŠ¡çš„å…³è”åŸŸåå’Œå¯ç”¨çš„ IP<!-- -->:PORT<!-- --> åˆ—è¡¨.</p>
</li>
<li>
<p><strong>æœåŠ¡åŠå…¶å…ƒæ•°æ®ç®¡ç†</strong></p>
<p>Nacos èƒ½è®©æ‚¨ä»å¾®æœåŠ¡å¹³å°å»ºè®¾çš„è§†è§’ç®¡ç†æ•°æ®ä¸­å¿ƒçš„æ‰€æœ‰æœåŠ¡åŠå…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ç®¡ç†æœåŠ¡çš„æè¿°ã€ç”Ÿå‘½å‘¨æœŸã€æœåŠ¡çš„é™æ€ä¾èµ–åˆ†æã€æœåŠ¡çš„å¥åº·çŠ¶æ€ã€æœåŠ¡çš„æµé‡ç®¡ç†ã€è·¯ç”±åŠå®‰å…¨ç­–ç•¥ã€æœåŠ¡çš„ SLA ä»¥åŠæœ€é¦–è¦çš„ metrics ç»Ÿè®¡æ•°æ®ã€‚</p>
</li>
</ul>
<p>æ®è¯´nacosåœ¨é˜¿é‡Œå·´å·´å†…éƒ¨æœ‰è¶…è¿‡10ä¸‡çš„å®ä¾‹è¿è¡Œï¼Œå·²ç»è¿‡äº†ç±»ä¼¼åŒåä¸€ç­‰å„ç§å¤§å‹æµé‡çš„è€ƒéªŒ.....</p>
<p><em>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ ç°åœ¨æœ‰ä¸€ä¸ªOrderè®¢å•çš„æœåŠ¡è¦å»è¿œç¨‹è°ƒç”¨Videoè§†é¢‘çš„æœåŠ¡å®Œæˆä¸‹å•æ“ä½œã€‚</em></p>
<p>OrderControllerç±»ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2023/1/31 17:26</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@RequestMapping("api/v1/order")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class OrderController {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RestTemplate restTemplate;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * ä¸‹å•çš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @GetMapping("/save/{id}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Object save(@PathVariable Integer id){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Video v = restTemplate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // è¿™é‡Œè·¯å¾„æ˜¯å†™æ­»çš„ å¦‚æœipå˜äº† æˆ‘ä»¬æ¯æ¬¡éƒ½è¦æ›´æ”¹æºç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .getForObject("http://127.0.0.1:9000/api/v1/video/getById/"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        + id, Video.class);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (v != null) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            VideoOrder.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    .videoId(v.getId())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    .videoTitle(v.getTitle())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    .createTime(new Date());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return ResponseUtil.resultMap(false,444,"ä¸‹å•å¤±è´¥");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return ResponseUtil.resultMap(true,200,"ä¸‹å•æˆåŠŸ"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                ,VideoOrder.VideoOrderBuilder.class);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>VideoControllerç±»</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2023/1/31 16:21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@RequestMapping("api/v1/video")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class VideoController {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VideoService videoService;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @GetMapping("getById/{id}")</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Object getById(@PathVariable Integer id){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Video video = videoService.getById(id);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return ResponseUtil.resultMap(true,200,"æŸ¥è¯¢æˆåŠŸ",video);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“OrderæœåŠ¡å»è°ƒç”¨VideoæœåŠ¡çš„æ—¶å€™ï¼Œ.getForObject("<a href="http://127.0.0.1:9000/api/v1/video/getById/%22+id" target="_blank" rel="noopener noreferrer">http://127.0.0.1:9000/api/v1/video/getById/"+id</a>, Video.class);è¿™é‡Œè·¯å¾„æ˜¯å†™æ­»çš„ ï¼Œå¦‚æœæœåŠ¡çš„ipæ¢äº†æˆ–è€…æ–°å¢å…¶ä»–æœåŠ¡ ï¼Œéœ€è¦æˆ‘ä»¬å»æ›´æ”¹æºç  ï¼Œå¾—ä¸å¿å¤±ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ä¸ªåº”ç”¨ï¼Œå¯ä»¥åœ¨OrderæœåŠ¡å®Œæˆä¸‹å•æ“ä½œæ—¶å°±çŸ¥é“å“ªäº›æœåŠ¡æ˜¯â€œæ´»ç€â€çš„å‘¢ï¼ŸNacosä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°éšæ—¶åº”è¿è€Œç”Ÿï¼Œæ‰€æœ‰æœåŠ¡å¯åŠ¨å‰éƒ½ä¼šæŠŠè‡ªå·±æ³¨å†Œåˆ°Nacosæ³¨å†Œä¸­å¿ƒè¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼ŒåŒæ—¶ï¼Œæ¯”å¦‚è®¢å•æœåŠ¡æƒ³å»è¿œç¨‹è°ƒç”¨æˆ‘ä»¬çš„å…¶ä»–æœåŠ¡ å¯ä»¥å»æ³¨å†Œä¸­å¿ƒæŸ¥æ‰¾è¿™äº›æœåŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œå®ç°åŠ¨æ€å»è·å–ä»–ä»¬çš„åœ°å€ï¼Œè¿™æ ·å°±é¿å…äº†è‡ªèº«æºç çš„æ”¹åŠ¨ï¼Œä¹Ÿä¸ºå®ç°è´Ÿè½½å‡è¡¡ç­‰å…¶ä»–åŠŸèƒ½æä¾›äº†åŸºç¡€ã€‚</p>
<p>æ€»ç»“</p>
<p>ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒï¼ˆæœåŠ¡æ²»ç†ï¼‰</p>
<ul>
<li>æœåŠ¡æ³¨å†Œï¼šæœåŠ¡æä¾›è€…providerï¼Œå¯åŠ¨çš„æ—¶å€™å‘æ³¨å†Œä¸­å¿ƒä¸ŠæŠ¥è‡ªå·±çš„ç½‘ç»œä¿¡æ¯<!-- -->
<ul>
<li>æœåŠ¡å‘ç°ï¼šæœåŠ¡æ¶ˆè´¹è€…consumer,å¯åŠ¨çš„æ—¶å€™å‘æ³¨å†Œä¸­å¿ƒä¸ŠæŠ¥è‡ªå·±çš„ç½‘ç»œä¿¡æ¯ï¼Œæ‹‰å–providerçš„ç›¸å…³ç½‘ç»œä¿¡æ¯</li>
</ul>
</li>
<li>æ ¸å¿ƒ:æœåŠ¡ç®¡ç†,æ˜¯æœ‰ä¸ªæœåŠ¡æ³¨å†Œè¡¨ï¼Œå¿ƒè·³æœºåˆ¶åŠ¨æ€ç»´æŠ¤ï¼ŒæœåŠ¡å®ä¾‹åœ¨å¯åŠ¨æ—¶æ³¨å†Œåˆ°æœåŠ¡æ³¨å†Œè¡¨ï¼Œå¹¶åœ¨å…³é—­æ—¶æ³¨é”€ã€‚</li>
</ul>
<p><img decoding="async" loading="lazy" alt="nacosMap" src="https://jachen99.github.io/assets/images/nacosMap-3c656c929f7f9c46ba81eb46125c51d8.jpg" width="1880" height="1198" class="img_ev3q"></p>
<ul>
<li>ç‰¹æ€§å¤§å›¾ï¼šè¦ä»åŠŸèƒ½ç‰¹æ€§ï¼ŒéåŠŸèƒ½ç‰¹æ€§ï¼Œå…¨é¢ä»‹ç»æˆ‘ä»¬è¦è§£çš„é—®é¢˜åŸŸçš„ç‰¹æ€§è¯‰æ±‚</li>
<li>æ¶æ„å¤§å›¾ï¼šé€šè¿‡æ¸…æ™°æ¶æ„ï¼Œè®©æ‚¨å¿«é€Ÿè¿›å…¥ Nacos ä¸–ç•Œ</li>
<li>ä¸šåŠ¡å¤§å›¾ï¼šåˆ©ç”¨å½“å‰ç‰¹æ€§å¯ä»¥æ”¯æŒçš„ä¸šåŠ¡åœºæ™¯ï¼ŒåŠå…¶æœ€ä½³å®è·µ</li>
<li>ç”Ÿæ€å¤§å›¾ï¼šç³»ç»Ÿæ¢³ç† Nacos å’Œä¸»æµæŠ€æœ¯ç”Ÿæ€çš„å…³ç³»</li>
<li>ä¼˜åŠ¿å¤§å›¾ï¼šå±•ç¤º Nacos æ ¸å¿ƒç«äº‰åŠ›</li>
<li>æˆ˜ç•¥å¤§å›¾ï¼šè¦ä»æˆ˜ç•¥åˆ°æˆ˜æœ¯å±‚é¢è®² Nacos çš„å®è§‚ä¼˜åŠ¿</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆè¦ç”¨</strong></p>
<ul>
<li>å¾®æœåŠ¡åº”ç”¨å’Œæœºå™¨è¶Šæ¥è¶Šå¤šï¼Œè°ƒç”¨æ–¹éœ€è¦çŸ¥é“æ¥å£çš„ç½‘ç»œåœ°å€ï¼Œå¦‚æœé é…ç½®æ–‡ä»¶çš„æ–¹å¼å»æ§åˆ¶ç½‘ç»œåœ°å€ï¼Œå¯¹äºåŠ¨æ€æ–°å¢æœºå™¨ï¼Œç»´æŠ¤å¸¦æ¥å¾ˆå¤§é—®é¢˜</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacosæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢">Nacosæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿ<a href="https://jachen99.github.io/blog/product-nacos-service-management#nacos%E6%98%AF%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8%E7%9A%84%E5%91%A2" class="hash-link" aria-label="Nacosæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿçš„ç›´æ¥é“¾æ¥" title="Nacosæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1å®‰è£…">1ã€å®‰è£…<a href="https://jachen99.github.io/blog/product-nacos-service-management#1%E5%AE%89%E8%A3%85" class="hash-link" aria-label="1ã€å®‰è£…çš„ç›´æ¥é“¾æ¥" title="1ã€å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>1.1 Linux/Macå®‰è£…Nacos</p>
<ul>
<li>è§£å‹å®‰è£…åŒ…</li>
<li>è¿›å…¥binç›®å½•</li>
<li>å¯åŠ¨ sh startup.sh -m standalone</li>
<li>è®¿é—® localhost:8848/nacos/index.html</li>
<li>é»˜è®¤è´¦å·å¯†ç  nacos/nacos</li>
</ul>
<p>1.2 Winå®‰è£…</p>
<ul>
<li>è§£å‹å®‰è£…åŒ…</li>
<li>è¿›å…¥binç›®å½•</li>
<li>å¯åŠ¨ startup.cmd -m standalone</li>
<li>è®¿é—® localhost:8848/nacos/index.html</li>
<li>é»˜è®¤è´¦å·å¯†ç  nacos/nacos</li>
</ul>
<p>é»˜è®¤ï¼šMODE="cluster"é›†ç¾¤æ–¹å¼å¯åŠ¨ï¼Œå¦‚æœå•æœºå¯åŠ¨éœ€è¦è®¾ç½®-m tandaloneå‚æ•°ï¼Œå¦åˆ™ï¼Œå¯åŠ¨å¤±è´¥ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2ç™»å½•é¡µé¢">2ã€ç™»å½•é¡µé¢<a href="https://jachen99.github.io/blog/product-nacos-service-management#2%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2" class="hash-link" aria-label="2ï¿½ã€ç™»å½•é¡µé¢çš„ç›´æ¥é“¾æ¥" title="2ã€ç™»å½•é¡µé¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="http://localhost:8848/nacos/index.html#/login" target="_blank" rel="noopener noreferrer">http://localhost:8848/nacos/index.html#/login</a></p>
<p><img decoding="async" loading="lazy" alt="image-20230131223518460" src="https://jachen99.github.io/assets/images/image-20230131223518460-6897647a81cb06dc0ed4f300747493d3.png" width="1371" height="557" class="img_ev3q"></p>
<p>æœç„¶æ˜¯å›½å†…çš„æŠ€æœ¯ é¡µé¢çœ‹ç€å°±æ˜¯äº²åˆ‡~</p>
<p>å®˜ç½‘æ–‡æ¡£:<a href="https://spring.io/projects/spring-cloud-alibaba#learn" target="_blank" rel="noopener noreferrer">https://spring.io/projects/spring-cloud-alibaba#learn</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3é…ç½®">3ã€é…ç½®<a href="https://jachen99.github.io/blog/product-nacos-service-management#3%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="3ã€é…ç½®çš„ç›´æ¥é“¾æ¥" title="3ã€é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>3.1åœ¨OrderæœåŠ¡å’ŒVideoæœåŠ¡éƒ½ æ·»åŠ ç›¸å…³ä¾èµ–</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--æ·»åŠ nacoså®¢æˆ·ç«¯--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.2 åœ¨ymlæ–‡ä»¶é…ç½®server-addr</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">cloud</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">nacos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">server-addr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 127.0.0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">8848</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.3 åœ¨å¯åŠ¨ç±»ä¸Šå¼€å¯æœåŠ¡æ³¨å†Œ</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@EnableDiscoveryClient</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠè¿™ä¿©ä¸ªæœåŠ¡æ³¨å†Œåˆ°äº†Nacosä¸Š</p>
<p><img decoding="async" loading="lazy" alt="image-20230131230001317" src="https://jachen99.github.io/assets/images/image-20230131230001317-db074c0e0b27d0768bf68cc67f1bf28e.png" width="1888" height="555" class="img_ev3q"></p>
<p>3.4 å¼•å…¥DiscoveryClientç”¨äºæŸ¥æ‰¾æœåŠ¡çš„å®¢æˆ·ç«¯å¹¶ä¿®æ”¹OrderController.java</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// è·å–æœåŠ¡åˆ—è¡¨ (å¯èƒ½æ˜¯é›†ç¾¤)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;ServiceInstance&gt; instanceList = discoveryClient</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .getInstances("jachen-video-service");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ServiceInstance instance = instanceList.get(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Video v = restTemplate.getForObject(instance.getUri()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                + "/api/v1/video/getById/" + id, Video.class);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.5 Nacosæ€ä¹ˆå¼€å¯è´Ÿè½½å‡è¡¡å‘¢ï¼Ÿ</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * è¿œç¨‹è°ƒç”¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return RestTemplateå¯¹è±¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // åœ¨RestTemplateè¯·æ±‚çš„æ—¶å€™å¼€å¯è´Ÿè½½å‡è¡¡ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @LoadBalanced</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public RestTemplate getRestTemplate(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return new RestTemplate();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸€ä¸ªæ³¨è§£å°±æå®šäº†ã€‚ä½¿ç”¨Ribbonå¯ä»¥è¿™æ ·ç›´æ¥æŒ‡å®šæœåŠ¡å</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è·å–æœåŠ¡åˆ—è¡¨ (å¯èƒ½æ˜¯é›†ç¾¤)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;ServiceInstance&gt; instanceList = discoveryClient</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .getInstances("jachen-video-service");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Video v = restTemplate.getForObject("http://jachen-video-service"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                + "/api/v1/video/getById/" + id, Video.class);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ºä»€ä¹ˆå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡å‘¢ï¼Ÿ</p>
<p><img decoding="async" loading="lazy" alt="image-20230131233001382" src="https://jachen99.github.io/assets/images/image-20230131233001382-0e8384fbd244df87a97a4c7010fe6fdb.png" width="1015" height="679" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“ï¼š<a href="https://jachen99.github.io/blog/product-nacos-service-management#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="æ€»ç»“ï¼šçš„ç›´æ¥é“¾æ¥" title="æ€»ç»“ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Nacosæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚</li>
<li>åŠŸèƒ½å…¨é¢ï¼šNacosä¸ä»…æ”¯æŒæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œè¿˜æ”¯æŒé…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†ã€‚</li>
<li>æ˜“äºä½¿ç”¨ï¼šNacosçš„æ¥å£ç®€æ´æ˜äº†ï¼Œå®¹æ˜“ä¸Šæ‰‹ã€‚</li>
<li>æ€§èƒ½ä¼˜ç§€ï¼šNacosé‡‡ç”¨äº†é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼æ¶æ„ï¼Œèƒ½å¤Ÿæ‰¿å—å¤§é‡çš„æœåŠ¡æ³¨å†Œä¸æŸ¥è¯¢ã€‚</li>
<li>æ´»è·ƒçš„ç¤¾åŒºï¼šNacosæœ‰æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒï¼Œé—®é¢˜èƒ½å¤Ÿå¾—åˆ°å¿«é€Ÿè§£å†³ã€‚</li>
</ol>]]></content:encoded>
            <category>æ³¨å†Œä¸­å¿ƒ</category>
            <category>Nacos</category>
        </item>
        <item>
            <title><![CDATA[Redisç¼“å­˜å¸¸è§å¼‚å¸¸åŠè§£å†³æ–¹æ¡ˆ]]></title>
            <link>https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions</link>
            <guid>https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions</guid>
            <pubDate>Tue, 27 Dec 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ï¼šRedisæ˜¯ä¸€ç§æµè¡Œçš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ï¼Œå¹¿æ³›ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚Redis ä¸»è¦ç”¨æ¥åšç¼“å­˜ä½¿ç”¨ï¼Œåœ¨æé«˜æ•°æ®æŸ¥è¯¢æ•ˆç‡ã€ä¿æŠ¤æ•°æ®åº“ç­‰æ–¹é¢èµ·åˆ°äº†å…³é”®æ€§çš„ä½œç”¨ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚å½“ç„¶åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šå‡ºç°ä¸€äº›å¼‚å¸¸æƒ…æ™¯ï¼Œå¯¼è‡´ Redis å¤±å»ç¼“å­˜ä½œç”¨ã€‚]]></description>
            <content:encoded><![CDATA[<p><strong>èƒŒæ™¯</strong>ï¼š<em>Redisæ˜¯ä¸€ç§æµè¡Œçš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ï¼Œå¹¿æ³›ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚Redis ä¸»è¦ç”¨æ¥åšç¼“å­˜ä½¿ç”¨ï¼Œåœ¨æé«˜æ•°æ®æŸ¥è¯¢æ•ˆç‡ã€ä¿æŠ¤æ•°æ®åº“ç­‰æ–¹é¢èµ·åˆ°äº†å…³é”®æ€§çš„ä½œç”¨ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚å½“ç„¶åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šå‡ºç°ä¸€äº›å¼‚å¸¸æƒ…æ™¯ï¼Œå¯¼è‡´ Redis å¤±å»ç¼“å­˜ä½œç”¨ã€‚</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rediså¸¸è§åº”ç”¨">Rediså¸¸è§åº”ç”¨<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#redis%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8" class="hash-link" aria-label="Rediså¸¸è§åº”ç”¨çš„ç›´æ¥é“¾æ¥" title="Rediså¸¸è§åº”ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>ç¼“å­˜ï¼šRedisé€šå¸¸ç”¨ä½œç¼“å­˜ï¼Œä»¥å­˜å‚¨å¸¸ç”¨æ•°æ®ï¼Œä»¥å‡å°‘æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°ã€‚</li>
<li>ä¼šè¯ç®¡ç†ï¼šRedisç”¨äºå­˜å‚¨Webåº”ç”¨ç¨‹åºä¸­çš„ç”¨æˆ·ä¼šè¯æ•°æ®ã€‚</li>
<li>å®æ—¶åˆ†æï¼šRedisç”¨äºå¤„ç†å’Œåˆ†æå¤§é‡çš„å®æ—¶æ•°æ®ã€‚</li>
<li>é˜Ÿåˆ—ç®¡ç†ï¼šRedisç”¨äºå®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä»¥å¼‚æ­¥åˆ†å‘å’Œå¤„ç†ä»»åŠ¡ã€‚</li>
<li>æ’è¡Œæ¦œå’Œè®¡æ•°ï¼šRedisç”¨äºç»´æŠ¤æ¸¸æˆã€ç¤¾äº¤åª’ä½“å’Œå…¶ä»–åº”ç”¨ä¸­é¡¹ç›®çš„å®æ—¶æ’åå’Œè®¡æ•°ã€‚</li>
<li>å‘å¸ƒ/è®¢é˜…æ¶ˆæ¯ï¼šRedisæ”¯æŒå‘å¸ƒ/è®¢é˜…æ¶ˆæ¯æ¨¡å¼ï¼Œå¹¶ç”¨äºå®æ—¶èŠå¤©å’Œé€šçŸ¥ç³»ç»Ÿã€‚</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rediså¸¸è§ç¼“å­˜å¼‚å¸¸">Rediså¸¸è§ç¼“å­˜å¼‚å¸¸<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#redis%E5%B8%B8%E8%A7%81%E7%BC%93%E5%AD%98%E5%BC%82%E5%B8%B8" class="hash-link" aria-label="Rediså¸¸è§ç¼“å­˜å¼‚å¸¸çš„ç›´æ¥é“¾æ¥" title="Rediså¸¸è§ç¼“å­˜å¼‚å¸¸çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç¼“å­˜é›ªå´© ç¼“å­˜ç©¿é€ ç¼“å­˜å‡»ç©¿</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1ç¼“å­˜é›ªå´©">1ã€ç¼“å­˜é›ªå´©<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#1%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9" class="hash-link" aria-label="1ã€ç¼“å­˜é›ªå´©çš„ç›´æ¥é“¾æ¥" title="1ã€ç¼“å­˜é›ªå´©çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="11ç°è±¡">1.1ç°è±¡<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#11%E7%8E%B0%E8%B1%A1" class="hash-link" aria-label="1.1ç°è±¡çš„ç›´æ¥é“¾æ¥" title="1.1ç°è±¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ul>
<li>å‘ç”Ÿåœ¨ç¼“å­˜æ•°æ®åœ¨åŒä¸€æ—¶åˆ»å¤§é‡å¤±æ•ˆï¼Œæ¯”å¦‚ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºåŒä¸€æ—¶åˆ»ã€‚</li>
<li>ç”±äºç¼“å­˜ä¸­çš„æ•°æ®å¤±æ•ˆï¼Œå¤§é‡çš„è¯·æ±‚ç›´æ¥è¯·æ±‚åç«¯æ•°æ®ï¼Œå¯¼è‡´ç³»ç»Ÿè¯·æ±‚é‡ç¬é—´å¢åŠ ï¼Œé€ æˆç³»ç»Ÿå‹åŠ›è¿‡å¤§ï¼Œä»è€Œå®•æœºã€‚</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230130104242186" src="https://jachen99.github.io/assets/images/image-20230130104242186-e4f0b4b1debe0d650cdbca530f870ef7.png" width="466" height="217" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="12åŸå› ">1.2åŸå› <a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#12%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="1.2åŸå› çš„ç›´æ¥é“¾æ¥" title="1.2åŸå› çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ul>
<li>ç¼“å­˜æœåŠ¡ä¸å¯ç”¨ã€‚</li>
<li>ç¼“å­˜æœåŠ¡å¯ç”¨ï¼Œä½†æ˜¯å¤§é‡ KEY åŒæ—¶å¤±æ•ˆã€‚</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="13è§£å†³æ–¹æ¡ˆ">1.3è§£å†³æ–¹æ¡ˆ<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#13%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" class="hash-link" aria-label="1.3è§£å†³æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥" title="1.3è§£å†³æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>ç¼“å­˜æœåŠ¡ä¸å¯ç”¨
redis çš„éƒ¨ç½²æ–¹å¼ä¸»è¦æœ‰å•æœºã€ä¸»ä»ã€å“¨å…µå’Œ cluster æ¨¡å¼ã€‚</li>
</ol>
<ul>
<li>å•æœº
åªæœ‰ä¸€å°æœºå™¨ï¼Œæ‰€æœ‰æ•°æ®éƒ½å­˜åœ¨è¿™å°æœºå™¨ä¸Šï¼Œå½“æœºå™¨å‡ºç°å¼‚å¸¸æ—¶ï¼Œredis å°†å¤±æ•ˆï¼Œå¯èƒ½ä¼šå¯¼è‡´ redis ç¼“å­˜é›ªå´©ã€‚</li>
<li>ä¸»ä»
ä¸»ä»å…¶å®å°±æ˜¯ä¸€å°æœºå™¨åšä¸»ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªæœºå™¨åšä»ï¼Œä»èŠ‚ç‚¹ä»ä¸»èŠ‚ç‚¹å¤åˆ¶æ•°æ®ï¼Œå¯ä»¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œä¸»èŠ‚ç‚¹åšå†™ï¼Œä»èŠ‚ç‚¹åšè¯»ã€‚
ä¼˜ç‚¹ï¼šå½“æŸä¸ªä»èŠ‚ç‚¹å¼‚å¸¸æ—¶ï¼Œä¸å½±å“ä½¿ç”¨ã€‚
ç¼ºç‚¹ï¼šå½“ä¸»èŠ‚ç‚¹å¼‚å¸¸æ—¶ï¼ŒæœåŠ¡å°†ä¸å¯ç”¨ã€‚</li>
<li>å“¨å…µ
å“¨å…µæ¨¡å¼ä¹Ÿæ˜¯ä¸€ç§ä¸»ä»ï¼Œåªä¸è¿‡å¢åŠ äº†å“¨å…µçš„åŠŸèƒ½ï¼Œç”¨äºç›‘æ§ä¸»èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå½“ä¸»èŠ‚ç‚¹å®•æœºä¹‹åä¼šè¿›è¡ŒæŠ•ç¥¨åœ¨ä»èŠ‚ç‚¹ä¸­é‡æ–°é€‰å‡ºä¸»èŠ‚ç‚¹ã€‚
ä¼˜ç‚¹ï¼šé«˜å¯ç”¨ï¼Œå½“ä¸»èŠ‚ç‚¹å¼‚å¸¸æ—¶ï¼Œè‡ªåŠ¨åœ¨ä»èŠ‚ç‚¹å½“ä¸­é€‰æ‹©ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚
ç¼ºç‚¹ï¼šåªæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œå½“æ•°æ®æ¯”è¾ƒå¤šæ—¶ï¼Œä¸»èŠ‚ç‚¹å‹åŠ›ä¼šå¾ˆå¤§ã€‚</li>
<li>cluster æ¨¡å¼
é›†ç¾¤é‡‡ç”¨äº†å¤šä¸»å¤šä»ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œåˆ†ç‰‡ï¼Œå°†æ•°æ®åˆ†åˆ«å­˜å‚¨ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å“¨å…µæ¨¡å¼ä¸‹å•æœºå­˜å‚¨æœ‰é™çš„é—®é¢˜ã€‚
ä¼˜ç‚¹ï¼šé«˜å¯ç”¨ï¼Œé…ç½®äº†å¤šä¸»å¤šä»ï¼Œå¯ä»¥ä½¿æ•°æ®åˆ†åŒºï¼Œå»ä¸­å¿ƒåŒ–ï¼Œå‡å°äº†å•å°æœºå­çš„è´Ÿæ‹….
ç¼ºç‚¹ï¼šæœºå™¨èµ„æºä½¿ç”¨æ¯”è¾ƒå¤šï¼Œé…ç½®å¤æ‚ã€‚</li>
<li>å°ç»“
ä»é«˜å¯ç”¨å¾—è§’åº¦è€ƒè™‘ï¼Œä½¿ç”¨å“¨å…µæ¨¡å¼å’Œ cluster æ¨¡å¼å¯ä»¥é˜²æ­¢å› ä¸º redis ä¸å¯ç”¨å¯¼è‡´çš„ç¼“å­˜é›ªå´©é—®é¢˜ã€‚</li>
</ul>
<ol start="2">
<li>å¤§é‡ KEY åŒæ—¶å¤±æ•ˆ
å¯ä»¥é€šè¿‡è®¾ç½®æ°¸ä¸å¤±æ•ˆã€è®¾ç½®ä¸åŒå¤±æ•ˆæ—¶é—´ã€ä½¿ç”¨äºŒçº§ç¼“å­˜å’Œå®šæ—¶æ›´æ–°ç¼“å­˜å¤±æ•ˆæ—¶é—´</li>
</ol>
<ul>
<li>è®¾ç½®æ°¸ä¸å¤±æ•ˆ
å¦‚æœæ‰€æœ‰çš„ key éƒ½è®¾ç½®ä¸å¤±æ•ˆï¼Œä¸å°±ä¸ä¼šå‡ºç°å› ä¸º KEY å¤±æ•ˆå¯¼è‡´çš„ç¼“å­˜é›ªå´©é—®é¢˜äº†ã€‚redis è®¾ç½® key æ°¸è¿œæœ‰æ•ˆçš„å‘½ä»¤å¦‚ä¸‹ï¼š
PERSIST key
ç¼ºç‚¹ï¼šä¼šå¯¼è‡´ redis çš„ç©ºé—´èµ„æºéœ€æ±‚å˜å¤§ã€‚</li>
<li>è®¾ç½®éšæœºå¤±æ•ˆæ—¶é—´
å¦‚æœ key çš„å¤±æ•ˆæ—¶é—´ä¸ç›¸åŒï¼Œå°±ä¸ä¼šåœ¨åŒä¸€æ—¶åˆ»å¤±æ•ˆï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°å¤§é‡è®¿é—®æ•°æ®åº“çš„æƒ…å†µã€‚
redis è®¾ç½® key æœ‰æ•ˆæ—¶é—´å‘½ä»¤å¦‚ä¸‹ï¼š
Expire key
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼Œé€šè¿‡ RedisClient å®ç°</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* éšæœºè®¾ç½®å°äº30åˆ†é’Ÿçš„å¤±æ•ˆæ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @param redisKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @param value</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">private void setRandomTimeForReidsKey(String redisKey,String value){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//éšæœºå‡½æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Random rand = new Random();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//éšæœºè·å–30åˆ†é’Ÿå†…ï¼ˆ30*60ï¼‰çš„éšæœºæ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int times = rand.nextInt(1800);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//è®¾ç½®ç¼“å­˜æ—¶é—´ï¼ˆç¼“å­˜çš„key,ç¼“å­˜çš„å€¼ï¼Œå¤±æ•ˆæ—¶é—´ï¼šå•ä½ç§’ï¼‰</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">redisClient.setNxEx(redisKey,value,times);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>ä½¿ç”¨äºŒçº§ç¼“å­˜
äºŒçº§ç¼“å­˜æ˜¯ä½¿ç”¨ä¸¤ç»„ç¼“å­˜ï¼Œ1 çº§ç¼“å­˜å’Œ 2 çº§ç¼“å­˜ï¼ŒåŒä¸€ä¸ª Key åœ¨ä¸¤ç»„ç¼“å­˜é‡Œéƒ½ä¿å­˜ï¼Œä½†æ˜¯ä»–ä»¬çš„å¤±æ•ˆæ—¶é—´ä¸åŒï¼Œè¿™æ · 1 çº§ç¼“å­˜æ²¡æœ‰æŸ¥åˆ°æ•°æ®æ—¶ï¼Œå¯ä»¥åœ¨äºŒçº§ç¼“å­˜é‡ŒæŸ¥è¯¢ï¼Œä¸ä¼šç›´æ¥è®¿é—®æ•°æ®åº“ã€‚
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CacheTest test = new CacheTest();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä»1çº§ç¼“å­˜ä¸­è·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String value = test.queryByOneCacheKey("key");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœ1çº§ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼Œå†äºŒçº§ç¼“å­˜ä¸­æŸ¥æ‰¾</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isBlank(value)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">value = test.queryBySecondCacheKey("key");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœäºŒçº§ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œä»æ•°æ®åº“ä¸­æŸ¥æ‰¾</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isBlank(value)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">value =test.getFromDb();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœæ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰ï¼Œå°±è¿”å›ç©º</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isBlank(value)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System.out.println("æ•°æ®ä¸å­˜åœ¨!");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//äºŒçº§ç¼“å­˜ä¸­ä¿å­˜æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">test.secondCacheSave("key",value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä¸€çº§ç¼“å­˜ä¸­ä¿å­˜æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">test.oneCacheSave("key",value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System.out.println("æ•°æ®åº“ä¸­è¿”å›æ•°æ®!");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä¸€çº§ç¼“å­˜ä¸­ä¿å­˜æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">test.oneCacheSave("key",value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System.out.println("äºŒçº§ç¼“å­˜ä¸­è¿”å›æ•°æ®!");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System.out.println("ä¸€çº§ç¼“å­˜ä¸­è¿”å›æ•°æ®!");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>å¼‚æ­¥æ›´æ–°ç¼“å­˜æ—¶é—´</p>
<p>æ¯æ¬¡è®¿é—®ç¼“å­˜æ—¶ï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æˆ–è€…å»ºç«‹ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ¥ï¼Œæ›´æ–°ç¼“å­˜æ—¶é—´ã€‚</p>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class CacheRunnable implements Runnable {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">private ClusterRedisClientAdapter redisClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* è¦æ›´æ–°çš„key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public String key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public CacheRunnable(String key){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">this.key =key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void run() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//æ›´ç»†ç¼“å­˜æ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">redisClient.expire(this.getKey(),1800);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public String getKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void setKey(String key) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">this.key = key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CacheTest test = new CacheTest();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä»ç¼“å­˜ä¸­è·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String value = test.getFromCache("key");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isBlank(value)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä»æ•°æ®åº“ä¸­è·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">value = test.getFromDb("key");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å°†æ•°æ®æ”¾åœ¨ç¼“å­˜ä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">test.oneCacheSave("key",value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//è¿”å›æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System.out.println("è¿”å›æ•°æ®");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¼‚æ­¥ä»»åŠ¡æ›´æ–°ç¼“å­˜</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CacheRunnable runnable = new CacheRunnable("key");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">runnable.run();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//è¿”å›æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System.out.println("è¿”å›æ•°æ®");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2ç¼“å­˜ç©¿é€">2ã€ç¼“å­˜ç©¿é€<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#2%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F" class="hash-link" aria-label="2ã€ç¼“å­˜ç©¿é€çš„ç›´æ¥é“¾æ¥" title="2ã€ç¼“å­˜ç©¿é€çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="21ç°è±¡">2.1ç°è±¡<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#21%E7%8E%B0%E8%B1%A1" class="hash-link" aria-label="2.1ç°è±¡çš„ç›´æ¥é“¾æ¥" title="2.1ç°è±¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ul>
<li>å‘ç”Ÿåœ¨è¯·æ±‚çš„æ•°æ®ä¸å­˜åœ¨äºç¼“å­˜ï¼Œä½†æ˜¯è¯·æ±‚ä¾ç„¶ä¼šåˆ°è¾¾åç«¯æœåŠ¡å™¨ã€‚</li>
<li>ç”±äºè¯·æ±‚çš„æ•°æ®ä¸å­˜åœ¨ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ°è¾¾åç«¯æœåŠ¡å™¨ï¼Œå¯¼è‡´å¤§é‡çš„æ— æ•ˆè¯·æ±‚ï¼Œå¢åŠ äº†åç«¯çš„å‹åŠ›ã€‚</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20230130110129433" src="https://jachen99.github.io/assets/images/image-20230130110129433-feec4a9784b5878620fadfead17e626d.png" width="442" height="207" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="22å¼‚å¸¸åŸå› ">2.2å¼‚å¸¸åŸå› <a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#22%E5%BC%82%E5%B8%B8%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="2.2å¼‚å¸¸åŸå› çš„ç›´æ¥é“¾æ¥" title="2.2å¼‚å¸¸åŸå› çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ul>
<li>éæ³•è°ƒç”¨</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="23è§£å†³æ–¹æ¡ˆ">2.3è§£å†³æ–¹æ¡ˆ<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#23%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" class="hash-link" aria-label="2.3è§£å†³æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥" title="2.3è§£å†³æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>å¯¹äºä¸å­˜åœ¨çš„æ•°æ®è®¾ç½®ä¸€ä¸ªç©ºå€¼ï¼Œè®¾ç½®æœ‰æ•ˆæœŸ</li>
<li>å¯¹è¯·æ±‚æ•°æ®åšé™æµ</li>
<li>å“ˆå¸Œ/å¸ƒéš†è¿‡æ»¤å™¨é¢„å¤„ç†</li>
<li>ä½¿ç”¨å¸ƒå°”å€¼è¿›è¡Œæ ‡è¯†ï¼ˆä¾‹å¦‚ï¼š0æˆ–1ï¼‰è¡¨ç¤ºæ•°æ®æ˜¯å¦å­˜åœ¨</li>
<li>åŒé‡æ£€æŸ¥æœºåˆ¶ï¼ˆCache Aside Patternï¼‰</li>
</ol>
<p><em>TODO è¿™é‡Œåªå†™äº†ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå‰©ä¸‹çš„ä»¥åè¡¥å……...</em></p>
<ul>
<li>ç¼“å­˜ç©ºå€¼
å½“ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰å€¼æ—¶ï¼Œå¯ä»¥åœ¨ç¼“å­˜ä¸­å­˜æ”¾ä¸€ä¸ªç©ºå€¼ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘é‡å¤æŸ¥è¯¢ç©ºå€¼å¼•èµ·çš„ç³»ç»Ÿå‹åŠ›å¢å¤§ï¼Œä»è€Œä¼˜åŒ–äº†ç¼“å­˜ç©¿é€é—®é¢˜ã€‚
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">private String queryMessager(String key){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä»ç¼“å­˜ä¸­è·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String message = getFromCache(key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ ä»æ•°æ®åº“ä¸­æŸ¥æ‰¾</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isBlank(message)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message = getFromDb(key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœæ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰æ•°æ® å°±è®¾ç½®çŸ­æ—¶é—´çš„ç¼“å­˜</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isBlank(message)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//è®¾ç½®ç¼“å­˜æ—¶é—´ï¼ˆç¼“å­˜çš„key,ç¼“å­˜çš„å€¼ï¼Œå¤±æ•ˆæ—¶é—´ï¼šå•ä½ç§’ï¼‰</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">redisClient.setNxEx(key,null,60);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">redisClient.setNxEx(key,message,1800);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return message;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç¼ºç‚¹ï¼šå¤§é‡çš„ç©ºç¼“å­˜å¯¼è‡´èµ„æºçš„æµªè´¹ï¼Œä¹Ÿæœ‰å¯èƒ½å¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“ä¸­çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3ç¼“å­˜å‡»ç©¿">3ã€ç¼“å­˜å‡»ç©¿<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#3%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF" class="hash-link" aria-label="3ã€ç¼“å­˜å‡»ç©¿çš„ç›´æ¥é“¾æ¥" title="3ã€ç¼“å­˜å‡»ç©¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="31ç°è±¡">3.1ç°è±¡<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#31%E7%8E%B0%E8%B1%A1" class="hash-link" aria-label="3.1ç°è±¡çš„ç›´æ¥é“¾æ¥" title="3.1ç°è±¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å½“ä¸€ä¸ªé«˜æµé‡çš„è¯·æ±‚è®¿é—®åŒä¸€ä¸ªç¼“å­˜æ•°æ®æ—¶ï¼Œå¦‚æœè¯¥æ•°æ®çš„ç¼“å­˜å¤±æ•ˆï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œé€ æˆæ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚</p>
<p>ä¸ç¼“å­˜ç©¿é€åŒºåˆ«ï¼šç¼“å­˜å‡»ç©¿æ˜¯å› ä¸ºæŸä¸ªæ•°æ®è¢«å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´å…¶ç¼“å­˜å¤±æ•ˆï¼Œä»è€Œæ‰“å‡»æ•°æ®åº“ï¼›ç¼“å­˜ç©¿é€æ˜¯å› ä¸ºè¯·æ±‚äº†ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è®¿é—®æ•°æ®åº“ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20230130111239309" src="https://jachen99.github.io/assets/images/image-20230130111239309-55a5b514708d305b7d9938695fc84f32.png" width="449" height="221" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="32å¼‚å¸¸åŸå› ">3.2å¼‚å¸¸åŸå› <a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#32%E5%BC%82%E5%B8%B8%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="3.2å¼‚å¸¸åŸå› çš„ç›´æ¥é“¾æ¥" title="3.2å¼‚å¸¸åŸå› çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ul>
<li>çƒ­ç‚¹ KEY å¤±æ•ˆçš„åŒæ—¶ï¼Œå¤§é‡<strong>ç›¸åŒ</strong> KEY è¯·æ±‚åŒæ—¶è®¿é—®ã€‚</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="33è§£å†³æ–¹æ¡ˆ">3.3è§£å†³æ–¹æ¡ˆ<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#33%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" class="hash-link" aria-label="3.3è§£å†³æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥" title="3.3è§£å†³æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>åŠ é”æœºåˆ¶ï¼šå¯¹äºç‰¹å®šçš„æ•°æ®è¯·æ±‚åŠ é”ï¼Œé¿å…å¤§é‡è¯·æ±‚é€ æˆçš„ç¼“å­˜å¤±æ•ˆã€‚</li>
<li>åˆ†å¸ƒå¼é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”æ¥ç¡®ä¿å¯¹ç‰¹å®šæ•°æ®çš„æ›´æ–°æ“ä½œæ˜¯åŸå­æ€§çš„ã€‚</li>
<li>åå¤‡æœºåˆ¶ï¼šåœ¨ç¼“å­˜å¤±æ•ˆæ—¶ä½¿ç”¨åå¤‡æœºåˆ¶ï¼Œä¿è¯ç¼“å­˜è¯·æ±‚èƒ½å¤Ÿå¾—åˆ°å“åº”ã€‚</li>
<li>é™æµæœºåˆ¶ï¼šå¯¹è¯·æ±‚æ•°æ®è¿›è¡Œé™æµï¼Œé˜²æ­¢å¤§é‡è¯·æ±‚é€ æˆçš„å‹åŠ›ã€‚</li>
<li>å¯¹äºè¿‡æœŸçš„æ•°æ®è¿›è¡Œå¼‚æ­¥åˆ é™¤ï¼šé¿å…å› æ•°æ®è¿‡æœŸå¯¼è‡´çš„ç¼“å­˜å‡»ç©¿ã€‚</li>
</ol>
<ul>
<li>
<p>åˆ†å¸ƒå¼é”</p>
<p>ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ 1 ä¸ªè¯·æ±‚å¯ä»¥è®¿é—®åˆ°æ•°æ®åº“ï¼Œå…¶ä»–è¯·æ±‚ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œé‡å¤è°ƒç”¨ã€‚</p>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹</p>
</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* æ ¹æ®keyè·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @param key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @throws InterruptedException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public String queryForMessage(String key) throws InterruptedException {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//åˆå§‹åŒ–è¿”å›ç»“æœ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String result = StringUtils.EMPTY;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä»ç¼“å­˜ä¸­è·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">result = queryByOneCacheKey(key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isNotBlank(result)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return result;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//è·å–åˆ†å¸ƒå¼é”</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(lockByBusiness(key)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//ä»æ•°æ®åº“ä¸­è·å–æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">result = getFromDb(key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœæ•°æ®åº“ä¸­æœ‰æ•°æ®ï¼Œå°±åŠ åœ¨ç¼“å­˜ä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(StringUtils.isNotBlank(result)){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">oneCacheSave(key,result);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//å¦‚æœæ²¡æœ‰è·å–åˆ°åˆ†å¸ƒå¼é”ï¼Œç¡çœ ä¸€ä¸‹ï¼Œå†æ¥ç€æŸ¥è¯¢æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Thread.sleep(500);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return queryForMessage(key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return result;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿˜å¯ä»¥é¢„å…ˆè®¾ç½®çƒ­é—¨æ•°æ®ï¼Œé€šè¿‡ä¸€äº›ç›‘æ§æ–¹æ³•ï¼ŒåŠæ—¶æ”¶é›†çƒ­ç‚¹æ•°æ®ï¼Œå°†æ•°æ®é¢„å…ˆä¿å­˜åœ¨ç¼“å­˜ä¸­ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>ç¼“å­˜é›ªå´©æ˜¯å› ä¸ºç¼“å­˜æ•°æ®çš„å¤±æ•ˆå¯¼è‡´çš„è¯·æ±‚å¢åŠ ï¼Œé€ æˆç³»ç»Ÿå‹åŠ›è¿‡å¤§ï¼Œå®•æœºã€‚</li>
<li>ç¼“å­˜ç©¿é€æ˜¯å› ä¸ºè¯·æ±‚çš„æ•°æ®ä¸å­˜åœ¨ï¼Œå¯¼è‡´è¯·æ±‚ç›´æ¥åˆ°è¾¾åç«¯ï¼Œå¢åŠ äº†åç«¯çš„å‹åŠ›ã€‚</li>
<li>ç¼“å­˜å‡»ç©¿æ˜¯å› ä¸ºæŸä¸ªæ•°æ®è¢«å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´å…¶ç¼“å­˜å¤±æ•ˆï¼Œä»è€Œæ‰“å‡»æ•°æ®åº“ã€‚</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å…¶ä»–å¸¸è§çš„redisé”™è¯¯åŠå…¶è§£å†³æ–¹æ³•">å…¶ä»–å¸¸è§çš„Redisé”™è¯¯åŠå…¶è§£å†³æ–¹æ³•ï¼š<a href="https://jachen99.github.io/blog/talk-about-redis-cache-exceptions-and-solutions#%E5%85%B6%E4%BB%96%E5%B8%B8%E8%A7%81%E7%9A%84redis%E9%94%99%E8%AF%AF%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95" class="hash-link" aria-label="å…¶ä»–å¸¸è§çš„Redisé”™è¯¯åŠå…¶è§£å†³æ–¹æ³•ï¼šçš„ç›´æ¥é“¾æ¥" title="å…¶ä»–å¸¸è§çš„Redisé”™è¯¯åŠå…¶è§£å†³æ–¹æ³•ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>è¿æ¥è¢«æ‹’ç»ï¼šå½“Redisæ²¡æœ‰è¿è¡Œæˆ–é˜²ç«å¢™é˜»æ­¢äº†è¿æ¥æ—¶ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥Redisæ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œå¦‚æœé˜²ç«å¢™é˜»æ­¢äº†è¿æ¥ï¼Œè¯·ä¸ºRedisæ·»åŠ ä¸€ä¸ªä¾‹å¤–ã€‚</li>
<li>è¾¾åˆ°æœ€å¤§å®¢æˆ·ç«¯æ•°ï¼šå½“å¤ªå¤šå®¢æˆ·ç«¯è¯•å›¾åŒæ—¶è¿æ¥åˆ°Redisæ—¶ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šå¢åŠ Redisé…ç½®æ–‡ä»¶ä¸­çš„maxclientsè®¾ç½®ï¼Œæˆ–æ·»åŠ æ›´å¤šçš„Rediså®ä¾‹ã€‚</li>
<li>å†…å­˜ä¸è¶³ï¼šå½“Redisçš„å†…å­˜ç”¨å°½æ—¶ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šå‡å°å­˜å‚¨åœ¨Redisä¸­çš„æ•°æ®çš„å¤§å°ï¼Œä¸ºæœåŠ¡å™¨æ·»åŠ æ›´å¤šå†…å­˜ï¼Œæˆ–ä½¿ç”¨Redisçš„é€å‡ºç­–ç•¥è‡ªåŠ¨åˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡¹ç›®ã€‚</li>
<li>è¯­æ³•é”™è¯¯ï¼šå½“å‘½ä»¤ä»¥é”™è¯¯çš„è¯­æ³•å‘é€åˆ°Redisæ—¶ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥å‘½ä»¤çš„è¯­æ³•ï¼Œç„¶åé‡è¯•ã€‚</li>
<li>æœªæ‰¾åˆ°é”®ï¼šå½“å°è¯•æ£€ç´¢ä¸å­˜åœ¨çš„é”®çš„å€¼æ—¶ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨EXISTSå‘½ä»¤åœ¨å°è¯•æ£€ç´¢å…¶å€¼ä¹‹å‰æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ã€‚</li>
<li>å°†æ•°æ®åŠ è½½åˆ°å†…å­˜ï¼šå½“Redisä»ç£ç›˜é‡æ–°åŠ è½½æ•°æ®åˆ°å†…å­˜æ—¶ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šç­‰å¾…é‡æ–°åŠ è½½å®Œæˆï¼Œæˆ–å¢åŠ Redisé…ç½®æ–‡ä»¶ä¸­çš„ä¿å­˜é—´éš”ã€‚</li>
</ol>]]></content:encoded>
            <category>ä¸­é—´ä»¶</category>
            <category>Redis</category>
        </item>
        <item>
            <title><![CDATA[jediså®æ“redisAPI]]></title>
            <link>https://jachen99.github.io/blog/talk-about-redis-api</link>
            <guid>https://jachen99.github.io/blog/talk-about-redis-api</guid>
            <pubDate>Sat, 10 Dec 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[ä¸ºäº†åŠ æ·±å¯¹åŸç”Ÿrediså‘½ä»¤çš„è®¤è¯†ï¼Œæˆ‘åˆæ‰‹å†™äº†è¾¹é€šè¿‡jedisè°ƒç”¨åŸç”Ÿredis API çš„å®æ“ï¼ŒRediså‘½ä»¤ååˆ†ä¸°å¯Œï¼ŒåŒ…æ‹¬çš„å‘½ä»¤ç»„æœ‰Clusterã€Connectionã€Geoã€Hashesã€HyperLogLogã€Keysã€Listsã€Pub/Subã€Scriptingã€Serverã€Setsã€Sorted Setsã€Stringsã€Transactionsä¸€å…±14ä¸ªrediså‘½ä»¤ç»„ä¸¤ç™¾å¤šä¸ªrediså‘½ä»¤ï¼ŒRedisä¸­æ–‡å‘½ä»¤å¤§å…¨ã€‚æ‚¨å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ£€ç´¢åŠŸèƒ½å¿«é€ŸæŸ¥æ‰¾å‘½ä»¤ï¼Œå·²ä¸‹æ˜¯å…¨éƒ¨å·²çŸ¥çš„rediså‘½ä»¤åˆ—è¡¨ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£çš„è¯ä¹Ÿå¯ä»¥æŸ¥çœ‹æˆ‘ä»¬çš„ç½‘ç«™ç»“æ„å›¾,å®ƒä»¥èŠ‚ç‚¹å›¾çš„å½¢å¼å±•ç¤ºäº†æ‰€æœ‰rediså‘½ä»¤ã€‚]]></description>
            <content:encoded><![CDATA[<p>ä¸ºäº†åŠ æ·±å¯¹åŸç”Ÿrediså‘½ä»¤çš„è®¤è¯†ï¼Œæˆ‘åˆæ‰‹å†™äº†è¾¹é€šè¿‡jedisè°ƒç”¨åŸç”Ÿredis API çš„å®æ“ï¼Œ<em>Rediså‘½ä»¤ååˆ†ä¸°å¯Œï¼ŒåŒ…æ‹¬çš„å‘½ä»¤ç»„æœ‰Clusterã€Connectionã€Geoã€Hashesã€HyperLogLogã€Keysã€Listsã€Pub/Subã€Scriptingã€Serverã€Setsã€Sorted Setsã€Stringsã€Transactionsä¸€å…±14ä¸ªrediså‘½ä»¤ç»„ä¸¤ç™¾å¤šä¸ªrediså‘½ä»¤ï¼ŒRedisä¸­æ–‡å‘½ä»¤å¤§å…¨ã€‚æ‚¨å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ£€ç´¢åŠŸèƒ½å¿«é€ŸæŸ¥æ‰¾å‘½ä»¤ï¼Œå·²ä¸‹æ˜¯å…¨éƒ¨å·²çŸ¥çš„rediså‘½ä»¤åˆ—è¡¨ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£çš„è¯ä¹Ÿå¯ä»¥æŸ¥çœ‹æˆ‘ä»¬çš„<a href="http://www.redis.cn/map.html" target="_blank" rel="noopener noreferrer">ç½‘ç«™ç»“æ„å›¾</a>,å®ƒä»¥èŠ‚ç‚¹å›¾çš„å½¢å¼å±•ç¤ºäº†æ‰€æœ‰rediså‘½ä»¤ã€‚</em></p>
<p>Rediså®˜ç½‘ï¼š<a href="https://redis.io/" target="_blank" rel="noopener noreferrer">https://redis.io/</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸€ä½¿ç”¨javaæ“ä½œredisæ–¹å¼">ä¸€ã€ä½¿ç”¨Javaæ“ä½œRedisæ–¹å¼<a href="https://jachen99.github.io/blog/talk-about-redis-api#%E4%B8%80%E4%BD%BF%E7%94%A8java%E6%93%8D%E4%BD%9Credis%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="ä¸€ã€ä½¿ç”¨Javaæ“ä½œRedisæ–¹å¼çš„ç›´æ¥é“¾æ¥" title="ä¸€ã€ä½¿ç”¨Javaæ“ä½œRedisæ–¹å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>1ã€Jedis</p>
<div class="language-tex codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tex codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Jedis æ˜¯ç›´è¿æ¨¡å¼ï¼Œåœ¨å¤šä¸ªçº¿ç¨‹é—´å…±äº«ä¸€ä¸ª Jedis å®ä¾‹æ—¶æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„,éœ€è¦ä½¿ç”¨è¿æ¥æ± </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å…¶APIæä¾›äº†æ¯”è¾ƒå…¨é¢çš„Rediså‘½ä»¤çš„æ”¯æŒï¼Œç›¸æ¯”äºå…¶ä»–Redis å°è£…æ¡†æ¶æ›´åŠ åŸç”Ÿ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Jedisä¸­çš„æ–¹æ³•è°ƒç”¨æ˜¯æ¯”è¾ƒåº•å±‚çš„æš´éœ²çš„Redisçš„APIï¼ŒJavaæ–¹æ³•åŸºæœ¬å’ŒRedisçš„APIä¿æŒç€ä¸€è‡´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ä½¿ç”¨é˜»å¡çš„I/Oï¼Œæ–¹æ³•è°ƒç”¨åŒæ­¥ï¼Œç¨‹åºæµéœ€è¦ç­‰åˆ°socketå¤„ç†å®ŒI/Oæ‰èƒ½æ‰§è¡Œï¼Œä¸æ”¯æŒå¼‚æ­¥æ“ä½œ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2ã€Lettuce</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">é«˜çº§Rediså®¢æˆ·ç«¯ï¼Œç”¨äºçº¿ç¨‹å®‰å…¨åŒæ­¥ï¼Œå¼‚æ­¥å“åº”</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">åŸºäºNettyçš„çš„äº‹ä»¶é©±åŠ¨ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹é—´å¹¶å‘è®¿é—®, é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å¯ä»¥æ›´å¥½çš„åˆ©ç”¨ç³»ç»Ÿèµ„æº</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ‘å°±ç”¨Jedisæ“ä½œäº†.....</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="äºŒäº²ç¬”æ¼”ç»ƒredisäº”å¤§å¸¸ç”¨å‘½ä»¤ç»„">äºŒã€äº²ç¬”æ¼”ç»ƒRedisäº”å¤§å¸¸ç”¨å‘½ä»¤ç»„<a href="https://jachen99.github.io/blog/talk-about-redis-api#%E4%BA%8C%E4%BA%B2%E7%AC%94%E6%BC%94%E7%BB%83redis%E4%BA%94%E5%A4%A7%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%BB%84" class="hash-link" aria-label="äºŒã€äº²ç¬”æ¼”ç»ƒRedisäº”å¤§å¸¸ç”¨å‘½ä»¤ç»„çš„ç›´æ¥é“¾æ¥" title="äºŒã€äº²ç¬”æ¼”ç»ƒRedisäº”å¤§å¸¸ç”¨å‘½ä»¤ç»„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>1ã€ä½¿ç”¨è¿æ¥æ± </p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.Jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.JedisPool;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.JedisPoolConfig;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * TODOï¼š æµ‹è¯•jedisä¸rediså»ºç«‹è¿æ¥  ä½¿ç”¨çº¿ç¨‹æ± </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/10 15:37</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class Test2 {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å»ºç«‹è¿æ¥æ± é…ç½®ä¿¡æ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        JedisPoolConfig poolConfig = new JedisPoolConfig();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setMaxTotal(200);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setMaxIdle(32);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setMaxWaitMillis(10*100);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setBlockWhenExhausted(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setTestOnBorrow(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åˆ›å»ºä¸€ä¸ªè¿æ¥æ± </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        JedisPool pool = new JedisPool(poolConfig, "192.168.253.128", 6379);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // ä»è¿æ¥æ± è·å–ä¸€ä¸ªç°æˆçš„è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Jedis jedis = pool.getResource();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("jedis = " + jedis);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // ä¸ä½¿ç”¨çš„æ—¶å€™æ”¾å›è¿æ¥æ± </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2ã€æ“ä½œString</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.Jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.JedisPool;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.JedisPoolConfig;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/10 15:41</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TestString {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 1ã€å»ºç«‹è¿æ¥æ± é…ç½®ä¿¡æ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        JedisPoolConfig poolConfig = new JedisPoolConfig();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setMaxTotal(200);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setMaxIdle(32);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setMaxWaitMillis(10*100);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setBlockWhenExhausted(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        poolConfig.setTestOnBorrow(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 2ã€åˆ›å»ºä¸€ä¸ªè¿æ¥æ± </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        JedisPool pool = new JedisPool(poolConfig, "192.168.253.128", 6379);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 3ã€ä»è¿æ¥æ± è·å–ä¸€ä¸ªç°æˆçš„è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Jedis jedis = pool.getResource();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("jedis = " + jedis);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 4ã€æ“ä½œString</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("===============String==============");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODOï¼šå­˜å‚¨å­—ç¬¦ä¸²çš„ç±»å‹ï¼Œkey-value</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  notice:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€å€¼çš„é•¿åº¦ä¸èƒ½è¶…è¿‡512 MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€keyå‘½åè§„èŒƒï¼Œä¸è¦è¿‡é•¿ï¼Œå†’å·åˆ†å‰²ï¼Œä¸šåŠ¡å:è¡¨å:ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODO: åº”ç”¨ ï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€éªŒè¯ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€è®¡æ—¶å™¨ã€å‘å·å™¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€é‡å¤è®¢å•æäº¤ä»¤ç‰Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  4ã€çƒ­ç‚¹å•†å“å¡ç‰‡(åºåˆ—åŒ–å¯¹è±¡å­˜å‚¨)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  5ã€åˆ†å¸ƒå¼é”</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String setName = jedis.set("name", "jachen");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("setName = " + setName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("name"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.set("age","18");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("age"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // incr å¯¹åº” çš„å€¼ è¿›è¡ŒåŠ 1æ“ä½œï¼Œå¹¶è¿”å›æ–°å€¼ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.incr("age");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("age"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å°†keyå¯¹åº”çš„æ•°å­—åŠ incrementã€‚(å¦‚æœkeyä¸å­˜åœ¨ï¼Œæ“ä½œä¹‹å‰ï¼Œkeyä¼šè¢«ç½®ä¸ºé›¶ã€‚)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.incrBy("age",10);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("age"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.set("cart","887766");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("cart"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æ‰¹é‡è®¾ç½®æˆ–è·å–å¤šä¸ªkeyçš„å€¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.mset("tell", "110", "weight", "65kg");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.mget("tell","weight"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.setnx("sex","0");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("sex"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // åŸå­æ€§æ“ä½œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å°†keyè®¾ç½®å€¼ä¸ºvalueï¼Œå¦‚æœkeyä¸å­˜åœ¨ç­‰åŒSETå‘½ä»¤ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.msetnx("k1","v1","k2","v2","sex","0");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.mget("k1","k2","sex"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å½“keyå­˜åœ¨æ—¶ä»€ä¹ˆä¹Ÿä¸åš,  æ˜¯set if not existsçš„ç®€å†™ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.msetnx("k1","v1","k2","v2","sex","1");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.mget("k1","k2","sex"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // è®¾ç½®keyå¯¹åº”å­—ç¬¦ä¸²valueï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å¹¶ä¸”è®¾ç½®keyåœ¨ç»™å®šçš„secondsæ—¶é—´ä¹‹åè¶…æ—¶è¿‡æœŸ,åŸå­æ“ä½œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.setex("car",2,"887766");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("car"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Thread.sleep(3000);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.get("car"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 5ã€ä¸ä½¿ç”¨çš„æ—¶å€™æ”¾å›è¿æ¥æ± </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20221210231902515" src="https://jachen99.github.io/assets/images/image-20221210231902515-afec2d8acfbc609531f330a48ce9eaf6.png" width="804" height="400" class="img_ev3q"></p>
<p>3ã€æ“ä½œList</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.Jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/10 21:05</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TestList {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 1ã€è·å–ä¸€ä¸ªJedisè¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Jedis jedis = new Jedis("192.168.253.128",6379);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 2ã€æ“ä½œList</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODO: å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åº</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  å­˜å‚¨ç»“æ„ï¼šåŒå‘é“¾è¡¨ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦O(1)å¿«,æŸ¥æ‰¾ä¸ºO(n)æ…¢</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  noticeï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€é€šå¸¸æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€å­˜å‚¨çš„éƒ½æ˜¯stringå­—ç¬¦ä¸²ç±»å‹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€æ”¯æŒåˆ†é¡µæ“ä½œï¼Œé«˜å¹¶å‘é¡¹ç›®ä¸­ï¼Œç¬¬ä¸€é¡µæ•°æ®éƒ½æ˜¯æ¥æºlistï¼Œç¬¬äºŒé¡µå’Œæ›´å¤šä¿¡æ¯åˆ™æ˜¯é€šè¿‡æ•°æ®åº“åŠ è½½</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  4ã€ä¸€ä¸ªåˆ—è¡¨æœ€å¤šå¯ä»¥åŒ…å« 232 - 1 ä¸ªå…ƒç´  (4294967295, æ¯ä¸ªåˆ—è¡¨ä¸è¶…è¿‡40äº¿ä¸ªå…ƒç´ )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODO: åº”ç”¨ï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€ç®€å•é˜Ÿåˆ—</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€æœ€æ–°è¯„è®ºåˆ—è¡¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€éå®æ—¶æ’è¡Œæ¦œï¼šå®šæ—¶è®¡ç®—æ¦œå•ï¼Œå¦‚æ‰‹æœºæ—¥é”€æ¦œå•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("===============List===============");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘  å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨  key value1 [value2]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.lpush("phone","mate5","iphone14","iphone11","iphone5s");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.llen("phone"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.lrange("phone",0,-1));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¡ ç§»é™¤å¹¶è·å–åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String rpop = jedis.rpop("phone");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("rpop = " + rpop);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¢ åœ¨keyå¯¹åº”çš„listçš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.rpush("netbook","DELL","Mac","å¤–æ˜Ÿäºº");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.lrange("netbook",0,-1));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘£ ä»keyå¯¹åº”çš„listçš„å°¾éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.lpop("netbook"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¤ ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // BRPOP LIST1 LIST2 .. LISTN TIMEOUT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.del("netbook","iphone");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.lrange("iphone",0,-1));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.rpush("iphone","a","b","c");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        List&lt;String&gt; list = jedis.brpop("iphone", "netbook", "1");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (String s : list) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.println(s);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¥ ç§»é™¤å…ƒç´ ,å¯ä»¥æŒ‡å®šç§»é™¤ä¸ªæ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.lrem("iphone",1,"a");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.lrange("iphone",0,-1));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 3ã€å…³é—­è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20221210232207004" src="https://jachen99.github.io/assets/images/image-20221210232207004-8b5b8d44c2b5b0ab278ba1ff89b619d6.png" width="805" height="278" class="img_ev3q"></p>
<p>4ã€æ“ä½œSet</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.Jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Set;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/10 21:40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TestSet {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 1ã€è·å–ä¸€ä¸ªJedisè¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Jedis jedis = new Jedis("192.168.253.128",6379);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODO: å°†ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜å…ƒç´ åŠ å…¥åˆ°é›†åˆä¸­ï¼Œå·²ç»å­˜åœ¨äºé›†åˆçš„æˆå‘˜å…ƒç´ å°†è¢«å¿½ç•¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  notice: é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODO: åº”ç”¨ï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€å»é‡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€ç¤¾äº¤åº”ç”¨å…³æ³¨ã€ç²‰ä¸ã€å…±åŒå¥½å‹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€ç»Ÿè®¡ç½‘ç«™çš„PVã€UVã€IP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  4ã€å¤§æ•°æ®é‡Œé¢çš„ç”¨æˆ·ç”»åƒæ ‡ç­¾é›†åˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 2ã€æ“ä½œSet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("===============Set==============");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘  æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šçš„memberå…ƒç´ åˆ°é›†åˆçš„ keyä¸­.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æŒ‡å®šçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ member å¦‚æœå·²ç»åœ¨é›†åˆkeyä¸­å­˜åœ¨åˆ™å¿½ç•¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.sadd("user1","u1","beijing","18","iphone11");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.sadd("user2","u2","shanghai","19","iphone12");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.sadd("user3","u3","beijing","19","iphone13");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¡ è¿”å›é›†åˆå­˜å‚¨çš„keyçš„åŸºæ•° (é›†åˆå…ƒç´ çš„æ•°é‡).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.scard("user1"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.scard("user2"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.scard("user3"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¢ è¿”å›çš„é›†åˆå…ƒç´ æ˜¯ç¬¬ä¸€ä¸ªkeyçš„é›†åˆä¸åé¢æ‰€æœ‰keyçš„é›†åˆçš„å·®é›†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.sdiff("user1", "user2", "user3"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘£ è¿”å›æŒ‡å®šæ‰€æœ‰çš„é›†åˆçš„æˆå‘˜çš„äº¤é›†.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.sinter("user1", "user2"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¤ è¿”å›æˆå‘˜ member æ˜¯å¦æ˜¯å­˜å‚¨çš„é›†åˆ keyçš„æˆå‘˜.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.sismember("user1","beijing"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¥ åœ¨keyé›†åˆä¸­ç§»é™¤æŒ‡å®šçš„å…ƒç´ . å¦‚æœæŒ‡å®šçš„å…ƒç´ ä¸æ˜¯keyé›†åˆä¸­çš„å…ƒç´ åˆ™å¿½ç•¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.srem("user1","iphone11");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.scard("user1"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¦ è¿”å›ç»™å®šçš„å¤šä¸ªé›†åˆçš„å¹¶é›†ä¸­çš„æ‰€æœ‰æˆå‘˜.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Set&lt;String&gt; sunion = jedis.sunion("user1", "user2", "user3");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (String s : sunion) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.print(s + " ");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘§ è¿”å›keyé›†åˆæ‰€æœ‰çš„å…ƒç´ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Set&lt;String&gt; user1 = jedis.smembers("user1");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for (String s : user1) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System.out.print(s + " ");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // keyçš„å­˜æ´»æ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("\njedis.ttl(\"user1\") = " + jedis.ttl("user1"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 3ã€å…³é—­è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20221210232225594" src="https://jachen99.github.io/assets/images/image-20221210232225594-187b2a05c21971eb0aa0a33f84fd95ea.png" width="656" height="287" class="img_ev3q"></p>
<p>5ã€æ“ä½œHash</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.Jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/10 22:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TestHash {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 1ã€è·å–ä¸€ä¸ªJedisè¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Jedis jedis = new Jedis("192.168.253.128",6379);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 2ã€Hashæ“ä½œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODOï¼šstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  noticeï¼šæ¯ä¸ª hash å¯ä»¥å­˜å‚¨ 232 - 1 é”®å€¼å¯¹ï¼ˆ40å¤šäº¿ï¼‰</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODOï¼šåº”ç”¨:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€è´­ç‰©è½¦</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€ç”¨æˆ·ä¸ªäººä¿¡æ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€å•†å“è¯¦æƒ…</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("===============Hash==============");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘  è®¾ç½® key æŒ‡å®šçš„å“ˆå¸Œé›†ä¸­æŒ‡å®šå­—æ®µçš„å€¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.hset("class","redis","80");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.hget("class","redis"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        HashMap&lt;String, String&gt; hashMap = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashMap.put("java","100");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashMap.put("c++","90");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashMap.put("c","96");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.hmset("class",hashMap);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¡ è¿”å› key æŒ‡å®šçš„å“ˆå¸Œé›†ä¸­æ‰€æœ‰çš„å­—æ®µå’Œå€¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.hgetAll("class"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¢ ä» key æŒ‡å®šçš„å“ˆå¸Œé›†ä¸­ç§»é™¤æŒ‡å®šçš„åŸŸ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.hdel("class","c","c++");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.hgetAll("class"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘£ è¿”å›hashé‡Œé¢fieldæ˜¯å¦å­˜åœ¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.hexists("class","c"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¤ å¢åŠ  key æŒ‡å®šçš„å“ˆå¸Œé›†ä¸­æŒ‡å®šå­—æ®µçš„æ•°å€¼,  å¦‚æœæ˜¯-1 åˆ™æ˜¯é€’å‡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // HINCRBY key field increment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.hincrBy("class","java",-5);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.hgetAll("class"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.hincrBy("class","java",-5);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.hgetAll("class"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 3ã€å…³é—­Jedisè¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20221210232256172" src="https://jachen99.github.io/assets/images/image-20221210232256172-38f5860d9372b383dbb843c6e5de58af.png" width="464" height="234" class="img_ev3q"></p>
<p>6ã€æ“ä½œSortedSet</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package space.jachen.jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import redis.clients.jedis.Jedis;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @author JaChen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @date 2022/12/10 22:36</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TestSortedSet {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 1ã€è·å–ä¸€ä¸ªJedisè¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Jedis jedis = new Jedis("192.168.253.128",6379);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 2ã€æ“ä½œSortedSet å¯å«zSet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODO:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€æœ‰åºé›†åˆå¯ä»¥çœ‹åšæ˜¯åœ¨Seté›†åˆçš„çš„åŸºç¡€ä¸Šä¸ºé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ ç»´æŠ¤äº†ä¸€ä¸ªé¡ºåºå€¼: score,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  å®ƒå…è®¸é›†åˆä¸­çš„å…ƒç´ å¯ä»¥æŒ‰ç…§scoreè¿›è¡Œæ’åº</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€å¦‚æœæŸä¸ªæˆå‘˜å·²ç»æ˜¯æœ‰åºé›†çš„æˆå‘˜ï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  é‚£ä¹ˆæ›´æ–°è¿™ä¸ªæˆå‘˜çš„åˆ†æ•°å€¼ï¼Œåˆ†æ•°å€¼å¯ä»¥æ˜¯æ•´æ•°å€¼æˆ–åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€ç”¨äºå°†ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜å…ƒç´ åŠå…¶åˆ†æ•°å€¼åŠ å…¥åˆ°æœ‰åºé›†å½“ä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  notice:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€åº•å±‚ä½¿ç”¨åˆ°äº†Ziplistå‹ç¼©åˆ—è¡¨å’Œâ€œè·³è·ƒè¡¨â€ä¸¤ç§å­˜å‚¨ç»“æ„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€å¦‚æœé‡å¤æ·»åŠ ç›¸åŒçš„æ•°æ®ï¼Œscoreå€¼å°†è¢«åå¤è¦†ç›–ï¼Œä¿ç•™æœ€åä¸€æ¬¡ä¿®æ”¹çš„ç»“æœ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // TODOï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  åº”ç”¨ï¼š</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  1ã€å®æ—¶æ’è¡Œæ¦œï¼šå•†å“çƒ­é”€æ¦œã€ä½“è‚²ç±»åº”ç”¨çƒ­é—¨çƒé˜Ÿã€ç§¯åˆ†æ¦œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  2ã€ä¼˜å…ˆçº§ä»»åŠ¡ã€é˜Ÿåˆ—</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  3ã€æœ‹å‹åœˆ æ–‡ç« ç‚¹èµ-å–æ¶ˆï¼Œé€»è¾‘ï¼šç”¨æˆ·åªèƒ½ç‚¹èµæˆ–å–æ¶ˆï¼Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //  ç»Ÿè®¡ä¸€ç¯‡æ–‡ç« è¢«ç‚¹èµäº†å¤šå°‘æ¬¡ï¼Œå¯ä»¥ç›´æ¥å–é‡Œé¢æœ‰å¤šå°‘ä¸ªæˆå‘˜</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println("===============SortedSet==============");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘  å‘æœ‰åºé›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œæˆ–è€…æ›´æ–°å·²å­˜åœ¨æˆå‘˜çš„åˆ†æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.zadd("goods",100,"iPhone14");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¡ è·å–æœ‰åºé›†åˆçš„æˆå‘˜æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zcard("goods"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¢ æœ‰åºé›†åˆä¸­å¯¹æŒ‡å®šæˆå‘˜çš„åˆ†æ•°åŠ ä¸Šå¢é‡ increment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.zincrby("goods",10,"iPhone14");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zscore("goods","iPhone14"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.zincrby("goods",10,"iPhone14");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zscore("goods","iPhone14"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        HashMap&lt;String, Double&gt; hashMap = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashMap.put("meta8",60D);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashMap.put("iPhone12",101D);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashMap.put("iPhone6s",30D);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.zadd("goods",hashMap);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘£ è®¡ç®—åœ¨æœ‰åºé›†åˆä¸­æŒ‡å®šåŒºé—´åˆ†æ•°çš„æˆå‘˜æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zcount("goods",10,150));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¤ é€šè¿‡ç´¢å¼•åŒºé—´è¿”å›æœ‰åºé›†åˆæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜, æˆå‘˜çš„ä½ç½®æŒ‰åˆ†æ•°å€¼é€’å¢(ä»å°åˆ°å¤§)æ¥æ’åº</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zrange("goods",0,-1));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // æ ¹æ®scoreæ­£åºè¾“å‡º</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zrangeByScore("goods",0D,100));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¥ é€šè¿‡ç´¢å¼•åŒºé—´è¿”å›æœ‰åºé›†åˆæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜, æˆå‘˜çš„ä½ç½®æŒ‰åˆ†æ•°å€¼é€’å¢(ä»å¤§åˆ°å°)æ¥æ’åº</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zrevrange("goods",0,-1));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘¦ è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„æ’åï¼Œæœ‰åºé›†æˆå‘˜æŒ‰åˆ†æ•°å€¼é€’å‡(ä»å¤§åˆ°å°)æ’åº</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zrevrank("goods","meta8"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // â‘§ è¿”å›æœ‰åºé›†keyä¸­æˆå‘˜memberçš„æ’åã€‚å…¶ä¸­æœ‰åºé›†æˆå‘˜æŒ‰scoreå€¼é€’å¢(ä»å°åˆ°å¤§)é¡ºåºæ’åˆ—</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.out.println(jedis.zrank("goods","meta8"));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // 3ã€ å…³é—­jedisè¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        jedis.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20221210232340442" src="https://jachen99.github.io/assets/images/image-20221210232340442-63a8d6907d711168cbb838ece464def3.png" width="680" height="278" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“<a href="https://jachen99.github.io/blog/talk-about-redis-api#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>é™¤äº†è¦äº†è§£è¿™äº›æ•°æ®ç»“æ„çš„å¸¸ç”¨åœºæ™¯ä¹‹å‰ï¼Œè¿˜æœ‰ç»§ç»­åŠ æ·±å¯¹ä»–ä»¬åº•å±‚å®ç°çš„äº†è§£ï¼Œæ¯”å¦‚SortedSetåº•å±‚ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è·³è·ƒè¡¨å‘¢ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘ç­‰ç­‰ã€‚</p>]]></content:encoded>
            <category>ä¸­é—´ä»¶</category>
            <category>Redis</category>
        </item>
        <item>
            <title><![CDATA[SpringMVCæ¶æ„å®ç°æµç¨‹]]></title>
            <link>https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process</link>
            <guid>https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process</guid>
            <pubDate>Mon, 12 Sep 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[èµ·å› ï¼šSpringMVCæ˜¯ Spring æ¡†æ¶æä¾›çš„ä¸€æ¬¾åŸºäº MVC æ¨¡å¼çš„è½»é‡çº§ Web å¼€å‘æ¡†æ¶ï¼Œä¸ºäº†è®©è‡ªå·±æ›´æ¸…æ™°çš„è®¤è¯†SpringMVCåº•å±‚çš„å®ç°æµç¨‹ï¼Œå¯¹SpringMVCæœ‰æ›´åŠ æ·±å±‚æ¬¡çš„è®¤è¯†ï¼Œå¯¹å®ƒè¿›è¡Œäº†ä½¿ç”¨æµç¨‹çš„ä½¿ç”¨ä¸æ€»ç»“ã€‚]]></description>
            <content:encoded><![CDATA[<p>**èµ·å› ï¼š**SpringMVC<em>æ˜¯ Spring æ¡†æ¶æä¾›çš„ä¸€æ¬¾åŸºäº MVC æ¨¡å¼çš„è½»é‡çº§ Web å¼€å‘æ¡†æ¶ï¼Œä¸ºäº†è®©è‡ªå·±æ›´æ¸…æ™°çš„è®¤è¯†SpringMVCåº•å±‚çš„å®ç°æµç¨‹ï¼Œå¯¹SpringMVCæœ‰æ›´åŠ æ·±å±‚æ¬¡çš„è®¤è¯†ï¼Œå¯¹å®ƒè¿›è¡Œäº†ä½¿ç”¨æµç¨‹çš„ä½¿ç”¨ä¸æ€»ç»“</em>ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸€ä»€ä¹ˆæ˜¯springmvc">ä¸€ã€ä»€ä¹ˆæ˜¯SpringMVC<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#%E4%B8%80%E4%BB%80%E4%B9%88%E6%98%AFspringmvc" class="hash-link" aria-label="ä¸€ã€ä»€ä¹ˆæ˜¯SpringMVCçš„ç›´æ¥é“¾æ¥" title="ä¸€ã€ä»€ä¹ˆæ˜¯SpringMVCçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Spring MVC ä½¿ç”¨ MVC æ¶æ„æ¨¡å¼çš„æ€æƒ³ï¼Œå°† Web åº”ç”¨è¿›è¡ŒèŒè´£è§£æ„ï¼ŒæŠŠä¸€ä¸ªå¤æ‚çš„ Web åº”ç”¨åˆ’åˆ†æˆæ¨¡å‹ï¼ˆModelï¼‰ã€æ§åˆ¶å™¨ï¼ˆContorllerï¼‰ä»¥åŠè§†å›¾ï¼ˆViewï¼‰ä¸‰å±‚ã€‚</p>
<ul>
<li>Modelï¼šè´Ÿè´£å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ Controllerï¼›</li>
<li>Viewï¼šè´Ÿè´£å°†è¯·æ±‚çš„å¤„ç†ç»“æœè¿›è¡Œæ¸²æŸ“ï¼Œå±•ç¤ºåœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸Šï¼›</li>
<li>Controllerï¼šæ˜¯ Model å’Œ View äº¤äº’çš„çº½å¸¦ï¼›ä¸»è¦è´Ÿè´£æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶è°ƒç”¨ Model å¯¹è¯·æ±‚å¤„ç†ï¼Œç„¶åå°† Model çš„å¤„ç†ç»“æœä¼ é€’ç»™ Viewã€‚</li>
</ul>
<p>Spring MVC æœ¬è´¨æ˜¯å¯¹ Servlet çš„è¿›ä¸€æ­¥å°è£…ï¼Œå…¶æœ€æ ¸å¿ƒçš„ç»„ä»¶æ˜¯ DispatcherServletï¼Œå®ƒæ˜¯ Spring MVC çš„å‰ç«¯æ§åˆ¶å™¨ï¼Œä¸»è¦è´Ÿè´£å¯¹è¯·æ±‚å’Œå“åº”çš„ç»Ÿä¸€åœ°å¤„ç†å’Œåˆ†å‘ã€‚Controller æ¥æ”¶åˆ°çš„è¯·æ±‚å…¶å®å°±æ˜¯ DispatcherServlet æ ¹æ®ä¸€å®šçš„è§„åˆ™åˆ†å‘ç»™å®ƒçš„ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="äºŒspringmvcå¸¸ç”¨ç»„ä»¶">äºŒã€SpringMVCå¸¸ç”¨ç»„ä»¶<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#%E4%BA%8Cspringmvc%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6" class="hash-link" aria-label="äºŒã€SpringMVCå¸¸ç”¨ç»„ä»¶çš„ç›´æ¥é“¾æ¥" title="äºŒã€SpringMVCå¸¸ç”¨ç»„ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spring-mvc-æ ¸å¿ƒç»„ä»¶ç®€è¦è¯´æ˜">Spring MVC æ ¸å¿ƒç»„ä»¶ç®€è¦è¯´æ˜<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#spring-mvc-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E7%AE%80%E8%A6%81%E8%AF%B4%E6%98%8E" class="hash-link" aria-label="Spring MVC æ ¸å¿ƒç»„ä»¶ç®€è¦è¯´æ˜çš„ç›´æ¥é“¾æ¥" title="Spring MVC æ ¸å¿ƒç»„ä»¶ç®€è¦è¯´æ˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spring-mvc-æ ¸å¿ƒç»„ä»¶è¯´æ˜">Spring MVC æ ¸å¿ƒç»„ä»¶è¯´æ˜<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#spring-mvc-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E8%AF%B4%E6%98%8E" class="hash-link" aria-label="Spring MVC æ ¸å¿ƒç»„ä»¶è¯´æ˜çš„ç›´æ¥é“¾æ¥" title="Spring MVC æ ¸å¿ƒç»„ä»¶è¯´æ˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-å‰ç«¯æ§åˆ¶å™¨dispatcherservlet">1. å‰ç«¯æ§åˆ¶å™¨ï¼ˆDispatcherServletï¼‰<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#1-%E5%89%8D%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%99%A8dispatcherservlet" class="hash-link" aria-label="1. å‰ç«¯æ§åˆ¶å™¨ï¼ˆDispatcherServletï¼‰çš„ç›´æ¥é“¾æ¥" title="1. å‰ç«¯æ§åˆ¶å™¨ï¼ˆDispatcherServletï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>DispatcherServlet</strong> æ˜¯ Spring MVC çš„æ ¸å¿ƒç»„ä»¶ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Servletï¼Œè´Ÿè´£ç»Ÿä¸€æ¥æ”¶å¹¶åˆ†å‘æ‰€æœ‰çš„è¯·æ±‚ã€‚å®ƒä½œä¸ºæ•´ä¸ªæµç¨‹çš„æ§åˆ¶ä¸­å¿ƒï¼Œåè°ƒå„ä¸ªç»„ä»¶å®Œæˆä»»åŠ¡ï¼Œä»è€Œé™ä½äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆæ€§ï¼Œå¢å¼ºäº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚</p>
<ul>
<li><strong>æä¾›è€…</strong>ï¼šæ¡†æ¶è‡ªå¸¦</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-å¤„ç†å™¨æ˜ å°„å™¨handlermapping">2. å¤„ç†å™¨æ˜ å°„å™¨ï¼ˆHandlerMappingï¼‰<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#2-%E5%A4%84%E7%90%86%E5%99%A8%E6%98%A0%E5%B0%84%E5%99%A8handlermapping" class="hash-link" aria-label="2. å¤„ç†å™¨æ˜ å°„å™¨ï¼ˆHandlerMappingï¼‰çš„ç›´æ¥é“¾æ¥" title="2. å¤„ç†å™¨æ˜ å°„å™¨ï¼ˆHandlerMappingï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>HandlerMapping</strong> çš„ä½œç”¨æ˜¯æ ¹æ®è¯·æ±‚çš„ URL æˆ– HTTP æ–¹æ³•æŸ¥æ‰¾å¯¹åº”çš„å¤„ç†å™¨ï¼ˆHandlerï¼‰ï¼Œä¹Ÿå°±æ˜¯å…·ä½“çš„æ§åˆ¶å™¨æ–¹æ³•ã€‚</p>
<ul>
<li><strong>æä¾›è€…</strong>ï¼šæ¡†æ¶è‡ªå¸¦</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-å¤„ç†å™¨handler">3. å¤„ç†å™¨ï¼ˆHandlerï¼‰<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#3-%E5%A4%84%E7%90%86%E5%99%A8handler" class="hash-link" aria-label="3. å¤„ç†å™¨ï¼ˆHandlerï¼‰çš„ç›´æ¥é“¾æ¥" title="3. å¤„ç†å™¨ï¼ˆHandlerï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>Handler</strong> æ˜¯å…·ä½“çš„æ§åˆ¶å™¨æ–¹æ³•ï¼ˆControllerï¼‰ï¼Œè´Ÿè´£åœ¨ DispatcherServlet çš„è°ƒåº¦ä¸‹å¤„ç†ç”¨æˆ·çš„å…·ä½“è¯·æ±‚ï¼Œå¹¶è¿”å›å“åº”æ•°æ®ã€‚</p>
<ul>
<li><strong>æä¾›è€…</strong>ï¼šè‡ªå·±ç¼–å†™</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-å¤„ç†å™¨é€‚é…å™¨handleradapter">4. å¤„ç†å™¨é€‚é…å™¨ï¼ˆHandlerAdapterï¼‰<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#4-%E5%A4%84%E7%90%86%E5%99%A8%E9%80%82%E9%85%8D%E5%99%A8handleradapter" class="hash-link" aria-label="4. å¤„ç†å™¨é€‚é…å™¨ï¼ˆHandlerAdapterï¼‰çš„ç›´æ¥é“¾æ¥" title="4. å¤„ç†å™¨é€‚é…å™¨ï¼ˆHandlerAdapterï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>HandlerAdapter</strong> è´Ÿè´£è°ƒç”¨ä¸ HandlerMapping æ˜ å°„åˆ°çš„å¤„ç†å™¨æ–¹æ³•ã€‚å®ƒé€šè¿‡ç‰¹å®šçš„è§„åˆ™æ‰§è¡Œå¤„ç†å™¨ï¼ˆHandlerï¼‰ï¼Œç¡®ä¿æ–¹æ³•èƒ½å¤Ÿè¢«æ­£ç¡®è°ƒç”¨ã€‚</p>
<ul>
<li><strong>æä¾›è€…</strong>ï¼šæ¡†æ¶è‡ªå¸¦</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-è§†å›¾è§£æå™¨viewresolver">5. è§†å›¾è§£æå™¨ï¼ˆViewResolverï¼‰<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#5-%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8viewresolver" class="hash-link" aria-label="5. è§†å›¾è§£æå™¨ï¼ˆViewResolverï¼‰çš„ç›´æ¥é“¾æ¥" title="5. è§†å›¾è§£æå™¨ï¼ˆViewResolverï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>ViewResolver</strong> çš„åŠŸèƒ½æ˜¯å°†é€»è¾‘è§†å›¾åè§£æä¸ºç‰©ç†è§†å›¾è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå°†é€»è¾‘è§†å›¾å <code>result</code> è§£æä¸º <code>/WEB-INF/templates/result.html</code>ï¼Œå¹¶å°†è§£æåçš„è§†å›¾è¿”å›ç»™ DispatcherServletã€‚</p>
<ul>
<li><strong>æä¾›è€…</strong>ï¼šæ¡†æ¶è‡ªå¸¦</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-è§†å›¾view">6. è§†å›¾ï¼ˆViewï¼‰<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#6-%E8%A7%86%E5%9B%BEview" class="hash-link" aria-label="6. è§†å›¾ï¼ˆViewï¼‰çš„ç›´æ¥é“¾æ¥" title="6. è§†å›¾ï¼ˆViewï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>View</strong> æ˜¯æœ€ç»ˆçš„å±•ç¤ºå±‚ï¼Œç”¨äºå°†æ¨¡å‹æ•°æ®ï¼ˆModelï¼‰é€šè¿‡é¡µé¢å‘ˆç°ç»™ç”¨æˆ·ã€‚é€šå¸¸æ˜¯ç”± JSPã€Thymeleaf æˆ–å…¶ä»–æ¨¡æ¿å¼•æ“ç”Ÿæˆçš„é¡µé¢ã€‚</p>
<ul>
<li><strong>æä¾›è€…</strong>ï¼šè‡ªå·±ç¼–å†™</li>
</ul>
<hr>
<ol>
<li>DispatcherServletï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼‰ã€HandlerMappingï¼ˆå¤„ç†å™¨æ˜ å°„å™¨ï¼‰ã€HandlerAdapterï¼ˆå¤„ç†å™¨é€‚é…å™¨ï¼‰ã€Handlerï¼ˆå¤„ç†å™¨ï¼‰ã€ViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼‰å’Œ Viewï¼ˆè§†å›¾ï¼‰ã€‚</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸‰springmvcåŸºæœ¬æµç¨‹å›¾">ä¸‰ã€SpringMVCåŸºæœ¬æµç¨‹å›¾<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#%E4%B8%89springmvc%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B%E5%9B%BE" class="hash-link" aria-label="ä¸‰ã€SpringMVCåŸºæœ¬æµç¨‹å›¾çš„ç›´æ¥é“¾æ¥" title="ä¸‰ã€SpringMVCåŸºæœ¬æµç¨‹å›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="image-20221204230911409" src="https://jachen99.github.io/assets/images/image-20221204230911409-604f1a5c54260f4c22538bd29dd056b2.png" width="1012" height="671" class="img_ev3q"></p>
<p>1ã€æµè§ˆå™¨å‘é€è¯·æ±‚â€”â€”&gt;DispatcherServlet</p>
<p>è¯¥è¯·æ±‚ä¼šè¢« DispatcherServletï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼‰æ‹¦æˆªï¼›å‰ç«¯æ§åˆ¶å™¨æ”¶åˆ°è¯·æ±‚åè‡ªå·±ä¸è¿›è¡Œå¤„ç†ï¼Œè€Œæ˜¯å§”æ‰˜ç»™å…¶ä»–ç»„ä»¶è¿›è¡Œå¤„ç†ï¼Œä½œä¸ºç»Ÿä¸€è®¿é—®ç‚¹ï¼Œè¿›è¡Œå…¨å±€çš„æµç¨‹æ§åˆ¶ã€‚</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- DSï¼šå‰ç«¯æ§åˆ¶å™¨ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">servlet</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">servlet-name</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">ds</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">servlet-name</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">servlet-class</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.springframework.web.servlet.DispatcherServlet</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">servlet-class</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">init-param</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">param-name</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">contextConfigLocation</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">param-name</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">param-value</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">classpath:applicationContext-web.xml</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">param-value</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">init-param</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">load-on-startup</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">1</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">load-on-startup</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">servlet</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2ã€DispatcherServletâ€”â€”&gt;HandlerMapping</p>
<p>DispatcherServlet è°ƒç”¨ HandlerMappingï¼ˆå¤„ç†å™¨æ˜ å°„å™¨ï¼‰æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨ï¼ˆHandlerï¼‰åŠæ‹¦æˆªå™¨ï¼Œæœ€åä»¥ HandlerExecutionChain æ‰§è¡Œé“¾çš„å½¢å¼è¿”å›ç»™ DispatcherServletã€‚</p>
<p>3ã€DispatcherServletâ€”â€”&gt;HandlerAdapter</p>
<p>DispatcherServlet å°†æ‰§è¡Œé“¾è¿”å›çš„ Handler ä¿¡æ¯å‘é€ç»™ HandlerAdapterï¼ˆå¤„ç†å™¨é€‚é…å™¨ï¼‰ã€‚å¤„ç†å™¨é€‚é…å™¨å°†ä¼šæŠŠå¤„ç†å™¨åŒ…è£…ä¸ºé€‚é…å™¨ï¼Œä»è€Œæ”¯æŒå¤šç§ç±»å‹çš„å¤„ç†å™¨ï¼Œå³é€‚é…å™¨è®¾è®¡æ¨¡å¼çš„åº”ç”¨ï¼Œä»è€Œå¾ˆå®¹æ˜“æ”¯æŒå¾ˆå¤šç±»å‹çš„å¤„ç†å™¨ã€‚</p>
<p>4ã€HandlerAdapterâ€”â€”&gt;Handler</p>
<p>æ ¹æ® Handler ä¿¡æ¯æ‰¾åˆ°å¹¶æ‰§è¡Œç›¸åº”çš„ Handlerï¼ˆå³ Controller æ§åˆ¶å™¨ï¼‰å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼ŒHandler æ‰§è¡Œå®Œæ¯•åä¼šè¿”å›ç»™ HandlerAdapter ä¸€ä¸ª ModelAndView å¯¹è±¡ï¼ˆSpring MVC çš„åº•å±‚å¯¹è±¡ï¼ŒåŒ…æ‹¬ Model æ•°æ®æ¨¡å‹å’Œ View è§†å›¾ä¿¡æ¯ï¼‰ã€‚</p>
<p>5ã€DispatcherServletâ€”â€”&gt;ViewResolver</p>
<p>DispatcherServlet æ¥æ”¶åˆ° ModelAndView å¯¹è±¡åï¼Œä¼šè¯·æ±‚ ViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼‰å¯¹è§†å›¾è¿›è¡Œè§£æã€‚</p>
<p>6ã€DispatcherServletâ€”â€”&gt;View</p>
<p>ViewResolver è§£æå®Œæˆåï¼Œä¼šå°† View è§†å›¾å¹¶è¿”å›ç»™ DispatcherServletã€‚DispatcherServlet æ¥æ”¶åˆ°å…·ä½“çš„ View è§†å›¾åï¼Œè¿›è¡Œè§†å›¾æ¸²æŸ“ï¼Œå°† Model ä¸­çš„æ¨¡å‹æ•°æ®å¡«å……åˆ° View è§†å›¾ä¸­çš„ request åŸŸï¼Œç”Ÿæˆæœ€ç»ˆçš„ Viewï¼ˆè§†å›¾ï¼‰ã€‚</p>
<p>7ã€DispatcherServletâ€”â€”&gt;å“åº”</p>
<p>è¿”å›æ§åˆ¶æƒç»™DispatcherServletï¼Œç”±å®ƒå“åº”ç”¨æˆ·ï¼Œåˆ°æ­¤ä¸€ä¸ªæµç¨‹ç»“æŸã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å››springmvcçš„ä¼˜åŠ¿">å››ã€SpringMVCçš„ä¼˜åŠ¿<a href="https://jachen99.github.io/blog/talk-about-SpringMVC-implementation-process#%E5%9B%9Bspringmvc%E7%9A%84%E4%BC%98%E5%8A%BF" class="hash-link" aria-label="å››ã€SpringMVCçš„ä¼˜åŠ¿çš„ç›´æ¥é“¾æ¥" title="å››ã€SpringMVCçš„ä¼˜åŠ¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Spring MVC æ¡†æ¶å†…éƒ¨é‡‡ç”¨æ¾è€¦åˆã€å¯æ’æ‹”çš„ç»„ä»¶ç»“æ„ï¼Œå…·æœ‰é«˜åº¦å¯é…ç½®æ€§ï¼Œæ¯”èµ·å…¶ä»–çš„ MVC æ¡†æ¶æ›´å…·æœ‰æ‰©å±•æ€§å’Œçµæ´»æ€§ã€‚æ­¤å¤–ï¼ŒSpring MVC çš„æ³¨è§£é©±åŠ¨ï¼ˆannotation-drivenï¼‰å’Œå¯¹ REST é£æ ¼çš„æ”¯æŒï¼Œä¹Ÿæ˜¯å®ƒæœ€å…·æœ‰ç‰¹è‰²çš„åŠŸèƒ½ã€‚</p>
<p>Spring MVC æ˜¯ Spring æ¡†æ¶çš„ä¼—å¤šå­é¡¹ç›®ä¹‹ä¸€ï¼Œè‡ª Spring æ¡†æ¶è¯ç”Ÿä¹‹æ—¥èµ·å°±åŒ…å«åœ¨ Spring æ¡†æ¶ä¸­äº†ï¼Œå®ƒå¯ä»¥ä¸ Spring æ¡†æ¶æ— ç¼é›†æˆï¼Œåœ¨æ€§èƒ½æ–¹é¢å…·æœ‰å…ˆå¤©çš„ä¼˜è¶Šæ€§ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒSpring MVC çš„å¼€å‘æ•ˆç‡è¦æ˜æ˜¾é«˜äºå…¶å®ƒçš„ Web æ¡†æ¶ï¼Œå› æ­¤ Spring MVC åœ¨ä¼ä¸šä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œæˆä¸ºç›®å‰ä¸šç•Œæœ€ä¸»æµçš„ MVC æ¡†æ¶ä¹‹ä¸€ã€‚</p>
<p>Spring MVC åŸºäºåŸç”Ÿçš„ Servlet å®ç°ï¼Œé€šè¿‡åŠŸèƒ½å¼ºå¤§çš„å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼Œå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚</p>]]></content:encoded>
        </item>
    </channel>
</rss>