---
slug: product-robot-1-0
title: Robot-1-0：智能对话机器人实现
authors: [jiguanchen]
---

*智能对话机器人：通过JavaSE基础知识，引用青云客API实现智能对话机器人的核心功能，项目效果图及其实现步骤如下*<!--more-->

## 效果图展示

<img src="img/image-20220917225950871.png" alt="image-20220917225950871" style="zoom: 67%;" />

------



## 核心spi

http://api.qingyunke.com/api.php?key=free&appid=0&msg=

------



## 青客云业务实现核心代码

```java
package service;

import com.google.gson.Gson;
import model.Response;
import util.HttpUtils;

import java.io.IOException;
import java.net.URLEncoder;

/**
 * @ClassName QkyRobotServiceImpl
 * @Description TODO 业务实现类
 * @Author JaChen
 * @Date 2020/08/17 16:57
 * @Version 1.0
 */
public class QkyRobotServiceImpl implements RobotService{


    private static final String apiTpl = "http://api.qingyunke.com/api.php?key=free&appid=0&msg=%s";

    private static final Gson gson = new Gson();


    @Override
    public Response qa(String msg) throws IOException {

        // 自动把apiTpl的%s替换为msg
        String api = String.format(apiTpl, URLEncoder.encode(msg, "UTF-8"));

        // 调用工具类 得到Gson字符串
        String result = HttpUtils.Request(api);

        // 将Gson字符串解析为对象
        Response response = gson.fromJson(result, Response.class);

        return response;
    }

}

```

------

## 工具类封装

```java
package util;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;

/**
 * @ClassName HttpUtils
 * @Description TODO  工具类的封装
 * @Author JaChen
 * @Date 2020/08/17 16:35
 * @Version 1.0
 */
public class HttpUtils {


    public static String Request(String api) throws IOException {

        HttpURLConnection connection = null;
        int reponseCode = 0;
        try {
            // 获取api的URL
            URL url = new URL(api);
            // 获取对应的连接对象 （需要强转）
            connection = (HttpURLConnection) url.openConnection();
            // 获取状态码
            reponseCode = connection.getResponseCode();

        } catch (IOException e) {
            e.printStackTrace();
        }

        if(200 <= reponseCode && reponseCode <= 299){

            try(InputStream inputStream = connection.getInputStream();
                BufferedReader in = new BufferedReader(new InputStreamReader(inputStream));
            ){
                StringBuilder response = new StringBuilder();
                String currentLine;

                while((currentLine = in.readLine()) != null){
                    response.append(currentLine);
                }

                String result = response.toString();
                return result;
            }catch (Exception e){
                e.printStackTrace();
            }
            }
        // 状态码不对返回null
        return null;
    }

}

```

------

## 主函数入口

```java
package app;

import model.Response;
import service.QkyRobotServiceImpl;
import service.RobotService;

import java.io.IOException;
import java.sql.SQLOutput;
import java.util.Scanner;

/**
 * @ClassName main
 * @Description TODO  智能机器人实现 main主入口
 * @Author JaChen
 * @Date 2020/08/17 15:11
 * @Version 1.0
 */
public class Main {

    private static final RobotService robotService = new QkyRobotServiceImpl();

    public static void main(String[] args) throws IOException {

        Scanner scanner = new Scanner(System.in);
        System.out.println("老板，麻烦您给我取一个名字吧，按回车键确定！");
        // 获取输入的字符串，以回车换行符为结束标志
        String name = scanner.nextLine();
        System.out.println("hello，我是您的智能小助手" + name + " 请下达指令");
        while (true){

            String input = scanner.nextLine();
            if ("886".equalsIgnoreCase(input)){
                System.out.println("欢迎下次使用，bye~");
                break;
            }
            else {
                Response response = robotService.qa(input);

                if (response != null && response.getCode() == 0){
                    System.out.println(name + ":" + new String(response.getContent().getBytes(), "UTF-8"));
                }else {
                    System.out.println(name + ": 暂时没明白您的意思，请重新下达指令");
                }
            }
        }
        scanner.close();

    }

}

```

