<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">2 篇博文 含有标签「安全」 | 软件一班季同学的世界</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jachen99.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://jachen99.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://jachen99.github.io/blog/tags/安全"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="keywords" content="个人博客, 技术分享, Java, Spring, Redis, ES, Docusaurus"><meta data-rh="true" property="og:title" content="2 篇博文 含有标签「安全」 | 软件一班季同学的世界"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jachen99.github.io/blog/tags/安全"><link data-rh="true" rel="alternate" href="https://jachen99.github.io/blog/tags/安全" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://jachen99.github.io/blog/tags/安全" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://R5YDTJ851V-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="软件一班季同学的世界 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="软件一班季同学的世界 Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="软件一班季同学的世界" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.02845d9e.css">
<script src="/assets/js/runtime~main.e9f1333c.js" defer="defer"></script>
<script src="/assets/js/main.44f23ff0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">我的空间</b></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><a class="navbar__item navbar__link" href="/docs/category/开源项目">随笔</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/tags">博客</a><a href="https://github.com/Jachen99/Jachen99.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为暗黑模式）" aria-label="切换浅色/暗黑模式（当前为暗黑模式）" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_brwN thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_r4Q1 margin-bottom--md">近期文章</div><div role="group"><h3 class="yearGroupHeading_hiiw">2025</h3><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/simple-seo-for-tech-blog">不花钱，给技术博客做点简单的SEO</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/es-advanced-syntax-and-sharding-strategy">Elasticsearch的高阶语法与分片策略：从概念到实战</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_hiiw">2024</h3><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/product-docs-oss-integration">BI可视化平台集成OSS</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/product-tree-structure-construction">使用Java8新特性构建树形结构：灵活的父子节点关系处理</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/springboot-jasypt-nacos-config-encryption">SpringBoot集成Jasypt实现Nacos配置加密与解密</a></li></ul></div><div class="sidebarItemTitle_r4Q1 margin-bottom--md margin-top--md"><a href="/blog/archive">文章归档</a></div></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>2 篇博文 含有标签「安全」</h1><a href="/blog/tags">查看所有标签</a></header><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/product-security-system-exit-jwt-invalid">安全功能之系统退出后JWT令牌失效</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-04-10T00:00:00.000Z">2024年4月10日</time> · <!-- -->阅读需 0 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/jiguanchen"><img class="avatar__photo authorImage_XqGP" src="https://github.com/jachen99.png" alt="季冠臣"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/jiguanchen"><span class="authorName_yefp">季冠臣</span></a></div><small class="authorTitle_nd0D" title="后端研发工程师">后端研发工程师</small><div class="authorSocials_rSDt"><a href="https://github.com/jachen99" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg viewBox="0 0 256 250" width="1em" height="1em" class="authorSocialLink_owbf githubSvg_Uu4N" xmlns="http://www.w3.org/2000/svg" style="--dark:#000;--light:#fff" preserveAspectRatio="xMidYMid"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div class="markdown"></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a title="关于安全相关的话题" class="tag_zVej tagRegular_sFm0" href="/blog/tags/secure">安全</a></li><li class="tag_QGVx"><a title="关于Java相关的话题" class="tag_zVej tagRegular_sFm0" href="/blog/tags/java">Java</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/product-security-testing-problems">第三方测试-系统安全测试问题之数据加密</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-01T00:00:00.000Z">2024年3月1日</time> · <!-- -->阅读需 15 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/jiguanchen"><img class="avatar__photo authorImage_XqGP" src="https://github.com/jachen99.png" alt="季冠臣"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/jiguanchen"><span class="authorName_yefp">季冠臣</span></a></div><small class="authorTitle_nd0D" title="后端研发工程师">后端研发工程师</small><div class="authorSocials_rSDt"><a href="https://github.com/jachen99" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg viewBox="0 0 256 250" width="1em" height="1em" class="authorSocialLink_owbf githubSvg_Uu4N" xmlns="http://www.w3.org/2000/svg" style="--dark:#000;--light:#fff" preserveAspectRatio="xMidYMid"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div class="markdown"><p>现在国内越来越重视系统安全，最近我们公司在做第三方测试过程中对系统安全、系统性能等做出了严格的要求，并进行了很大的整改，就从这篇文章开始总结一下最近三个月以及以后还会继续整改的涉及系统安全的相关测试漏洞的修改方案，相信这些问题会帮助到大家，尤其是比较大型的政府项目，对系统安全更加注重。</p>
<p><em>在互联网和新兴技术高速发展的今天，数据信息充斥在各行各业中，并发挥着重要的作用。然而，在享受信息化时代带来便利的同时，数据安全问题也成为大家关注的焦点。无论是从toG、toB、toC的各业务场景来看，还是从网络安全（CyberSecurity）的架构来看，数据安全（DataSecurity）都是一个主要的组成部分，而且在新兴技术日新月异的数据时代变得越来越重要，范围也越来越大。</em>
------- <em>引自 《数据安全架构设计与实战》</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安全架构5a方法论"><strong>安全架构5A方法论</strong><a href="#安全架构5a方法论" class="hash-link" aria-label="安全架构5a方法论的直接链接" title="安全架构5a方法论的直接链接">​</a></h2>
<p>无论是进行产品的安全架构设计或评估，还是规划安全技术体系架构的时候，都有几个需要重点关注的逻辑模块，它们可以在逻辑上视为安全架构的核心元素。
以应用/产品为例，核心元素包括：
■ 身份认证（Authentication）：用户主体是谁？
■ 授权（Authorization）：授予某些用户主体允许或拒绝访问客体的权限。
■ 访问控制（Access Control）：控制措施以及是否放行的执行者。
■ 可审计（Auditable）：形成可供追溯的操作日志。
■ 资产保护（Asset Protection）：资产的保密性、完整性、可用性保障</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="关于数据安全方面"><strong>关于数据安全方面</strong><a href="#关于数据安全方面" class="hash-link" aria-label="关于数据安全方面的直接链接" title="关于数据安全方面的直接链接">​</a></h2>
<p>我们在测试过程中涉及到了对数据传输加密、数据存储加密、对称加密、非对称加密、SM2、SM3、SM4国密加密，CA证书等等</p>
<p><em><strong>什么是非对称加密呢？</strong></em></p>
<p>非对称加密是一种密码学技术，与传统的对称加密不同，它使用一对密钥来进行加密和解密操作，这对密钥分别称为公钥和私钥。这两个密钥是数学上相关联的，但却不能通过已知一个密钥来轻松地推导出另一个密钥。</p>
<p>我们可以想象一下，就像你有一把锁和一把钥匙，任何人都可以得到这把锁，但只有你有这把唯一的钥匙。任何人都可以使用这把锁将信息锁住，但只有你能够使用你的独特的钥匙来解锁这个信息。</p>
<ul>
<li>公钥： 就像是一个开放的锁，任何人都可以获得。它用于加密信息，只有拥有与之相关的私钥的人才能解密。</li>
<li>私钥： 这是与公钥相关联的唯一的解锁密钥，只有密钥的拥有者才能解密用公钥加密的信息。</li>
</ul>
<p>举例来说，考虑用户密码的存储问题。通过非对称加密的方式，可以将用户密码加密后写入数据库。当用户再次登录时，系统将客户端输入的明文密码使用相同的非对称加密方式加密，然后与数据库中的密文进行比对。这样的设计大大提高了安全性，即使数据库被攻击，攻击者也无法轻松获取用户的明文密码。
国密SM2加密方式就是非对称加密的。下面是国密SM2加密工具的源码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/*椭圆曲线非对称加密算法*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class SM2Util {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String key_pubk= &quot;pub&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String key_prik= &quot;pri&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static SM2 sm2 = SM2.instance();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	private static final String DEFAULT_PRIVATE_KEY = &quot;27cd96b1500f8330fc523e7c47ef02a&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	private static final String DEFAULT_PUBLIC_KEY = &quot;047ec86bb18f57714e6c5c72383c5b122&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	 * 生成公私钥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	 * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	 */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static Map&lt;String,String&gt; generateKeyPair() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Map&lt;String,String&gt; result = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        AsymmetricCipherKeyPair key = sm2.eccKeyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        BigInteger privateKey = ((ECPrivateKeyParameters)key.getPrivate()).getD();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ECPoint publicKey = ((ECPublicKeyParameters)key.getPublic()).getQ();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String pubk = new String(Hex.encode(publicKey.getEncoded(false)), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String prik = new String(Hex.encode(privateKey.toByteArray()), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result.put(key_pubk, pubk);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result.put(key_prik, prik);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return result;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 获取默认公钥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String getDefaultPublicKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return DEFAULT_PUBLIC_KEY;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 获取默认私钥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String getDefaultPrivateKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return DEFAULT_PRIVATE_KEY;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 加密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] encrypt(String data, byte[] publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	if (StringUtils.isBlank(data)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    		return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	SM2Cipher cipher = new SM2Cipher();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	// C1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	byte[] c1Bytes = new byte[65];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	ECPoint c1 = cipher.encryptInit(sm2, sm2.eccCurve.decodePoint(publicKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	c1Bytes = c1.getEncoded(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c2Bytes = data.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.encrypt(c2Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c3Bytes = new byte[32];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.doFinal(c3Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] encryptData = new byte[c1Bytes.length + c2Bytes.length + c3Bytes.length];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		System.arraycopy(c1Bytes, 0, encryptData, 0, c1Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		System.arraycopy(c2Bytes, 0, encryptData, c1Bytes.length, c2Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		System.arraycopy(c3Bytes, 0, encryptData, c1Bytes.length + c2Bytes.length, c3Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encryptData;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 加密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] encrypt(String data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return encrypt(data, HexUtil.hexToByte(publicKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 加密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] encrypt(byte[] data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return encrypt(new String(data, StandardCharsets.UTF_8), HexUtil.hexToByte(publicKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 加密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encryptToHexString(String data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return HexUtil.byteToHex(encrypt(data, HexUtil.hexToByte(publicKey)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 加密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encryptToHexString(byte[] data, String publicKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return HexUtil.byteToHex(encrypt(new String(data, StandardCharsets.UTF_8), HexUtil.hexToByte(publicKey)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 解密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] decrypt(byte[] encryptedData, byte[] privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	if (ArrayUtils.isEmpty(encryptedData)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    		return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	SM2Cipher cipher = new SM2Cipher();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c1Bytes = new byte[65];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.arraycopy(encryptedData, 0, c1Bytes, 0, c1Bytes.length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ECPoint c1 = sm2.eccCurve.decodePoint(c1Bytes).normalize();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c3Bytes = new byte[32];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.arraycopy(encryptedData, encryptedData.length - 32, c3Bytes, 0, 32);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // C2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        int c2Len = encryptedData.length - 65 - 32;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] c2Bytes = new byte[c2Len];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        System.arraycopy(encryptedData, 65, c2Bytes, 0, c2Len);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.decryptInit(new BigInteger(1, privateKey), c1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.decrypt(c2Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.doFinal(c3Bytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return c2Bytes;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 解密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(byte[] encryptedData, String privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return decrypt(encryptedData, HexUtil.hexToByte(privateKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 解密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(byte[] encryptedData, String privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return new String(decrypt(encryptedData, HexUtil.hexToByte(privateKey)), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * 解密</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param encryptedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @param privateKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encryptedData, String privateKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    	return new String(decrypt(Hex.decode(encryptedData), HexUtil.hexToByte(privateKey)), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此外，CA（Certificate Authority，证书颁发机构）机构通常也使用非对称加密的方式来确保数字证书的安全性。CA机构在数字证书颁发过程中起到了信任的中介角色，其操作基于公钥基础设施（PKI）。</p>
<p>下面是CA机构使用非对称加密的一般流程：</p>
<ol>
<li>证书请求： 实体（通常是个人或组织）向CA机构提交证书请求，请求包括实体的公钥和一些身份信息。</li>
<li>验证身份： CA机构对证书请求中的身份信息进行验证，确保请求者确实拥有所声明的身份。这可  以通过一系列验证步骤来完成。</li>
<li>颁发数字证书： 验证通过后，CA机构使用自己的私钥对实体的公钥和身份信息进行签名，生成数字证书。这个签名过程就是使用非对称加密，其中CA的私钥用于签署证书信息。</li>
<li>证书分发： CA机构将生成的数字证书发送给请求者，同时可以将证书公开发布到公共目录中，以便其他人可以验证证书的真实性。</li>
<li>证书验证： 在通信过程中，当其他人需要验证实体的身份时，他们可以使用CA机构公开的公钥来验证数字证书的签名。如果验证通过，就可以信任该数字证书所附的公钥。</li>
</ol>
<p>非对称加密的优势在于它提供了更高的安全性。即使在公共环境下传输公钥，也无法通过公钥轻松计算出私钥。这使得非对称加密在安全地实现身份验证、数字签名和加密通信等场景中发挥重要作用。</p>
<p><em><strong>相对的，什么是对称加密呢？</strong></em></p>
<p>对称加密是一种加密算法，它使用相同的密钥同时进行数据的加密和解密。这意味着在对称加密中，使用加密和解密操作的相同密钥。对称加密算法在加密和解密的过程中都使用相同的密钥，因此密钥的保管和分发变得至关重要。
我们了解的国密SM4就是采用的对称加密的方式实现的，源码工具如下：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * （分组密码算法）国密对称加密算法</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public abstract class SM4Util {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	static {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static final Charset ENCODING = StandardCharsets.UTF_8;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME = &quot;SM4&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 加密算法/分组加密模式/分组填充方式</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME_ECB_PADDING = &quot;SM4/ECB/PKCS5Padding&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String ALGORITHM_NAME_CBC_PADDING = &quot;SM4/CBC/PKCS5Padding&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 128-32位16进制；256-64位16进制</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final int DEFAULT_KEY_SIZE = 128;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String DEFAULT_KEY = &quot;86C63180C2806ED1F47B859DE501215B&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final String DEFAULT_IV = &quot;8F5CB6272B594B53AD1A2197361378DC&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static Cipher generateCipherECB(String algorithmName, int mode, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = Cipher.getInstance(algorithmName, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.init(mode, new SecretKeySpec(key, ALGORITHM_NAME));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static Cipher generateCipherCBC(String algorithmName, int mode, byte[] key, byte[] iv) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = Cipher.getInstance(algorithmName, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cipher.init(mode, new SecretKeySpec(key, ALGORITHM_NAME), new IvParameterSpec(iv));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String generateKey() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return HexUtil.byteToHex(generateKey(DEFAULT_KEY_SIZE));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] generateKey(int keySize) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        KeyGenerator kg = KeyGenerator.getInstance(ALGORITHM_NAME, BouncyCastleProvider.PROVIDER_NAME);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        kg.init(keySize, new SecureRandom());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return kg.generateKey().getEncoded();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] encryptECBPadding(byte[] data, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = generateCipherECB(ALGORITHM_NAME_ECB_PADDING, Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	protected static byte[] decryptECBPadding(byte[] encrypted, byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    Cipher cipher = generateCipherECB(ALGORITHM_NAME_ECB_PADDING, Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    return cipher.doFinal(encrypted);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    protected static byte[] encryptCBCPadding(byte[] data, byte[] key, byte[] iv) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Cipher cipher = generateCipherCBC(ALGORITHM_NAME_CBC_PADDING, Cipher.ENCRYPT_MODE, key, iv);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	protected static byte[] decryptCBCPadding(byte[] encrypted, byte[] key, byte[] iv) throws Exception {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    Cipher cipher = generateCipherCBC(ALGORITHM_NAME_CBC_PADDING, Cipher.DECRYPT_MODE, key, iv);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	    return cipher.doFinal(encrypted);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(String source) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(byte[] source) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(String source, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source.getBytes(ENCODING), hexKey);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(byte[] source, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] cipherArray;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			cipherArray = encryptECBPadding(source, ByteUtils.fromHexString(hexKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return ByteUtils.toHexString(cipherArray);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(String encrypted) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return decrypt(encrypted, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encrypted) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return decryptToString(encrypted, DEFAULT_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encrypted, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return new String(decrypt(encrypted, hexKey), ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(String encrypted, String hexKey) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return decryptECBPadding(ByteUtils.fromHexString(encrypted), ByteUtils.fromHexString(hexKey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return encrypted.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(String source, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return encrypt(source.getBytes(ENCODING), hexKey, iv);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String encrypt(byte[] source, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byte[] cipherArray;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			cipherArray = encryptCBCPadding(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">							source</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">							, ByteUtils.fromHexString(hexKey)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">							, ByteUtils.fromHexString(iv));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return ByteUtils.toHexString(cipherArray);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			throw new RuntimeException(&quot;数据加密失败&quot;, e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static String decryptToString(String encrypted, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return new String(decrypt(encrypted, hexKey, iv), ENCODING);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static byte[] decrypt(String encrypted, String hexKey, String iv) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			if (StringUtils.isBlank(encrypted)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">				return new byte[] {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			return decryptCBCPadding(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">				 	ByteUtils.fromHexString(encrypted)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					, ByteUtils.fromHexString(hexKey)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					, ByteUtils.fromHexString(iv));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		} catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">			log.error(e.getMessage(), e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		return encrypted.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em><strong>相信你也一定听过国密SM3算法，它是对称加密还是非对称加密呢？</strong></em>
其实SM3是一种密码杂凑算法，用于生成消息的哈希值，主要用于数据完整性验证、数字签名等场景，而不是进行加密和解密操作。所以它既不是对称加密也不是非对称加密，它常常与SM2与SM4组合一起使用，可以把它看成一个随机数。
<em>例如：</em>
系统数据存储加密应采用SM3+SM4的实现方式。
系统数据传输加密应采用SM2+SM3的实现方式。</p>
<p><strong>总结</strong>
在系统安全测试中，我们通过采用多层加密算法、合理的安全架构设计以及严格的数据安全措施，提高了系统在身份认证、授权、访问控制、审计和资产保护等方面的安全性。这有助于在互联网和新兴技术时代中更好地处理数据安全问题，特别适用于大型政府项目等对安全性要求较高的场景。数据安全相关的知识属于另一个领域了， 知识点真是深不可测，还需要平时多学习，积累更多的知识储备才行。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/安全">安全</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="博文列表分页导航"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">随笔</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://weibo.com/u/5489560765" target="_blank" rel="noopener noreferrer" class="footer__link-item">我的微博<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.csdn.net/m0_46464597?type=blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">我的博客</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/friends">友链</a></li><li class="footer__item"><a href="https://github.com/Jachen99" target="_blank" rel="noopener noreferrer" class="footer__link-item">follow me on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
                <img src="/img/logo.svg" alt="Logo" style="height: 38px; vertical-align: middle;">
                    © 2025 jachen99.github.io, Inc. Built with 
                <a href="https://docusaurus.io/" target="_blank" style="text-decoration: none;">Docusaurus</a>.
                <a href="https://notbyai.fyi/cn/" target="_blank">
                    <img src="/img/noai.svg" alt="No AI" style="height: 50px; vertical-align: middle; float: right;">
                </a>
            </div></div></div></footer></div>
</body>
</html>